<!-- This layout is used in all pages. Making changes here will efect all pages. We recommend not to change anything here. --> <!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" /><link rel="dns-prefetch" href="//fonts.googleapis.com" /><link rel="dns-prefetch" href="//google-analytics.com" /><link rel="dns-prefetch" href="//www.google-analytics.com" /><link rel="dns-prefetch" href="//maxcdn.bootstrapcdn.com" /><link rel="dns-prefetch" href="//ajax.googleapis.com" /><link rel="dns-prefetch" href="//fonts.gstatic.com" /><link rel="dns-prefetch" href="https://webjeda-demo.disqus.com/" /><title>Bootstrap to Quantify Uncertainty | Welcome to my Website</title><meta name="generator" content="Jekyll v3.8.4" /><meta property="og:title" content="Bootstrap to Quantify Uncertainty" /><meta name="author" content="Alan Gewerc" /><meta property="og:locale" content="en_US" /><meta name="description" content="Find the detailed code and more about bootstrap in my github" /><meta property="og:description" content="Find the detailed code and more about bootstrap in my github" /><link rel="canonical" href="http://localhost:4000/blog/Bootstrap-to-Quantify-Uncertainty/" /><meta property="og:url" content="http://localhost:4000/blog/Bootstrap-to-Quantify-Uncertainty/" /><meta property="og:site_name" content="Welcome to my Website" /><meta property="og:image" content="http://localhost:4000/assets/images/bootstrap_inf.png" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-07-16T18:12:00+08:00" /><script type="application/ld+json"> {"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/Bootstrap-to-Quantify-Uncertainty/"},"datePublished":"2020-07-16T18:12:00+08:00","description":"Find the detailed code and more about bootstrap in my github","image":"http://localhost:4000/assets/images/bootstrap_inf.png","author":{"@type":"Person","name":"Alan Gewerc"},"headline":"Bootstrap to Quantify Uncertainty","url":"http://localhost:4000/blog/Bootstrap-to-Quantify-Uncertainty/","dateModified":"2020-07-16T18:12:00+08:00","@context":"https://schema.org"}</script><link rel="stylesheet" href="/assets/css/main-default.css" /><link id="color-scheme" rel="stylesheet" href="/assets/css/main-default.css" /><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/apple-icon-60x60.png" /><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/apple-icon-114x114.png" /><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/apple-icon-152x152.png" /><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/android-icon-192x192.png" /><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" /><link rel="icon" href="/favicon.ico" type="image/x-icon" /><script src="https://cdn.jsdelivr.net/npm/ga-lite@1/dist/ga-lite.min.js" async></script><script> var galite = galite || {}; galite.UA = 'UA-174262091-1';</script><script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML"></script><script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script></head><div class="wrapper"><div class="container"><div class="main"><div class="main-container shadow"><div class="title-space"> <h1>Bootstrap to Quantify Uncertainty</h1></div><hr class="dashed"> <main> <ul class="breadcrumbs"> <li><a href="/">Home</a></li> <li><a href="/blog/">Blog</a></li> <li><a href="#">Bootstrap to quan...</a></li> </ul><div class="meta" data-aos="fade-up"> <p> <small> <span> <i class="fa fa-calendar" aria-hidden="true"></i> 16 Jul 2020&nbsp; </span> <span> <i class="fa fa-user" aria-hidden="true"></i> Alan Gewerc&nbsp; </span> <span> <i class="fa fa-clock-o" aria-hidden="true"></i> 16 mins read. </span> </small> </p></div><div class="featured-image" style="background-image: url(/assets/images/bootstrap_inf.png)" data-aos="zoom-in" ></div><div class="container"> <article> <p><br /> Find the detailed code and more about bootstrap in my <a href="https://github.com/Agewerc/Bootstrap/tree/master">github</a><br /> <br /></p> <h2 id="introduction-to-bootstrap">Introduction to Bootstrap</h2> <p>Bootstrap is a powerful tool widely used by statisticians and data scientists to quantify the uncertainty associated with estimated parameters in the context of statistical learning methods. If we want to account for the uncertainty of the parameters in a model, bootstrapping can help. Instead of using the complete data to estimate them once, we can repeat the process many times on the different samples generated with replacement to obtain a vector of estimates. Then, it becomes possible to estimate some statistical properties of the parameters, such as its standard-deviation and confidence intervals. For instance, in linear regression, we can use bootstrap to estimate the variance of the coefficients (betas) and consequently understand how reliable are they. However, it would not make any sense to repeat such tasks with the same dataset, as the parameters would always return the equal, and the variance would be zero. Instead, bootstrap consists of creating new resampled datasets. Some machine learning methods have already incorporated bootstrap into its algorithm, more notably Random Forests, that use bagging (bootstrap aggregating) to reduce the complexity of models that overfit the training data. In this work, we will explore bootstrap with Regression models. We will be doing a regression with a dataset from the year from 2015 with GDP-Per-Capita and life expectancy from most countries in the world. We want to model the relationship between these two variables. In the context of bootstrap, the first step would be to create the mentioned resampled datasets, as we can see in figure 1. <br /><br /></p> <p><img src="/assets/images/bootstrap countries.png" alt="drawing" width="700" /></p> <p><em>FIGURE 1. A graphical illustration of the bootstrap approach on a dataset containing n = 168 observations. Each bootstrap data set contains n observations, sampled with replacement from the original data set. Each bootstrap data set is used to obtain one estimate of the parameters which will compose the final vector/distribution.</em><br /><br /><br /></p> <h2 id="bootstrap-to-quantify-uncertainty">Bootstrap to quantify Uncertainty</h2> <p>When it comes to machine learning, the conclusions that can be drawn from a model are as important as they’re reliability. To ensure that a model is reliable it must not only achieve a good accuracy but it must also be constant on its results. If we train the model $n$ different times with samples that were drawn from the same dataset, we expect the mode to yield similar results every time, otherwise it might indicate that the model will work in some cases but not in others. <br /> Concerning a regression model, we can calculate the parameters of the betas and intercept such as the mean and standard deviation. A high standard deviation will indicate a problem in the confidence of the model. In the ideal cenario, the parameters will show a normal distribution.</p> <h2 id="algorithm">Algorithm</h2> <p>The logic of bootstrap is quite simple and can be captured in simple lines of code, or pseudocode. In the end, it comes down to repeatedly perform a task with random samples (with replacement). <img src="/assets/images/bootstrap_algorithm.png" alt="drawing" width="700" /><br /> <em>FIGURE 3. The Bootstrap algorithm</em> <br /><br /></p> <h2 id="bootstrap-in-a-polynomial-regression">Bootstrap in a Polynomial Regression</h2> <p>Does the richness of a country imply in a more lasting life expectancy? Easy question, the answer is Yes. At least in most cases. We will be working with a dataset from the <a href="https://data.worldbank.org/">World Bank</a> to try to model the relationship of these variables.<br /> The variables are the following:</p> <ol> <li><code class="highlighter-rouge">GDP-Per-Capital:</code> The total amount of richness per person in a country.</li> <li><code class="highlighter-rouge">The life expectancy:</code> The number of years expected for someone to live in a country.</li> </ol> <p>Lets have a first look in the data with a scatter plot. <br /> <br /></p> <p><img src="/assets/images/bootstrap_gdp.png" alt="bootstrap_gdp" /><br /> <em>FIGURE 4. GDP per Capita x Life Expectancy</em> <br /><br /></p> <p>There is a clear relationship in the data. Countries with higher GDP-Per-Capita have an also higher life expectancy. The reason is not hard to guess. Better infrastructure, better health systems, sanitation education and all that comes with economic development. It is worth noticing that we are working with GPD-per-Capita instead of GDP. The difference is that the number is divided by the number of citizens so that the number is not biased towards countries that have a vast population (such as China and India). However, it is also clear that the relationship between these variables is not linear, and therefore cannot be modelled by linear regression. Instead, we will use polynomial regression.<br /> In the next steps we will have a look in the data and create a regression of second degree. <br /><br /></p><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>data &lt;- read.csv('life-expectancy-vs-gdp-per-capita.csv') # import the data
colnames(data) &lt;- c('Entity', 'code', 'Year', 'l_expect', 'GDP_per_capita', 'Pop') # improve names
data &lt;- na.omit(data) # remove NA's
head(data)
</code></pre></div></div><p><br /></p> <table> <thead> <tr> <th style="text-align: right">Id</th> <th style="text-align: right">Entity</th> <th style="text-align: right">code</th> <th style="text-align: right">Year</th> <th style="text-align: right">l_expect</th> <th style="text-align: right">GDP_per_capita</th> <th style="text-align: right">Pop</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">1</td> <td style="text-align: right">Afghanistan</td> <td style="text-align: right">AFG</td> <td style="text-align: right">2015</td> <td style="text-align: right">63.377</td> <td style="text-align: right">1928</td> <td style="text-align: right">34414000</td> </tr> <tr> <td style="text-align: right">3</td> <td style="text-align: right">Albania</td> <td style="text-align: right">ALB</td> <td style="text-align: right">2015</td> <td style="text-align: right">78.025</td> <td style="text-align: right">10947</td> <td style="text-align: right">2891000</td> </tr> <tr> <td style="text-align: right">4</td> <td style="text-align: right">Algeria</td> <td style="text-align: right">DZA</td> <td style="text-align: right">2015</td> <td style="text-align: right">76.090</td> <td style="text-align: right">13024</td> <td style="text-align: right">39728000</td> </tr> <tr> <td style="text-align: right">8</td> <td style="text-align: right">Angola</td> <td style="text-align: right">AGO</td> <td style="text-align: right">2015</td> <td style="text-align: right">59.398</td> <td style="text-align: right">8631</td> <td style="text-align: right">27884000</td> </tr> <tr> <td style="text-align: right">11</td> <td style="text-align: right">Argentina</td> <td style="text-align: right">ARG</td> <td style="text-align: right">2015</td> <td style="text-align: right">76.068</td> <td style="text-align: right">19316</td> <td style="text-align: right">43075000</td> </tr> </tbody> </table> <p><br /></p> <p>Next step, make the polynomial regression:</p><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">model</span> <span class="p">&lt;-</span> <span class="n">lm</span><span class="p">(</span><span class="n">data</span><span class="p">$</span><span class="n">l_expect</span> <span class="p">~</span> <span class="n">data</span><span class="p">$</span><span class="n">GDP_per_capita</span> <span class="p">+</span> <span class="n">I</span><span class="p">(</span><span class="n">data</span><span class="p">$</span><span class="n">GDP_per_capita</span><span class="p">^</span><span class="m">2</span><span class="p">))</span>
<span class="n">summary</span><span class="p">(</span><span class="k">model</span><span class="p">)</span>
</code></pre></div></div><p><br /></p><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Call:
lm(formula = data$l_expect ~ data$GDP_per_capita + I(data$GDP_per_capita^2))

Residuals:
     Min       1Q   Median       3Q      Max 
-23.3124  -2.1618   0.6404   3.1210   9.8065 

Coefficients:
                           Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               6.155e+01  8.096e-01   76.02  &lt; 2e-16 ***
data$GDP_per_capita       1.021e-03  9.952e-05   10.26  &lt; 2e-16 ***
I(data$GDP_per_capita^2) -1.359e-08  2.148e-09   -6.33 2.42e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.048 on 158 degrees of freedom
Multiple R-squared:  0.6137,Adjusted R-squared:  0.6088 
F-statistic: 125.5 on 2 and 158 DF,  p-value: &lt; 2.2e-16
</code></pre></div></div><p>Our regressions seem to have a good fit. Our parameters have statistical significance, and we have found a satisfactory adjusted R-squared. Let’s plot the line in the dataset.<br /></p> <p><img src="/assets/images/bootstrap_pregression.png" alt="bootstrap_regre" /></p> <p>When making a prediction, we do not want to be limited to the point of our model. We want to find a confidence interval. We will find the confidence interval creating bootstrapped models. First let’s make a plot with n models, where n equals 10 and 100.</p> <p><img src="/assets/images/bootstrap_cover.PNG" alt="drawing" width="1000" /></p> <h2 id="model-parameters">Model Parameters</h2> <p>Making use of every model above we have found or model parameters and their statistical distribution. Lets plot the data of every beta and intercept.</p> <p><img src="/assets/images/bootstrap_r.png" alt="bootstrap_r" /></p> <p><br /><br /></p> <h4 id="the-distribution-of-the-betas">The Distribution of the Betas</h4> <p><img src="/assets/images/bootstrap_plots.png" alt="bootstrap_plots" /> <em>FIGURE 2. A graphical illustration of the distribution of the parameters of a polynomial regression of second degree and the number of repetitions (n = 1000). The parameters follow a gaussian distribution.</em><br /></p> <p>Now lets plot the regression with upper and lower lines - a condidence interval of 95%.</p> <p><br /><br /></p> <h1 id="bootstraped-model-with-confidenc-e-interval">Bootstraped Model with Confidenc e Interval<br /></h1> <p><img src="/assets/images/bootstrap_final.png" alt="drawing" width="650" /></p> <p><br /><br /> That’s all for now, thanks for reading!</p> </article></div><hr class="dashed" /><div class="container"><div class="row" data-aos="fade-up"><div class="col-md-12"><div class="share-box"> <i class="fa fa-share-alt" aria-hidden="true"></i> <a class="f nostyle" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/blog/Bootstrap-to-Quantify-Uncertainty/" onclick="window.open(this.href, 'mywin', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" ><i class="fa fa-facebook-official fa"></i ></a> <a class="t nostyle" href="https://twitter.com/intent/tweet?text=&url=http://localhost:4000/blog/Bootstrap-to-Quantify-Uncertainty/" onclick="window.open(this.href, 'mywin', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" ><i class="fa fa-twitter fa"></i ></a> <a class="g nostyle" href="https://plus.google.com/share?url=http://localhost:4000/blog/Bootstrap-to-Quantify-Uncertainty/" onclick="window.open(this.href, 'mywin', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" ><i class="fa fa-google-plus fa"></i ></a> <a class="r nostyle" href="http://www.reddit.com/submit?url=http://localhost:4000/blog/Bootstrap-to-Quantify-Uncertainty/" onclick="window.open(this.href, 'mywin', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" ><i class="fa fa-reddit fa"></i ></a> <a class="l nostyle" href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/blog/Bootstrap-to-Quantify-Uncertainty/&title=&summary=&source=webjeda" onclick="window.open(this.href, 'mywin', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" ><i class="fa fa-linkedin fa"></i ></a> <a class="e nostyle" href="mailto:?subject=&amp;body=Check&amp;out&amp;this&amp;site&amp;http://localhost:4000/blog/Bootstrap-to-Quantify-Uncertainty/" ><i class="fa fa-envelope fa"></i ></a></div></div></div><div class="row"><div class="col-md-12"> <p class="categories" data-aos="fade-up"> <span><a href="/categories/#work">Work</a></span> <span><a href="/categories/#projects">Projects</a></span> </p></div></div><div id="disqus_thread" data-aos="fade-up"></div><script defer> (function() { var d = document, s = d.createElement("script"); s.src = "//webjeda-demo.disqus.com/embed.js"; s.setAttribute("data-timestamp", +new Date()); (d.head || d.body).appendChild(s); })();</script><noscript>Please enable JavaScript to view the comments</noscript><div class="recent" data-aos="fade-up"><div class=""> <h3>Recent Articles</h3></div><div class="recent-grid"><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/Recommender-System/"><div class="cards"><div class="image" style="background-image: url(/assets/images/recommendation.JPG)" ></div><p class="title"><small>Recommender system using Pyspark (ALS algorithm)</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/EM-Clustering/"><div class="cards"><div class="image" style="background-image: url(/assets/images/cluster.png)" ></div><p class="title"><small>Expectation-Maximization for News Clustering</small></p></div></a></div></div></div></div></main><footer data-aos="fade-up"><div class="text-right"> <p class="copy"> <i class="fa fa-at"></i> 2018 <a class="rev" href="http://localhost:4000">Blackcurrant</a> </p></div></footer></div></div></div></div><!DOCTYPE html><html><head><meta name="viewport" content="width=device-width, initial-scale=1"> <style> .sidenav { width: 230px; position: fixed; z-index: 1; top: 100px; left: 30px; overflow-x: hidden; padding: 8px 0; } .sidenav a { padding: 6px 8px 6px 16px; text-decoration: none; color: #444; font-size: 22px; display: block; } .sidenav a:hover { color: #064579; } .top-bar { background-color: #222222; } @media only screen and (min-width: 800px) { #test { display: none; } } </style></head><body><div class="sidenav"> <style> #content-desktop { display: inline; } #content-mobile { display: none; } </style><div class="d-none d-sm-block"> <a href="http://www.alangewerc.com"><i class="fa fa-fw fa-home"></i> Home</a> <a href="http://www.alangewerc.com/projects"><i class="fa fa-area-chart"></i> Projects</a> <a href="http://www.alangewerc.com/blog"><i class="fa fa-book"></i> Articles</a> <a href="http://www.alangewerc.com/contact"><i class="fa fa-address-book-o"></i> Contact</a></div></div><script src="/assets/js/jQuery.min.js"></script><script> $(document).ready(function () { $(".loader").hide(); });</script><script> (function () { var css = document.createElement('link'); css.href = '/assets/font-awesome-4.7.0/css/font-awesome.min.css'; css.rel = 'stylesheet'; css.type = 'text/css'; document.getElementsByTagName('head')[0].appendChild(css); })();</script><noscript><link rel="stylesheet" href="/assets/font-awesome-4.7.0/css/font-awesome.min.css"> </noscript><script> $("#search-input").keyup(function () { $("main").hide(); $("search-container").show(); if (!$('#search-input').val()) { $("main").show(); $("search-container").hide(); } });</script><script src="/assets/js/jekyll-search.min.js" type="text/javascript"></script><script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-container'), searchResultTemplate: '<a class="nostyle" href="{url}"><div class="blog borders cards"><div class="image" style="background-image: url({image});"></div><div class="content"><h3 class="title">{title}</h3><p class="description">{description}</p></div></div></a>', noResultsText: 'No results found', json: '/search.json' })</script><script> (function () { var css = document.createElement('link'); css.href = 'https://unpkg.com/aos@2.3.1/dist/aos.css'; css.rel = 'stylesheet'; css.type = 'text/css'; document.getElementsByTagName('head')[0].appendChild(css); })();</script><noscript><link rel="stylesheet" href="/assets/animate-on-scroll/aos.min.css"> </noscript><script src="/assets/animate-on-scroll/aos.min.js"></script><script> AOS.init({ duration: 600, once: true, disable: 'mobile' });</script></body></html>