<!-- This layout is used in all pages. Making changes here will efect all pages. We recommend not to change anything here. --> <!DOCTYPE html><html lang="en"><head><meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" /><link rel="dns-prefetch" href="//fonts.googleapis.com" /><link rel="dns-prefetch" href="//google-analytics.com" /><link rel="dns-prefetch" href="//www.google-analytics.com" /><link rel="dns-prefetch" href="//maxcdn.bootstrapcdn.com" /><link rel="dns-prefetch" href="//ajax.googleapis.com" /><link rel="dns-prefetch" href="//fonts.gstatic.com" /><title>Data Science for Social Good - Forecast Bushfires | Blackcurrant</title><meta name="generator" content="Jekyll v3.8.4" /><meta property="og:title" content="Data Science for Social Good - Forecast Bushfires" /><meta name="author" content="Alan Gewerc" /><meta property="og:locale" content="en_US" /><meta name="description" content="Table of Contents Introduction Data Exploration Model Development Model Comparison Variable Identification and Explanation Conclusion References 1. Introduction In this project we aim to create models that can predict the area burned in fires. We will be working with data from the UCI machine learning repository and is a collection curated by scientists Paulo Cortez and Anibal Morais from the Unviersity of Minho, Portugal. The data includes meteorological measurements taken at the time the fire was reported, spatial/temporal measurements, and index metrics that take into a account weather data in the recent past. The index metrics are a part of the Canadian Fire Weather Index System (FWI). The data was collected from January 2000 to December 2003 from the northeast region of Portugal. Data was collected from a total of 517 fires. Many different ML models can be applied - in the basis paper the one who achieved the best performance was Support Vector Machines (SVM). However, in this project we will be testing advanced regression techniques only. Our work will follow the steps: Perform data exploration and understand the trends in the dataset. Do necessary data manipulations such as data reshaping and outlier removal to enhance the dataset. Create models to predict the burned area according to different regression techniques. Compare the models performance and choose a winner. Explain the most relevant predictors according to the models and the data exploration. Attribute information: Provided with the data 1. Spatial information X: x-axis spatial coordinate within the Montesinho park map: 1 to 9 Y: y-axis spatial coordinate within the Montesinho park map: 2 to 9 2. Temporal information month: month of the year: “jan” to “dec” day: day of the week: “mon” to “sun” 3. FWI: The forest Fire Weather Index (FWI). Which is the Canadian system for rating fire danger. FFMC: FFMC index from the FWI system: 18.7 to 96.20 DMC: DMC index from the FWI system: 1.1 to 291.3 DC: DC index from the FWI system: 7.9 to 860.6 ISI: ISI index from the FWI system: 0.0 to 56.10 4. Methorological information temp: temperature in Celsius degrees: 2.2 to 33.30 RH: relative humidity in %: 15.0 to 100 wind: wind speed in km/h: 0.40 to 9.40 rain: outside rain in mm/m2 : 0.0 to 6.4 5. area: the burned area of the forest (in ha): 0.00 to 1090.84 Programming Language: R 3.5.1 in Jupyter Notebook R Libraries used: caret data.table dplyr e1071 GGally ggplot2 grid gridExtra lattice leaps MASS PerformanceAnalytics Importing Libraries library(ggplot2) # for improved plots library(GGally) # for scatterplot matrix library(e1071) # For ML functions library(MASS) # For ML functions library(data.table) # manipultaion such as inner joins library(grid) # functions and classes that represent graphical objects or grobs library(gridExtra) # organizing plots library(lattice) # for levelplot library(dplyr) # for data manipulation library(PerformanceAnalytics) library(caret) # library(leaps) # for regsubsets function 2. Data Exploration Load the data df_fires &lt;- read.csv(file=&quot;forestfires.csv&quot;, header=TRUE, sep=&quot;,&quot;) head(df_fires) # Dysplay first six rows of the table id X Y month day FFMC DMC DC ISI temp RH wind rain area 1 7 5 mar fri 86.2 26.2 94.3 5.1 8.2 51 6.7 0.0 0 2 7 4 oct tue 90.6 35.4 669.1 6.7 18.0 33 0.9 0.0 0 3 7 4 oct sat 90.6 43.7 686.9 6.7 14.6 33 1.3 0.0 0 4 8 6 mar fri 91.7 33.3 77.5 9.0 8.3 97 4.0 0.2 0 5 8 6 mar sun 89.3 51.3 102.2 9.6 11.4 99 1.8 0.0 0 6 8 6 aug sun 92.3 85.3 488.0 14.7 22.2 29 5.4 0.0 0 Understanding the burned area distribution As previously stated we aim to predict the area of the fire according to the other variables. it is logical that we start our data exploration from the area. A first look at the table above show that the area is 0 in all of the first rows which is a concern. The authors in their paper have explained that an area smaller than $100m^2$ is replaced by 0. Lets check the distribution of the burned area using an histogram. options(repr.plot.width=7, repr.plot.height=5) # area of display ggplot(df_fires, aes(area)) + geom_histogram(bins = 50) + theme_linedraw() + ggtitle(&quot;Distribution of Area Burned (Histogram)&quot;) This is an extremely skewed variable and most likely to make a prediction we will have to handle it accordingly. We plan to do a regression in the future and this might be a problem, because for the residuals to be normal the predicted variable should not be extremely skewed distribution. A possible first strategy is to apply transformatio methods such as the logarithm and see how the data will reshape. Important: As we saw many of the data points of area are equal to 0 - so we cannot pass the pure log, but instead we will apply the formula . Log transformation on the area df_fires$logarea &lt;- log(df_fires$area+1) # plotting the new distribution ggplot(df_fires, aes(logarea)) + geom_histogram(bins = 100) + theme_linedraw() + ggtitle(&quot;Distribution of LogArea Burned (Histogram)&quot;) Our data remains skilled, however, can see small improve in the distribution of the data. We will make a final analysis, by checking what happens if we do not consider the very small fires (size 0). ggplot(df_fires[df_fires$logarea!= 0,], aes(logarea)) + geom_histogram(bins = 100) + theme_linedraw() + ggtitle(&quot;Distribution of LogArea Burned (Histogram)&quot;) Observations regarding the distribution of the data: The distribution of the burned area is very skill and this might be a problem for modelling. We have made a first log transformation that made slight improve. If we exclude the close to 0 fires we will find a closely normal distribution which might be good to work with for modelling tasks. Spatial Analysis The dataset contains spatial information representing the fires location. The X and Y variables represent the geographical locations in a map and can only be analysed together to make sense. The X axis ranges from 1 to 9 (integers) while the y axis from 2 to 9. Together, they form an area of 72 spaces. We will develop heatmaps in the folowing to identify areas that have been particular areas of focus of fires with respect to: The area affected. The number of fires. Other variables that we might want to compare # create a table # grouping other variables by area df_spatial &lt;- df_fires %&gt;% group_by(X,Y) %&gt;% summarize(Total_Area = sum(area, na.rm = TRUE), Count_Fires = n(), temp = median(temp, na.rm = TRUE), RH = median(RH, na.rm = TRUE), wind = median(wind, na.rm = TRUE), rain = median(rain, na.rm = TRUE), FFMC = median(FFMC, na.rm = TRUE), DMC = median(DMC, na.rm = TRUE), DC = median(DC, na.rm = TRUE), ISI = median(ISI, na.rm = TRUE) ) We want to develop a very specific heatmap, with many different features. To simplify the process of plotting we will create a function that will be used to make applied to make different plots. areaheatplot &lt;- function(scale, tittle) { Total.heatmap &lt;- ggplot(data = df_spatial, mapping = aes(x = X, y = Y, fill = scale)) + ggtitle(tittle) + geom_tile(position=position_nudge(x = 0.5, y= 0.5), colour = &quot;blue&quot;) + theme_linedraw() + theme(panel.grid.major = element_line(colour = &quot;blue&quot;)) + scale_fill_gradient(low=&quot;orange&quot;, high=&quot;red&quot;, na.value =&quot;white&quot;) + geom_text(aes(label = round(scale, 1)), position=position_nudge(x = 0.5, y= 0.5)) + scale_x_discrete(breaks=seq(1, 10, 1), limits = seq(1, 10, 1)) + scale_y_discrete(breaks=seq(1, 9, 1), limits = seq(1, 9, 1)) return (Total.heatmap) } Now, we will investigate different trends that data may show according to the region in which the fire happened. Firstly, we will try to observe some areas are more likely to have fires than others. area_plot &lt;- areaheatplot(df_spatial$Total_Area, &quot;Total Area&quot;) count_plot &lt;- areaheatplot(df_spatial$Count_Fires, &quot;Number of Fires&quot;) options(repr.plot.width=14, repr.plot.height=4) # managing the size grid.arrange(area_plot, count_plot, nrow = 1, ncol = 2) # making the plot Observations: Clearly there are more area that are more prone to fires than others. The interesection between X (6-9) and Y (4-7) accounts for more than half of fires. Most regions did not have fires at all. Now, we will try to explore the metheorological conditions by region to see if areas that have more fires have any peculiar trends. We will build 8 plots, regions against: Temperature, RH, Wind, Rain, FFMC, DMC, DC, ISI. temp_plot &lt;- areaheatplot(df_spatial$temp, &quot;Temperature&quot;) RH_plot &lt;- areaheatplot(df_spatial$RH, &quot;RH&quot;) wind_plot &lt;- areaheatplot(df_spatial$wind, &quot;Wind&quot;) rain_plot &lt;- areaheatplot(df_spatial$rain, &quot;Rain&quot;) FFMC_plot &lt;- areaheatplot(df_spatial$FFMC, &quot;FFMC&quot;) DMC_plot &lt;- areaheatplot(df_spatial$DMC, &quot;DMC&quot;) DC_plot &lt;- areaheatplot(df_spatial$DC, &quot;DC&quot;) ISI_plot &lt;- areaheatplot(df_spatial$ISI, &quot;ISI&quot;) options(repr.plot.width=14, repr.plot.height=15) # managing the size grid.arrange(temp_plot, RH_plot, wind_plot, rain_plot, FFMC_plot, DMC_plot, DC_plot, ISI_plot, nrow = 4, ncol = 2) # making the plot Observations: The latest charts are very useful to explore visually the relationship of variables with areas. Due to complexity, it is difficult to arrive to conclusions for modelling purposes. Apparently areas with more fires also have higher proportion of the other variables such as higher temperatures and Relative Humidity. Creating New Dummy Variables for Risky Areas - One Hot Encoding of Regions A region is a area formed by a X and a Y point. In total, there are 72 regions - with X ranging from 1-9 and Y raging from 2-9. Therefore we will create a new variable called region, because it will be better to analyse the data considering that hardly X and Y independently would make sense to analyse. As we have seen there are areas that are more prone to fires than others. This was explored even with relationship to other variables. We want our model to be able to capture this “risk” so we will make some modifications in our dataset. We will create dummy variables for all regions that concentrate more than 2% (at least 10) of the number of fires. We have chosen this threshold because we do not want our future models to overfit by using this new variables. # adding region variable df_area &lt;- data.frame(Region = 1:72, X = 1:9, Y = 2:9) df_fires &lt;- left_join(df_fires, df_area, by = c(&quot;X&quot;, &quot;Y&quot;)) # group by region the number of fires df_spatial &lt;- df_fires %&gt;% group_by(Region) %&gt;% summarize(Total_Area = sum(area, na.rm = TRUE), Count_Fires = n()) # filter areas with more than 10 fires attach(df_spatial) df_spatial &lt;- df_spatial[which(Count_Fires &gt; 10),] detach(df_spatial) danger_areas &lt;- df_spatial$Region cat(&quot;Danger Areas: Regions that have more than 10 registered fires \n&quot;, df_spatial$Region) Danger Areas: Regions that have more than 10 registered fires 1 3 4 11 19 20 42 43 52 53 58 59 60 65 67 # creating dummy variables for(i in (danger_areas)){ df_fires[,paste0(&quot;Region&quot;, i)] &lt;- ifelse(test = df_fires$Region == i, yes = 1, no = 0) } We have created 15 dummy variables that may be characterized as risk regions. Temporal Analysis We will further investigate the temporal dimension of the dataset. We want to know if fires are more likely to happen in a especific day or month. We noted, however, that it might be better to explore the data according to seasonality and weekends, because we beleive they should be better predictors. We will now: Create new variables, a dummy for weekends and a seasonality variable. Explore the trends of the variables weekends, seasonality, month and day. # create variable season df_fires$season &lt;- ifelse(df_fires$month == &quot;aug&quot; | df_fires$month == &quot;jun&quot; | df_fires$month == &quot;jul&quot;,&#39;summer&#39;, ifelse(df_fires$month == &quot;oct&quot; | df_fires$month == &quot;nov&quot; | df_fires$month == &quot;sep&quot;,&quot;autumn&quot;, ifelse(df_fires$month == &quot;feb&quot; | df_fires$month == &quot;jan&quot; | df_fires$month ==&quot;dec&quot;, &quot;winter&quot;, ifelse(df_fires$month == &quot;mar&quot; | df_fires$month == &quot;apr&quot; | df_fires$month ==&#39;may&#39;, &quot;spring&quot;, &#39;NA&#39;)))) # create variable weekend # note that we consider fruday a weekend day df_fires$weekend &lt;- ifelse(df_fires$day == &quot;mon&quot; | df_fires$day == &quot;tue&quot; | df_fires$day == &quot;wed&quot;| df_fires$day == &quot;thu&quot;, 0,1) # creating a table with the count of fires df_season &lt;- df_fires %&gt;% group_by(season, month, day, weekend) %&gt;% summarize(Total_Area = sum(logarea, na.rm = TRUE), Count_Fires = n()) day_order &lt;- c(&quot;mon&quot;, &quot;tue&quot;, &quot;wed&quot;, &quot;thu&quot;, &quot;fri&quot;, &quot;sat&quot;, &quot;sun&quot; ) season_order &lt;- c(&quot;summer&quot;, &quot;autumn&quot;, &quot;winter&quot;, &quot;spring&quot;) # Natural order of seasons month_order &lt;- c(&quot;jan&quot;, &quot;feb&quot;, &quot;mar&quot;, &quot;apr&quot;, &quot;may&quot;, &quot;jun&quot;, &quot;jul&quot;, &quot;aug&quot;, &quot;sep&quot;, &quot;oct&quot;, &quot;nov&quot;, &quot;dec&quot;) p1 &lt;- ggplot(df_fires, aes(x= factor(month, level = month_order), y =logarea)) + geom_boxplot(fill=&quot;slateblue&quot;, alpha=0.5) + theme_classic() + ggtitle(&quot;Distribution Fires by Month&quot;) p2 &lt;- ggplot(df_season, aes(x= factor(month, level = month_order), y =Total_Area)) + geom_bar(fill=&quot;grey&quot;, stat=&quot;identity&quot;) + theme_classic() + ggtitle(&quot;Distribution Fires by Month&quot;) p3 &lt;- ggplot(df_fires, aes(x= factor(season, level = season_order), y =logarea)) + geom_boxplot(fill=&quot;slateblue&quot;, alpha=0.5) + theme_classic() + ggtitle(&quot;Distribution Fires by Season&quot;) p4 &lt;- ggplot(df_season, aes(x= factor(season, level = season_order), y =Total_Area)) + geom_bar(fill=&quot;grey&quot;, stat=&quot;identity&quot;) + theme_classic() + ggtitle(&quot;Distribution Fires by Season&quot;) p5 &lt;- ggplot(df_fires, aes(x= factor(day, level = day_order), y =logarea)) + geom_boxplot(fill=&quot;slateblue&quot;, alpha=0.5) + theme_classic() + ggtitle(&quot;Distribution Fires by Day&quot;) p6 &lt;- ggplot(df_season, aes(x= factor(day, level = day_order), y =Total_Area)) + geom_bar(fill=&quot;grey&quot;, stat=&quot;identity&quot;) + theme_classic() + ggtitle(&quot;Distribution Fires by Day&quot;) p7 &lt;- ggplot(df_fires, aes(x= factor(weekend), y =logarea)) + geom_boxplot(fill=&quot;slateblue&quot;, alpha=0.5) + theme_classic() + ggtitle(&quot;Distribution Fires by Weekend&quot;) p8 &lt;- ggplot(df_season, aes(x= factor(weekend), y =Total_Area)) + geom_bar(fill=&quot;grey&quot;, stat=&quot;identity&quot;) + theme_classic() + ggtitle(&quot;Distribution Fires by Weekend&quot;) options(repr.plot.width=15, repr.plot.height=15) # managing the size grid.arrange(p1, p2, p3, p4, p5, p6, p7, p8, nrow = 4, ncol = 2) # making the plot Some observations about the temporal data. As expected summer has the highest number of fires, as we have seen that temperature is correlated to number of fires. Winter has a very small of fires compared to other seasons, but curiously the highest median. More than 70% of fires are either in summer or autumn. We expect this predictor to have a significant prediction power and we will create dummy variables for each season. We are considering weekends with 3 days and weekdays of 4 days. Nevertheless there are more fires in weekends. This might demonstrate a relationship of fires with human activity. This is especially true if we consider that there are many significant fire outliers on weekends. One Hot Encoding of Seasons To work with seasons it will be preferable to create dummy variables. This is what we will do next. seasons &lt;- unique(df_fires$season) for(i in (seasons)){ df_fires[,paste0(&quot;season&quot;, i)] &lt;- ifelse(test = df_fires$season == i, yes = 1, no = 0) } df_fires &lt;- subset(df_fires, select = -c(seasonspring)) # eliminating a season for the one_hot_encoding A first look at correlations Lets investigate how the variables relate to each other. To explore correlations we will leave the previously explored variables - related to temporal and and spatial analysis. options(repr.plot.width=15, repr.plot.height=10) # managing the size ggpairs(df_fires[,c(seq(5,13))]) This chart is particularly useful as other than the correlation we can see the distribution of the variables. With respect to correlation: There is no significant and strong correlation with two variables. Only one exception should be noticed, DC and DMC. They might be useful working together in our models. Temp apparently have a meaningful but small positive correlation with ISI, DC, DMC and FFMC. Even though many of the variables have been extracted from other variables, as an example, DC from rain and temperature, our variables seem to have a good level of independence that allow us to work with them together with no major concerns with colinearity and similar problems. 3. Model Development We will develop 2-3 models in this part of the project, with goal of predicting the burned area. Before performaing any modelling task, however, we will split the data in trainning and testing. Naturally, will we use a cross-validation approach. We will split the dataset in train and test, having 80% of trainning data. split Dataset in train and test set.seed(210) n &lt;- nrow(df_fires) shuffled &lt;- df_fires[sample(n),] df_train_fires &lt;- shuffled[1:round(0.80 * n),] df_test_fires &lt;- shuffled[(round(0.80 * n) + 1):n,] rownames(df_train_fires) &lt;- 1:nrow(df_train_fires) Influential Outliers Detection We have observed that the dataset has a right skewed distribution, and with significant outliers that may compromise our models. In this project we want to apply exclusevely linear models along with logistic regressions and therefore we would benefit from a clean dataset. Therefore we will remove significant outliers from our dataset. There are two recommended approaches in this situation: Remove outliers according to boxplot distribution. Remove Influential points according to Cooks distance. We have decided to take the second approach as we believe it is more aligned with the scope of our project and regression models. We will do it by the following steps. Filter from the dataset all non-zero area points. We want to do it because we will build some models that will target the non-zero distribution of the area. Build a simple linear regression with all predictors. Find influential points. Remove influential points from the dataset. Obs: The method used in this extraction was influenced by the following work. attach(df_train_fires) posit_data &lt;- df_train_fires[which(area &gt; 0),] options(repr.plot.width=15, repr.plot.height=10) # managing the size mod &lt;- lm(logarea ~ ., data=posit_data[c(seq(1,12),seq(14,31))]) # regression model cooksd &lt;- cooks.distance(mod) options(repr.plot.width=12, repr.plot.height=6) # managing the size plot(cooksd, pch=&quot;*&quot;, cex=2, main=&quot;Influential Obs by Cooks distance&quot;) # plot cook&#39;s distance abline(h = 4*mean(cooksd, na.rm=T), col=&quot;red&quot;) # add cutoff line text(x=1:length(cooksd), y=cooksd+0.002, labels=ifelse(cooksd&gt;4*mean(cooksd, na.rm=T),names(cooksd),&quot;&quot;), col=&quot;red&quot;) # add labels influential = which(cooksd&gt;4*mean(cooksd, na.rm=T)) # finding influential points df_train_fires[as.numeric(names(influential)), 1:13] id X Y month day FFMC DMC DC ISI temp RH wind rain area 11 8 8 aug wed 91.7 191.4 635.9 7.8 26.2 36 4.5 0 185.76 88 7 4 jul mon 89.2 103.9 431.6 6.4 22.6 57 4.9 0 278.53 112 8 6 aug thu 94.8 222.4 698.6 13.9 27.5 27 4.9 0 746.28 152 1 2 jul sat 90.0 51.3 296.3 8.7 16.6 53 5.4 0 0.71 173 7 4 aug sat 93.5 139.4 594.2 20.3 5.1 96 5.8 0 26.00 194 1 2 sep tue 91.0 129.5 692.6 7.0 18.8 40 2.2 0 212.88 204 6 5 sep sat 92.5 121.1 674.4 8.6 25.1 27 4.0 0 1090.84 304 4 3 aug wed 94.5 139.4 689.1 20.0 28.9 29 4.9 0 49.59 324 9 9 jul tue 85.8 48.3 313.4 3.9 18.0 42 2.7 0 0.36 411 2 4 aug sun 81.6 56.7 665.6 1.9 21.9 71 5.8 0 54.29 df_fires = df_fires[-as.numeric(names(influential)), ] # removing from the dataset Model 1 - Linear Regression Our first model will be a simple linear regression. We have observed that the area is not normally distributed and therefore it is preferable to predict the log of area. Nevertheless, we will also test a model to predict the area. As we know, the formula of the regression is: First Model: Second Model: When fitting a regression we want to obtain the best performance of our metrics. The most relevant are: R-Squared: Represents the proportion of the variance for a dependent variable that’s explained by independent variables. The higher the better. Adjusted R-squared: Simillar to R-squared, but also compares the explanatory power of regression models that contain different numbers of predictors. The higher the better. F-Test: Indicates if the model provides a better fit to the data than a model that contains no independent variables. The higher the better. RMSE: Represents the standard deviation of the differences between predicted values and observed values (residuals). The lower the better. names(df_train_fires) &#39;X&#39;&#39;Y&#39;&#39;month&#39;&#39;day&#39;&#39;FFMC&#39;&#39;DMC&#39;&#39;DC&#39;&#39;ISI&#39;&#39;temp&#39;&#39;RH&#39;&#39;wind&#39;&#39;rain&#39;&#39;area&#39;&#39;logarea&#39;&#39;Region&#39;&#39;Region1&#39;&#39;Region3&#39;&#39;Region4&#39;&#39;Region11&#39;&#39;Region19&#39;&#39;Region20&#39;&#39;Region42&#39;&#39;Region43&#39;&#39;Region52&#39;&#39;Region53&#39;&#39;Region58&#39;&#39;Region59&#39;&#39;Region60&#39;&#39;Region65&#39;&#39;Region67&#39;&#39;season&#39;&#39;weekend&#39;&#39;seasonautumn&#39;&#39;seasonsummer&#39;&#39;seasonwinter&#39; We will create a list of the variables called predictors that will help us in the progress of our model development. Also a support function that will be used to have less wording in the model development. A important note: We will explore the sinergy of DC and DMC - as we saw in the previous section and they are strongly correlated. # create a list of variables to use in modelling predictors &lt;- c(&quot;X&quot;, &quot;Y&quot;, &quot;FFMC&quot;, &quot;DMC&quot;, &quot;DMC:DC&quot;, &quot;ISI&quot;, &quot;temp&quot;, &quot;RH&quot;, &quot;wind&quot;, &quot;rain&quot;, &quot;Region1&quot;, &quot;Region3&quot;, &quot;Region4&quot;, &quot;Region11&quot;, &quot;Region19&quot;, &quot;Region20&quot;, &quot;Region42&quot;, &quot;Region43&quot;, &quot;Region52&quot;, &quot;Region53&quot;, &quot;Region58&quot;, &quot;Region59&quot;,&quot;Region60&quot;, &quot;Region65&quot;, &quot;weekend&quot;, &quot;seasonautumn&quot;, &quot;seasonwinter&quot;, &quot;seasonsummer&quot;) simplify &lt;- function(y, predictors){ return(as.formula(paste(y, &quot;~&quot;, paste(predictors, collapse = &quot;+&quot;)))) } # Fitting the models lm_area &lt;- lm(simplify(&quot;area&quot;, predictors), data = df_train_fires) lm_logarea &lt;- lm(simplify(&quot;logarea&quot;, predictors), data = df_train_fires) # summary of the model (estimates and metrics) summary(lm_area) summary(lm_logarea) Call: lm(formula = simplify(&quot;area&quot;, predictors), data = df_train_fires) Residuals: Min 1Q Median 3Q Max -60.70 -20.82 -6.98 5.01 1024.21 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) -5.768e+01 8.366e+01 -0.690 0.4909 X 3.379e+00 3.696e+00 0.914 0.3612 Y -4.351e-01 6.178e+00 -0.070 0.9439 FFMC -7.792e-02 8.029e-01 -0.097 0.9227 DMC 7.302e-01 3.462e-01 2.110 0.0355 * ISI -7.071e-01 9.687e-01 -0.730 0.4659 temp 1.939e+00 1.217e+00 1.594 0.1118 RH -9.880e-02 3.435e-01 -0.288 0.7738 wind 2.720e+00 2.184e+00 1.245 0.2139 rain -2.418e+00 1.158e+01 -0.209 0.8347 Region1 1.338e+01 2.543e+01 0.526 0.5992 Region3 -1.343e+00 1.610e+01 -0.083 0.9335 Region4 1.998e+00 1.835e+01 0.109 0.9134 Region11 4.730e-01 1.989e+01 0.024 0.9810 Region19 1.194e+01 2.603e+01 0.459 0.6466 Region20 -2.145e+00 2.206e+01 -0.097 0.9226 Region42 -1.216e+01 2.202e+01 -0.552 0.5812 Region43 -7.094e+00 1.783e+01 -0.398 0.6909 Region52 -9.631e+00 2.664e+01 -0.362 0.7179 Region53 6.323e+00 1.772e+01 0.357 0.7215 Region58 -1.579e+00 2.074e+01 -0.076 0.9394 Region59 -1.200e+01 1.811e+01 -0.663 0.5078 Region60 2.201e+01 1.478e+01 1.489 0.1373 Region65 1.033e+01 2.341e+01 0.441 0.6594 weekend 1.116e+00 7.387e+00 0.151 0.8800 seasonautumn 1.368e+01 1.581e+01 0.865 0.3876 seasonwinter 3.079e+01 2.022e+01 1.523 0.1286 seasonsummer -1.542e+01 1.756e+01 -0.878 0.3806 DMC:DC -7.666e-04 3.965e-04 -1.934 0.0539 . --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 70.83 on 385 degrees of freedom Multiple R-squared: 0.05539, Adjusted R-squared: -0.01331 F-statistic: 0.8063 on 28 and 385 DF, p-value: 0.7493 Call: lm(formula = simplify(&quot;logarea&quot;, predictors), data = df_train_fires) Residuals: Min 1Q Median 3Q Max -2.1635 -0.9899 -0.4054 0.7261 5.1428 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) -8.455e-01 1.646e+00 -0.514 0.60766 X 1.569e-01 7.271e-02 2.158 0.03154 * Y -2.417e-01 1.215e-01 -1.989 0.04740 * FFMC 1.281e-02 1.579e-02 0.811 0.41774 DMC 1.453e-02 6.809e-03 2.134 0.03345 * ISI -1.574e-02 1.905e-02 -0.826 0.40937 temp 3.150e-02 2.393e-02 1.316 0.18881 RH 2.656e-03 6.756e-03 0.393 0.69447 wind 9.700e-02 4.297e-02 2.258 0.02453 * rain 1.291e-01 2.277e-01 0.567 0.57099 Region1 -8.881e-01 5.002e-01 -1.775 0.07663 . Region3 -6.338e-01 3.166e-01 -2.002 0.04599 * Region4 -3.222e-01 3.610e-01 -0.893 0.37260 Region11 1.459e-01 3.913e-01 0.373 0.70946 Region19 5.081e-01 5.120e-01 0.992 0.32163 Region20 2.239e-01 4.340e-01 0.516 0.60619 Region42 -1.117e+00 4.331e-01 -2.579 0.01027 * Region43 -8.885e-01 3.507e-01 -2.533 0.01169 * Region52 -8.646e-01 5.240e-01 -1.650 0.09978 . Region53 -1.898e-01 3.486e-01 -0.545 0.58641 Region58 -2.241e-01 4.079e-01 -0.549 0.58309 Region59 -8.085e-01 3.561e-01 -2.270 0.02375 * Region60 -1.806e-01 2.908e-01 -0.621 0.53501 Region65 -6.117e-01 4.605e-01 -1.328 0.18482 weekend 1.277e-02 1.453e-01 0.088 0.93000 seasonautumn 2.510e-01 3.111e-01 0.807 0.42024 seasonwinter 1.121e+00 3.977e-01 2.818 0.00507 ** seasonsummer -5.150e-01 3.454e-01 -1.491 0.13682 DMC:DC -1.442e-05 7.799e-06 -1.849 0.06523 . --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.393 on 385 degrees of freedom Multiple R-squared: 0.1008, Adjusted R-squared: 0.0354 F-statistic: 1.541 on 28 and 385 DF, p-value: 0.04093 As expected lm_logarea performed better than lm_area, because logarea is more appropriate as a label. Therefore we will be working exclusevely with lm_logarea from now on. It calls our attention that the model has a small predictive power with respect to the metrics of performance, such as F-statistic and R-squared. In fact we found an negative adjusted R-Squared in lm_area which means the model contains terms that do not help to predict the response. Let’s proceed with diagnostic plots. options(repr.plot.width=10, repr.plot.height=8) # managing the size par(mfcol=c(2,2)) plot(lm_logarea) The diagnostic plots show residuals in four different ways. Some observations about the plots: Residual vs fitted plot and scale-location plot: They access if the residuals have non-linear patterns and if residuals are spread equally along the ranges of predictors. We can see an abnormal pattern such as some points in a linear trend. Other points are well behaved. Q-Q plot: Unfortunately we can observe that the distribution of the residuals is not normal and this might explain the performance of our model. Residual-leverage plot: Since we have previously performed data manipulation removing outliers and highly influential points, they are not a concern in this step. There is a limitrofe point just on the 0.5 line but we will keep it for now. Subset Selection In this task, we will use the regsubsets() function to perform best subset selection in order to choose the best model containing the predictors. We want the best model obtained according to $C_p$, $BIC$, and adjusted $R^2$. Show some plots to provide evidence for your answer, and report the coefficients of the best model obtained. lm_subset &lt;- regsubsets(simplify(&quot;logarea&quot;, predictors), data = df_train_fires, nvmax = 40) lm_subset.summary &lt;- summary(lm_subset) lm_subset.summary Subset selection object Call: regsubsets.formula(simplify(&quot;logarea&quot;, predictors), data = df_train_fires, nvmax = 40) 28 Variables (and intercept) Forced in Forced out X FALSE FALSE Y FALSE FALSE FFMC FALSE FALSE DMC FALSE FALSE ISI FALSE FALSE temp FALSE FALSE RH FALSE FALSE wind FALSE FALSE rain FALSE FALSE Region1 FALSE FALSE Region3 FALSE FALSE Region4 FALSE FALSE Region11 FALSE FALSE Region19 FALSE FALSE Region20 FALSE FALSE Region42 FALSE FALSE Region43 FALSE FALSE Region52 FALSE FALSE Region53 FALSE FALSE Region58 FALSE FALSE Region59 FALSE FALSE Region60 FALSE FALSE Region65 FALSE FALSE weekend FALSE FALSE seasonautumn FALSE FALSE seasonwinter FALSE FALSE seasonsummer FALSE FALSE DMC:DC FALSE FALSE 1 subsets of each size up to 28 Selection Algorithm: exhaustive X Y FFMC DMC ISI temp RH wind rain Region1 Region3 Region4 1 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 5 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 7 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 8 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 9 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 10 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 11 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 12 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 13 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 14 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 15 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 16 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 17 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 18 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 19 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 20 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 21 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 22 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 23 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 24 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 25 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; Region11 Region19 Region20 Region42 Region43 Region52 Region53 1 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 5 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 7 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 8 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 9 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 10 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 11 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; 12 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; 13 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; 14 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; 15 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 16 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 17 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 18 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 19 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 20 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 21 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 22 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 23 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 24 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 25 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 26 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; Region58 Region59 Region60 Region65 weekend seasonautumn seasonwinter 1 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; 5 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 7 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 8 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; 9 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; 10 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; 11 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; 12 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; 13 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 14 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; 15 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; 16 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; 17 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 18 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 19 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 20 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 21 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 22 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 23 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 24 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 25 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; seasonsummer DMC:DC 1 ( 1 ) &quot; &quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot; &quot; 5 ( 1 ) &quot;*&quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot; &quot; 7 ( 1 ) &quot; &quot; &quot;*&quot; 8 ( 1 ) &quot;*&quot; &quot;*&quot; 9 ( 1 ) &quot;*&quot; &quot;*&quot; 10 ( 1 ) &quot;*&quot; &quot;*&quot; 11 ( 1 ) &quot;*&quot; &quot;*&quot; 12 ( 1 ) &quot;*&quot; &quot;*&quot; 13 ( 1 ) &quot; &quot; &quot;*&quot; 14 ( 1 ) &quot;*&quot; &quot;*&quot; 15 ( 1 ) &quot;*&quot; &quot;*&quot; 16 ( 1 ) &quot;*&quot; &quot;*&quot; 17 ( 1 ) &quot;*&quot; &quot;*&quot; 18 ( 1 ) &quot;*&quot; &quot;*&quot; 19 ( 1 ) &quot;*&quot; &quot;*&quot; 20 ( 1 ) &quot;*&quot; &quot;*&quot; 21 ( 1 ) &quot;*&quot; &quot;*&quot; 22 ( 1 ) &quot;*&quot; &quot;*&quot; 23 ( 1 ) &quot;*&quot; &quot;*&quot; 24 ( 1 ) &quot;*&quot; &quot;*&quot; 25 ( 1 ) &quot;*&quot; &quot;*&quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; Due to the fact we have created many dummy variables for geographic region, our model may have up to 40 variables. We have found the best subset for n variables, when n ranges from 1 to 30. Now we will plot the number of variables from the best models against the accuracy indicators such as Cp, BIC, Ajusted R-squared and RSS. options(repr.plot.width=15, repr.plot.height=10) # managing the size par(mfrow = c(2, 2)) plot(lm_subset.summary$cp, xlab = &quot;Number of variables&quot;, ylab = &quot;C_p&quot;, type = &quot;l&quot;) points(which.min(lm_subset.summary$cp), lm_subset.summary$cp[which.min(lm_subset.summary$cp)], col = &quot;red&quot;, cex = 2, pch = 20) plot(lm_subset.summary$bic, xlab = &quot;Number of variables&quot;, ylab = &quot;BIC&quot;, type = &quot;l&quot;) points(which.min(lm_subset.summary$bic), lm_subset.summary$bic[which.min(lm_subset.summary$bic)], col = &quot;red&quot;, cex = 2, pch = 20) plot(lm_subset.summary$adjr2, xlab = &quot;Number of variables&quot;, ylab = &quot;Adjusted R^2&quot;, type = &quot;l&quot;) points(which.max(lm_subset.summary$adjr2), lm_subset.summary$adjr2[which.max(lm_subset.summary$adjr2)], col = &quot;red&quot;, cex = 2, pch = 20) plot(lm_subset.summary$rss, xlab = &quot;Number of variables&quot;, ylab = &quot;RSS&quot;, type = &quot;l&quot;) mtext(&quot;Plots of C_p, BIC, adjusted R^2 and RSS best subset selection selection&quot;, side = 3, line = -2, outer = TRUE) It is interesting the fact that we have found different models according to each indicator. Lets compare then. coef(lm_subset, which.min(lm_subset.summary$cp)) coef(lm_subset, which.min(lm_subset.summary$bic)) coef(lm_subset, which.max(lm_subset.summary$adjr2)) (Intercept):-0.0266117016454773 DMC: 0.0135111201577867 temp: 0.0301357865043537 wind:0.0794234546908572 Region:1-0.652129755329549 Region3:-0.556361498494578 seasonwinter:0.824436990829506 seasonsummer:-0.625817307938421 DMC:DC:-1.27126321593314e-05 (Intercept):1.19083283788439 Region: 3-0.549921309305286 (Intercept):0.55198302136147 X:0.0926165837619685 Y:-0.194404903439422 DMC0:.013670228896515 temp0:.0305312643068406 wind0:.0839199384373189 Region1:-0.968641287013757 Region3:-0.679272609210134 Region4:-0.416576766202436 Region42:-0.910932398029436 Region43:-0.668493899182849 Region52:-0.606346184501872 Region59:-0.718813149812681 Region65:-0.642247961402224 seasonwinter:0.990242150570015 seasonsummer:-0.691447562888277 DMC:DC:-1.2331282867293e-05 Observations from the subset selection: While $C_P$ indicates a total of 9 predictors, $BIC$ indicates only one. Adjusted-R-squared indicates 18 variables. We will reject the BIC analysis as we do not believe the model will have a good fit in the test data and work exclusevely with the second and third models. # create variables predictors_cp &lt;- c(&#39;DMC&#39;,&#39;temp&#39;,&#39;wind&#39;, &#39;Region1&#39;, &#39;Region3&#39;,&#39;seasonwinter&#39;, &#39;seasonsummer&#39;, &#39;DMC:DC&#39;) predictors_adjR &lt;- c(&#39;X&#39;, &#39;Y&#39;, &#39;DMC&#39;, &#39;temp&#39;, &#39;wind&#39;, &#39;Region1&#39;, &#39;Region3&#39;, &#39;Region4&#39;, &#39;Region42&#39;, &#39;Region43&#39;, &#39;Region52&#39;, &#39;Region59&#39;, &#39;Region65&#39;,&#39;seasonwinter&#39;, &#39;seasonsummer&#39;, &#39;DMC:DC&#39;) lm_cp_logarea &lt;- lm(simplify(&quot;logarea&quot;, predictors_cp), data = df_train_fires) lm_adjR2_logarea &lt;- lm(simplify(&quot;logarea&quot;, predictors_adjR), data = df_train_fires) summary(lm_cp_logarea) summary(lm_adjR2_logarea) Call: lm(formula = simplify(&quot;logarea&quot;, predictors_cp), data = df_train_fires) Residuals: Min 1Q Median 3Q Max -1.9576 -1.0736 -0.4319 0.8178 5.3502 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) -2.661e-02 3.775e-01 -0.071 0.94383 DMC 1.351e-02 6.282e-03 2.151 0.03208 * temp 3.014e-02 1.512e-02 1.993 0.04693 * wind 7.942e-02 4.035e-02 1.968 0.04972 * Region1 -6.521e-01 3.569e-01 -1.827 0.06841 . Region3 -5.564e-01 2.628e-01 -2.117 0.03484 * seasonwinter 8.244e-01 3.556e-01 2.318 0.02094 * seasonsummer -6.258e-01 2.088e-01 -2.998 0.00289 ** DMC:DC -1.271e-05 7.052e-06 -1.803 0.07218 . --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.389 on 405 degrees of freedom Multiple R-squared: 0.05992, Adjusted R-squared: 0.04135 F-statistic: 3.227 on 8 and 405 DF, p-value: 0.001433 Call: lm(formula = simplify(&quot;logarea&quot;, predictors_adjR), data = df_train_fires) Residuals: Min 1Q Median 3Q Max -2.0490 -1.0297 -0.3824 0.7927 5.1096 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 5.520e-01 5.484e-01 1.007 0.31475 X 9.262e-02 4.557e-02 2.033 0.04276 * Y -1.944e-01 9.841e-02 -1.975 0.04891 * DMC 1.367e-02 6.285e-03 2.175 0.03022 * temp 3.053e-02 1.523e-02 2.005 0.04566 * wind 8.392e-02 4.036e-02 2.079 0.03825 * Region1 -9.686e-01 4.217e-01 -2.297 0.02213 * Region3 -6.793e-01 2.770e-01 -2.453 0.01461 * Region4 -4.166e-01 3.287e-01 -1.268 0.20571 Region42 -9.109e-01 3.850e-01 -2.366 0.01846 * Region43 -6.685e-01 2.844e-01 -2.350 0.01924 * Region52 -6.063e-01 4.564e-01 -1.329 0.18476 Region59 -7.188e-01 3.268e-01 -2.200 0.02842 * Region65 -6.422e-01 3.961e-01 -1.622 0.10569 seasonwinter 9.902e-01 3.585e-01 2.762 0.00600 ** seasonsummer -6.914e-01 2.095e-01 -3.300 0.00105 ** DMC:DC -1.233e-05 7.052e-06 -1.749 0.08112 . --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.38 on 397 degrees of freedom Multiple R-squared: 0.09084, Adjusted R-squared: 0.0542 F-statistic: 2.479 on 16 and 397 DF, p-value: 0.001298 Apparently, lm_adjR2_logarea is the best performing model and therefore the winner of this first part. We arrived to this conclusion according to the F-statistic and the adjusted R-squared. Lets plot the residuals of the model. options(repr.plot.width=10, repr.plot.height=8) # managing the size par(mfcol=c(2,2)) plot(lm_adjR2_logarea) We can see that many of the problems of the first model persist. Lets make an anova analysis. anova(lm_logarea, lm_adjR2_logarea) Res.Df RSS Df Sum of Sq F Pr(&gt;F)   1 385 747.4043 NA NA NA NA 2 397 755.6820 -12 -8.277686 0.3553308 0.9774972 P-value is high and therefore we cannot affirm with certainty that there was an improvment in the model. It makes sense according to our previous plots. Second Model - Classification + Regression In our second model we will join a classification step to our model with the goal to split the dataset in fires that ~ 0 area burned and fires with more significant area burned. We follow the approach from Yanghe Huo. As we have seen in the data exploration the significant fires (more than 0) follow a normal distribution (closely). Therefore we have an expectation to be able to perform an improved analysis in this second model. Our model can be decribed as the following: Model: , where First Component: is a classification model that aims to identify observations with 0 area burned. Second Component: is a regression model that aims to estimate all area burned of all points that are different than 0. As we have observed, it is prefered to work with the logarea as it has a more well behaved distribution. Once we remove the points that are equal to 0 than we have almost a normal distribution, which is preferable when performing a regression. Again lets observe the distribution of the points &gt; 0. Logarea Burned area Distribution (&gt;0) options(repr.plot.width = 7, repr.plot.height = 5) # managing the size ggplot(df_fires[df_fires$logarea!= 0,], aes(logarea)) + geom_histogram(bins = 30) + theme_linedraw() + ggtitle(&quot;Distribution of LogArea Burned (Histogram)&quot;) Creating a binary variable for classification df_train_fires$binary_area &lt;- ifelse(df_train_fires$area == 0, 0, 1) df_test_fires$binary_area &lt;- ifelse(df_test_fires$area == 0, 0, 1) First Component: Binomial Regression # part 1 lr_area &lt;- glm(simplify(&quot;binary_area&quot;, predictors), data = df_train_fires, family = binomial()) summary(lr_area) Call: glm(formula = simplify(&quot;binary_area&quot;, predictors), family = binomial(), data = df_train_fires) Deviance Residuals: Min 1Q Median 3Q Max -1.8324 -1.1165 0.7112 1.0218 1.9726 Coefficients: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -5.251e+00 3.020e+00 -1.739 0.08206 . X 1.893e-01 1.158e-01 1.636 0.10193 Y -3.358e-01 1.892e-01 -1.775 0.07598 . FFMC 4.757e-02 3.074e-02 1.547 0.12176 DMC -1.199e-03 1.056e-02 -0.114 0.90959 ISI -5.425e-03 2.993e-02 -0.181 0.85615 temp 4.970e-02 3.709e-02 1.340 0.18028 RH 8.133e-03 1.053e-02 0.773 0.43970 wind 1.526e-01 6.831e-02 2.234 0.02546 * rain 2.433e-01 3.856e-01 0.631 0.52806 Region1 -2.061e+00 8.422e-01 -2.447 0.01441 * Region3 -8.628e-01 4.813e-01 -1.793 0.07303 . Region4 -7.284e-01 5.524e-01 -1.318 0.18736 Region11 7.205e-01 6.070e-01 1.187 0.23524 Region19 1.139e+00 8.198e-01 1.389 0.16488 Region20 9.303e-01 6.609e-01 1.408 0.15921 Region42 -1.642e+00 6.737e-01 -2.438 0.01479 * Region43 -7.425e-01 5.512e-01 -1.347 0.17802 Region52 -1.887e+00 8.804e-01 -2.144 0.03205 * Region53 -2.009e-01 5.291e-01 -0.380 0.70423 Region58 -8.546e-02 6.318e-01 -0.135 0.89240 Region59 -3.629e-01 5.438e-01 -0.667 0.50461 Region60 4.251e-01 4.608e-01 0.923 0.35626 Region65 -1.006e+00 6.928e-01 -1.452 0.14652 weekend -2.471e-01 2.228e-01 -1.109 0.26733 seasonautumn 3.495e-01 4.825e-01 0.724 0.46878 seasonwinter 1.736e+00 6.377e-01 2.723 0.00647 ** seasonsummer -3.709e-02 5.307e-01 -0.070 0.94427 DMC:DC 2.233e-06 1.209e-05 0.185 0.85344 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 571.13 on 413 degrees of freedom Residual deviance: 519.06 on 385 degrees of freedom AIC: 577.06 Number of Fisher Scoring iterations: 4 We have found some relevant variables in the task of predicting if an area had more than 0 area burned, notably specific variables linked to regions and seasons. We will now use the variables selected in part 1 to perform the logistic regression. We will not go through a process of subset selection variables because we expect the outcome to be the same due to math propoerties that are not relevant to this work. lr_adjR2_area &lt;- glm(simplify(&quot;binary_area&quot;, predictors_adjR), data = df_train_fires, family = binomial()) summary(lr_adjR2_area) Call: glm(formula = simplify(&quot;binary_area&quot;, predictors_adjR), family = binomial(), data = df_train_fires) Deviance Residuals: Min 1Q Median 3Q Max -1.7681 -1.1746 0.7446 1.0195 1.9581 Coefficients: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -1.323e-01 8.357e-01 -0.158 0.87420 X 6.577e-02 6.959e-02 0.945 0.34463 Y -2.391e-01 1.517e-01 -1.576 0.11504 DMC -1.143e-03 9.553e-03 -0.120 0.90480 temp 4.227e-02 2.347e-02 1.801 0.07169 . wind 1.306e-01 6.339e-02 2.061 0.03930 * Region1 -2.429e+00 7.469e-01 -3.252 0.00114 ** Region3 -1.188e+00 4.247e-01 -2.797 0.00515 ** Region4 -1.127e+00 5.061e-01 -2.228 0.02590 * Region42 -1.511e+00 5.871e-01 -2.574 0.01004 * Region43 -5.675e-01 4.318e-01 -1.314 0.18873 Region52 -1.528e+00 7.278e-01 -2.099 0.03582 * Region59 -3.943e-01 4.981e-01 -0.792 0.42857 Region65 -1.265e+00 5.988e-01 -2.112 0.03467 * seasonwinter 1.245e+00 5.658e-01 2.200 0.02782 * seasonsummer -2.009e-01 3.223e-01 -0.623 0.53303 DMC:DC 4.518e-06 1.072e-05 0.421 0.67352 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 571.13 on 413 degrees of freedom Residual deviance: 529.64 on 397 degrees of freedom AIC: 563.64 Number of Fisher Scoring iterations: 4 As expected, since we have reduceded the number of predictors, the Residual deviance had an slight increase. On the other hand, the AIC had a decrease. This indicates the model is now less prone to overffiting, and more likely to have a good performance in the test data. Now we will continue with a regression on the positive points of the dataset. df_posit_train_fires &lt;- df_train_fires[df_train_fires$area &gt; 0,] lm_posit_logarea &lt;- lm(simplify(&quot;logarea&quot;, predictors), data = df_posit_train_fires) summary(lm_posit_logarea) Call: lm(formula = simplify(&quot;logarea&quot;, predictors), data = df_posit_train_fires) Residuals: Min 1Q Median 3Q Max -2.3215 -0.8083 -0.1362 0.5900 4.3011 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 1.973e+00 3.588e+00 0.550 0.58306 X 1.104e-01 7.819e-02 1.411 0.15973 Y -8.190e-02 1.398e-01 -0.586 0.55873 FFMC -1.589e-02 3.888e-02 -0.409 0.68310 DMC 2.582e-02 8.727e-03 2.959 0.00347 ** ISI -2.199e-02 3.205e-02 -0.686 0.49338 temp 3.863e-02 3.109e-02 1.242 0.21558 RH 3.408e-03 9.110e-03 0.374 0.70873 wind 8.164e-02 5.605e-02 1.457 0.14684 rain -1.474e-01 2.427e-01 -0.607 0.54434 Region1 8.466e-01 8.488e-01 0.997 0.31976 Region3 -4.940e-01 4.419e-01 -1.118 0.26493 Region4 3.612e-01 5.263e-01 0.686 0.49335 Region11 -1.780e-01 4.688e-01 -0.380 0.70463 Region19 1.986e-01 5.689e-01 0.349 0.72736 Region20 -2.309e-01 4.953e-01 -0.466 0.64162 Region42 -2.128e-01 5.461e-01 -0.390 0.69724 Region43 -7.886e-01 3.890e-01 -2.027 0.04403 * Region52 9.929e-01 9.213e-01 1.078 0.28249 Region53 -5.627e-02 4.032e-01 -0.140 0.88914 Region58 -2.642e-01 4.565e-01 -0.579 0.56343 Region59 -8.935e-01 4.049e-01 -2.207 0.02850 * Region60 -4.706e-01 3.413e-01 -1.379 0.16953 Region65 2.748e-01 5.837e-01 0.471 0.63831 weekend 2.931e-01 1.824e-01 1.607 0.10970 seasonautumn 4.262e-02 4.379e-01 0.097 0.92255 seasonwinter 5.480e-01 5.195e-01 1.055 0.29276 seasonsummer -1.084e+00 4.689e-01 -2.311 0.02188 * DMC:DC -2.757e-05 9.916e-06 -2.781 0.00596 ** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.249 on 195 degrees of freedom Multiple R-squared: 0.1711, Adjusted R-squared: 0.0521 F-statistic: 1.438 on 28 and 195 DF, p-value: 0.08143 The model has a quite low performance and we will apply subset selection to try to improve it. lm_posit_subset &lt;- regsubsets(simplify(&quot;logarea&quot;, predictors), data = df_posit_train_fires, nvmax = 40) lm_posit_subset.summary &lt;- summary(lm_posit_subset) lm_posit_subset.summary Subset selection object Call: regsubsets.formula(simplify(&quot;logarea&quot;, predictors), data = df_posit_train_fires, nvmax = 40) 28 Variables (and intercept) Forced in Forced out X FALSE FALSE Y FALSE FALSE FFMC FALSE FALSE DMC FALSE FALSE ISI FALSE FALSE temp FALSE FALSE RH FALSE FALSE wind FALSE FALSE rain FALSE FALSE Region1 FALSE FALSE Region3 FALSE FALSE Region4 FALSE FALSE Region11 FALSE FALSE Region19 FALSE FALSE Region20 FALSE FALSE Region42 FALSE FALSE Region43 FALSE FALSE Region52 FALSE FALSE Region53 FALSE FALSE Region58 FALSE FALSE Region59 FALSE FALSE Region60 FALSE FALSE Region65 FALSE FALSE weekend FALSE FALSE seasonautumn FALSE FALSE seasonwinter FALSE FALSE seasonsummer FALSE FALSE DMC:DC FALSE FALSE 1 subsets of each size up to 28 Selection Algorithm: exhaustive X Y FFMC DMC ISI temp RH wind rain Region1 Region3 Region4 1 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 5 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 7 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 8 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 9 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 10 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 11 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 12 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 13 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 14 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 15 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 16 ( 1 ) &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 17 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 18 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 19 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 20 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 21 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 22 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 23 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 24 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 25 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; Region11 Region19 Region20 Region42 Region43 Region52 Region53 1 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 5 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 7 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 8 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 9 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 10 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 11 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 12 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 13 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 14 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 15 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 16 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 17 ( 1 ) &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 18 ( 1 ) &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 19 ( 1 ) &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 20 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 21 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 22 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 23 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 24 ( 1 ) &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 25 ( 1 ) &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; Region58 Region59 Region60 Region65 weekend seasonautumn seasonwinter 1 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 5 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 7 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 8 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 9 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 10 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 11 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 12 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 13 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 14 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 15 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 16 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 17 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 18 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 19 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 20 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 21 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 22 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 23 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 24 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 25 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; seasonsummer DMC:DC 1 ( 1 ) &quot;*&quot; &quot; &quot; 2 ( 1 ) &quot;*&quot; &quot; &quot; 3 ( 1 ) &quot;*&quot; &quot;*&quot; 4 ( 1 ) &quot;*&quot; &quot;*&quot; 5 ( 1 ) &quot;*&quot; &quot;*&quot; 6 ( 1 ) &quot;*&quot; &quot;*&quot; 7 ( 1 ) &quot;*&quot; &quot;*&quot; 8 ( 1 ) &quot;*&quot; &quot;*&quot; 9 ( 1 ) &quot;*&quot; &quot;*&quot; 10 ( 1 ) &quot;*&quot; &quot;*&quot; 11 ( 1 ) &quot;*&quot; &quot;*&quot; 12 ( 1 ) &quot;*&quot; &quot;*&quot; 13 ( 1 ) &quot;*&quot; &quot;*&quot; 14 ( 1 ) &quot;*&quot; &quot;*&quot; 15 ( 1 ) &quot;*&quot; &quot;*&quot; 16 ( 1 ) &quot;*&quot; &quot;*&quot; 17 ( 1 ) &quot;*&quot; &quot;*&quot; 18 ( 1 ) &quot;*&quot; &quot;*&quot; 19 ( 1 ) &quot;*&quot; &quot;*&quot; 20 ( 1 ) &quot;*&quot; &quot;*&quot; 21 ( 1 ) &quot;*&quot; &quot;*&quot; 22 ( 1 ) &quot;*&quot; &quot;*&quot; 23 ( 1 ) &quot;*&quot; &quot;*&quot; 24 ( 1 ) &quot;*&quot; &quot;*&quot; 25 ( 1 ) &quot;*&quot; &quot;*&quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; options(repr.plot.width=15, repr.plot.height=10) # managing the size par(mfrow = c(2, 2)) plot(lm_posit_subset.summary$cp, xlab = &quot;Number of variables&quot;, ylab = &quot;C_p&quot;, type = &quot;l&quot;) points(which.min(lm_posit_subset.summary$cp), lm_posit_subset.summary$cp[which.min(lm_posit_subset.summary$cp)], col = &quot;red&quot;, cex = 2, pch = 20) plot(lm_posit_subset.summary$bic, xlab = &quot;Number of variables&quot;, ylab = &quot;BIC&quot;, type = &quot;l&quot;) points(which.min(lm_posit_subset.summary$bic), lm_posit_subset.summary$bic[which.min(lm_posit_subset.summary$bic)], col = &quot;red&quot;, cex = 2, pch = 20) plot(lm_posit_subset.summary$adjr2, xlab = &quot;Number of variables&quot;, ylab = &quot;Adjusted R^2&quot;, type = &quot;l&quot;) points(which.max(lm_posit_subset.summary$adjr2), lm_posit_subset.summary$adjr2[which.max(lm_posit_subset.summary$adjr2)], col = &quot;red&quot;, cex = 2, pch = 20) plot(lm_posit_subset.summary$rss, xlab = &quot;Number of variables&quot;, ylab = &quot;RSS&quot;, type = &quot;l&quot;) mtext(&quot;Plots of C_p, BIC, adjusted R^2 and RSS best subset selection selection&quot;, side = 3, line = -2, outer = TRUE) coef(lm_posit_subset, which.min(lm_posit_subset.summary$cp)) coef(lm_posit_subset, which.min(lm_posit_subset.summary$bic)) coef(lm_posit_subset, which.max(lm_posit_subset.summary$adjr2)) (Intercept)1.48020595937141 X0.0809547752784181 DMC0.0219214865403856 Region43-0.68303590058244 Region59-0.798154315732607 Region60-0.54195856092524 weekend0.265913932174833 seasonsummer-1.00810076795683 DMC:DC-2.34940806014068e-05 (Intercept)1.70331143574566 DMC0.0241956909502708 seasonsummer-0.963236697621362 DMC:DC-2.55993473859988e-05 (Intercept)0.703865860612608 X0.0887125845951744 DMC0.0250398319780162 temp0.0200056262313652 wind0.0637379419620515 Region11.00845241123666 Region3-0.473888105030186 Region43-0.7151287573868 Region59-0.904038328051593 Region60-0.509101520453757 weekend0.266448108332819 seasonwinter0.619757365115371 seasonsummer-1.15204301839224 DMC:DC-2.65123492005568e-05 predictors_cp2 &lt;- c(&quot;X&quot;, &quot;DMC&quot;, &quot;Region43&quot;, &quot;Region59&quot;, &quot;Region60&quot;, &quot;weekend&quot;, &quot;seasonsummer&quot;, &quot;DMC:DC&quot;) predictors_adjR2 &lt;- c(&quot;X&quot;, &quot;Y&quot;, &quot;DMC&quot;, &quot;temp&quot;, &quot;wind&quot;, &quot;Region1&quot;,&quot;Region3&quot;, &quot;Region43&quot;, &quot;Region59&quot;, &quot;Region60&quot;, &quot;weekend&quot;, &quot;seasonwinter&quot;, &quot;seasonsummer&quot;, &quot;DMC:DC&quot;) lm_posit_cp_logarea &lt;- lm(simplify(&quot;logarea&quot;, predictors_cp2), data = df_posit_train_fires) lm_posit_adjR2_logarea &lt;- lm(simplify(&quot;logarea&quot;, predictors_adjR2), data = df_posit_train_fires) summary(lm_posit_cp_logarea) summary(lm_posit_adjR2_logarea) Call: lm(formula = simplify(&quot;logarea&quot;, predictors_cp2), data = df_posit_train_fires) Residuals: Min 1Q Median 3Q Max -2.1335 -0.8730 -0.1931 0.6051 4.5698 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 1.480e+00 2.986e-01 4.957 1.45e-06 *** X 8.095e-02 3.875e-02 2.089 0.03786 * DMC 2.192e-02 7.421e-03 2.954 0.00349 ** Region43 -6.830e-01 3.007e-01 -2.272 0.02409 * Region59 -7.982e-01 3.561e-01 -2.242 0.02601 * Region60 -5.420e-01 2.716e-01 -1.996 0.04723 * weekend 2.659e-01 1.694e-01 1.570 0.11800 seasonsummer -1.008e+00 2.437e-01 -4.137 5.06e-05 *** DMC:DC -2.349e-05 8.388e-06 -2.801 0.00556 ** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.225 on 215 degrees of freedom Multiple R-squared: 0.1204, Adjusted R-squared: 0.08768 F-statistic: 3.679 on 8 and 215 DF, p-value: 0.0004812 Call: lm(formula = simplify(&quot;logarea&quot;, predictors_adjR2), data = df_posit_train_fires) Residuals: Min 1Q Median 3Q Max -2.4881 -0.8463 -0.1342 0.5300 4.3711 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 9.065e-01 5.919e-01 1.532 0.12714 X 1.081e-01 4.651e-02 2.324 0.02107 * Y -7.255e-02 8.998e-02 -0.806 0.42098 DMC 2.524e-02 7.760e-03 3.252 0.00134 ** temp 2.075e-02 1.898e-02 1.093 0.27544 wind 6.185e-02 5.024e-02 1.231 0.21974 Region1 9.043e-01 7.429e-01 1.217 0.22490 Region3 -4.668e-01 3.913e-01 -1.193 0.23425 Region43 -7.845e-01 3.158e-01 -2.484 0.01376 * Region59 -9.384e-01 3.629e-01 -2.586 0.01040 * Region60 -4.830e-01 2.848e-01 -1.696 0.09135 . weekend 2.569e-01 1.712e-01 1.501 0.13497 seasonwinter 6.673e-01 4.272e-01 1.562 0.11980 seasonsummer -1.153e+00 2.545e-01 -4.532 9.83e-06 *** DMC:DC -2.652e-05 8.603e-06 -3.083 0.00232 ** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.221 on 209 degrees of freedom Multiple R-squared: 0.1512, Adjusted R-squared: 0.09432 F-statistic: 2.659 on 14 and 209 DF, p-value: 0.001364 Analysis We have decided to proceed with lm_posit_adjR2_logareaand lm_posit_cp_logarea as we beleive they are both succsseful models according to the development of our project. They have similar results, and while the fist has an improved adjusted R-squared the second has a better F-statistic. Final Model Our final models of this second part will join the classification step with the regression for exclusively positive points (area &gt; 0). It can be described as previsously: E[Y|X]=Pr(Y&gt;0|X)×E(Y|Y&gt;0,X), where: Pr(Y&gt;0|X) is given by lr_area, which is a logistic regression. E(Y|Y&gt;0,X) is given by lm_posit_adjR2_logarea or lm_posit_cp_logarea which is the linear model applied only to positive area points. 4. Model Comparsion We will now compare the models we have developed throughout the project. The metrics we will use are inspired in the paper from Paulo Cortez and Anibal Morais - Mean Absolute Deviation (MAD) and Root Mean Squared (RMSE). They can be computed according to the formulas: We will compare 3 different models, which are the following: 1.Model1: lm_adjR2_logarea: A basic model, a simple linear regression that predicts logarea and predictors X, Y, DMC, temp, wind,Region1, Region3, Region4, Region42, Region43, Region52, Region59, seasonwinter, seasonsummer. 2.Model2: lr_adjR2_area x lm_posit_adjR2_logarea: A model that joins a logistic regression with a linear regression. The first model aims to classify if a observation is likely to be zero while the second targets the total area of points thata area different than zero. E[Y|X]=Pr(Y&gt;0|X)×E(Y|Y&gt;0,X). The first regression uses the variables X, Y, DMC, temp, wind,Region1, Region3, Region4, Region42, Region43, Region52, Region59, seasonwinter, seasonsummer while the second uses X, Y, DMC, temp, Region1,Region3, Region43, Region59, Region60, Region60, weekend, seasonwinter, seasonsummer, DMC:DC. 3.Model3: lr_adjR2_area x lm_posit_cp_logarea: A model that joins a logistic regression with a linear regression. The first model aims to classify if a observation is likely to be zero while the second targets the total area of points thata area different than zero. E[Y|X]=Pr(Y&gt;0|X)×E(Y|Y&gt;0,X). The first regression uses the variables X, Y, FFMC, DMC, temp, wind, rain,Region1, Region3, Region19, Region20, Region42, Region43, Region52, Region58, Region59, seasonwinter, seasonsummer while the second uses X, DMC,Region43, Region59, Region60, weekend, seasonsummer, DMC:DC. Defining the functions RMSE &lt;- function(x, y) sqrt(mean((y - x)^2, na.rm = TRUE)) MAE &lt;- function(x, y) mean(abs(y - x), na.rm = TRUE) Performing the calculations phat &lt;- predict(lr_adjR2_area, df_test_fires, type = &quot;response&quot;) df_predictions &lt;- as.data.frame(df_test_fires[,&#39;area&#39;],colname = &#39;area&#39;) colnames(df_predictions)[1] &lt;- &quot;area&quot; df_predictions$model1 &lt;- predict(lm_adjR2_logarea, df_test_fires) df_predictions$model2 &lt;- phat * predict(lm_adjR2_logarea, df_test_fires) df_predictions$model3 &lt;- phat * predict(lm_posit_cp_logarea, df_test_fires) RMSE &lt;- c(RMSE(df_predictions$area, df_predictions$model1), RMSE(df_predictions$area, df_predictions$model2), RMSE(df_predictions$area, df_predictions$model3)) RMSE &lt;ol class=list-inline&gt;&lt;li&gt;20.9233173414873&lt;/li&gt;&lt;li&gt;21.0733370518129&lt;/li&gt;&lt;li&gt;20.943199595481&lt;/li&gt;&lt;/ol&gt; MAE &lt;- c(MAE(df_predictions$area, df_predictions$model1), MAE(df_predictions$area, df_predictions$model2), MAE(df_predictions$area, df_predictions$model3)) MAE 7.21449129803444 7.11280632073942 7.23581143455136 5. Variable Identification and Explanation Throghout this project we have the following manipulations to create new variables with our dataset. Created dummy variables for risk areas - which means, areas where more than 10 fires were registered. Created a dummy variable for seasons, as we observed the relevance of summer and other seasons in the fires. Created a dummy variable for weekends as we had expectations of a human component in the fires. Removed variables related to month and weekday. After performing such manipulations we developed different models where variable identification was a major component. We applied the subset selection tool regsubsets, and analysed all possible combinations of variables. We did not save any computation power by using the foward or backward methods that would lead possibly to inferior models. When identifying significant variables, the most important statistic we have to consider is the $p-value$. The p-value of each coefficient is made to test the null hypothesis, which is that the coefficient is equal to zero. Setting a threhold low such as $p-value$ &lt; 0.05 indicates that the null hypothesis can be rejected and therefore the variable is signicant. To sum up, a predictor with a low p-value is likely to be a meaningful addition to your model because changes in the predictor’s value are related to changes in the response variable. To base my variable identification I will use exclusevely the final models presented in the previous section. We have performed almost 10 modelling/regressions tasks over this project, but we will make use only of the final models to select variables. The folowing table describes our variable selection - all the predictors with a $p-value$ lower than 5% in one of the final models. Predictor Type Description Model X Spatial x-axis spatial coordinate within the Montesinho park map: 1 to 9 Model1, Log Model, Model2 Y Spatial y-axis spatial coordinate within the Montesinho park map: 2 to 9 Model1 Region1 Spatial Dummy variable to characterize region 1 Model1, Log Model Region20 Spatial Dummy variable to characterize region 20 Log Model, Region42 Spatial Dummy variable to characterize region 42 Model1, Log Model Region 43 Spatial Dummy variable to characterize region 43 Model1, Model2, Log Model Region52 Spatial Dummy variable to characterize region 52 Model1 Region59 Spatial Dummy variable to characterize region 59 Model1 DMC FWI DMC index from the FWI system: 1.1 to 291.3 Model2, Model3 DMC:DC FWI DC index from the FWI system: 7.9 to 860.6 Model2, Model3 seasonwinter Temporal Dummy variable for season winter Model1, Log Model seasonsummer Temporal Dummy variable for season summer Model1, Model2, Model3 Weekend Temporal Dummy variable for weekend (Friday, Saturday and Sunday) Model2, Model3 The results for the variable identification are in line with what we expected according to different steps such as data exploration and modelling. We will revise some of the tasks and exploration we have done throughout the project to justify this choices. We will also try to demonstrate with statistical exploration why the variables were selected. Spatial Component Variables: X, Y, Region1, Region20, Region42, Region43, Region52, Region59 First, lets revisite the plot developed in the data exploration part. options(repr.plot.width=7, repr.plot.height=5) # managing the size area_plot With this chart we can see clearly that some areas are more relevant than others for purposes of fire prediction. We will now create a table to see explore the differences of fires among regions. df_fires$risky_region &lt;- ifelse(df_fires$Region == 1, 1, ifelse(df_fires$Region == 20, 1, ifelse(df_fires$Region == 42, 1, ifelse(df_fires$Region == 43, 1, ifelse(df_fires$Region == 52, 1, ifelse(df_fires$Region == 52, 59, 0)))))) df_fires %&gt;% group_by(risky_region) %&gt;% summarize(Total_Area = sum(area, na.rm = TRUE), Count_Fires = n(), Mean_area = mean(area, na.rm = TRUE), Median_area = median(area, na.rm = TRUE),) risky_region Total_Area Count_Fires Mean_area Median_area 0 5558.29 391 14.215575 0.76 1 1054.37 116 9.089397 0.00 From this table we can observe: That fires in Risky Areas are proportionally in much higher number. They are 6 regions out of 72 and more than 1/4 of the fires. In addition, almost 1/5 of the burned areas were in risky regions. options(repr.plot.width=15, repr.plot.height=5) # managing the size df_fires$region_plot &lt;- df_fires$region for (i in 1:nrow(df_fires)){ df_fires[i, &#39;region_plot&#39;] &lt;- ifelse(df_fires[i, &#39;risky_region&#39;] == 1, df_fires[i, &#39;Region&#39;], &quot;Non_Risky&quot;) } region59 &lt;- df_fires[df_fires$Region == 59,] # Top Right: Set a different color for each group ggplot(df_fires, aes(x=region_plot, y=area, fill=region_plot)) + geom_boxplot(alpha=0.3) + theme(legend.position=&quot;none&quot;) Conclusion: The plot above is very conclusive, altough the oposite may be aparent. The predictors we salected from regions have: A small number of outliers compared to other variables. A big number of count of fires. In conclusion, they are well behaved, with a stable distribution and therefore are good predictors. Temporal Predictiors We will start by ploting a chart previously developed. options(repr.plot.width=15, repr.plot.height=10) # managing the size grid.arrange(p3, p4, p7, p8, nrow = 2, ncol = 2) # making the plot We consider this plots sufficient to demonstrate the importance of summer and autum in predicting the fires. We have alredy made clear that all models have selected seasonsummer and seasonautumn and weekend as predictors with a good P-value. FWI We have demostrated the correlation between DMC:DC and used it as a predictor which made it a chosen variable. Also DMC was chosen as a relevant variable. Choosing the Best Predictor Now, we will make a linear regression with the predictors normalized to finally compare than all in the same scale. df_fires$DMC_DC &lt;- df_fires$DMC * df_fires$DC # missing variable # normalize function normalize &lt;- function(x) { return ((x - min(x)) / (max(x) - min(x))) } df_fires_normal &lt;- df_fires df_fires_normal$X &lt;- normalize(df_fires$X) df_fires_normal$Y &lt;- normalize(df_fires$Y) df_fires_normal$Region1 &lt;- normalize(df_fires$Region1) df_fires_normal$Region20 &lt;- normalize(df_fires$Region20) df_fires_normal$Region42 &lt;- normalize(df_fires$Region42) df_fires_normal$Region43 &lt;- normalize(df_fires$Region43) df_fires_normal$Region52 &lt;- normalize(df_fires$Region52) df_fires_normal$Region59 &lt;- normalize(df_fires$Region59) df_fires_normal$DMC &lt;- normalize(df_fires$DMC) df_fires_normal$DMC_DC &lt;- normalize(df_fires$DMC_DC) df_fires_normal$seasonwinter &lt;- normalize(df_fires$seasonwinter) df_fires_normal$seasonsummer &lt;- normalize(df_fires$seasonsummer) df_fires_normal$weekend &lt;- normalize(df_fires$weekend) Final_predictors &lt;- c(&#39;X&#39;, &#39;Y&#39;, &#39;Region1&#39;, &#39;Region20&#39;, &#39;Region42&#39;, &#39;Region43&#39;, &#39;Region52&#39;, &#39;Region59&#39;, &#39;DMC&#39;, &#39;DMC_DC&#39;, &#39;seasonwinter&#39;, &#39;seasonsummer&#39;, &#39;weekend&#39;, &#39;logarea&#39;) summary(lm(simplify(&quot;logarea&quot;, Final_predictors), data = df_fires_normal)) Warning message in model.matrix.default(mt, mf, contrasts): &quot;the response appeared on the right-hand side and was dropped&quot; Warning message in model.matrix.default(mt, mf, contrasts): &quot;problem with term 14 in model.matrix: no columns are assigned&quot; Call: lm(formula = simplify(&quot;logarea&quot;, Final_predictors), data = df_fires_normal) Residuals: Min 1Q Median 3Q Max -1.7669 -1.0384 -0.5150 0.8502 5.5111 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 0.72073 0.23018 3.131 0.00184 ** X 0.88915 0.34406 2.584 0.01004 * Y -1.17358 0.55282 -2.123 0.03426 * Region1 -0.63040 0.36807 -1.713 0.08739 . Region20 0.42553 0.35053 1.214 0.22534 Region42 -0.63138 0.34022 -1.856 0.06408 . Region43 -0.50556 0.26307 -1.922 0.05521 . Region52 -0.45570 0.45342 -1.005 0.31538 Region59 -0.52602 0.30475 -1.726 0.08496 . DMC 3.62813 1.63565 2.218 0.02700 * DMC_DC -2.53069 1.57345 -1.608 0.10839 seasonwinter 0.75424 0.29133 2.589 0.00991 ** seasonsummer -0.50650 0.18525 -2.734 0.00648 ** weekend 0.03503 0.12526 0.280 0.77986 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.386 on 493 degrees of freedom Multiple R-squared: 0.05152, Adjusted R-squared: 0.02651 F-statistic: 2.06 on 13 and 493 DF, p-value: 0.01519 Observations: X, Y, Region1, DMC, seasonsummer and seasonwinter again showed p-value under 0.05 and therefore have influence. DMC and DMC_DC have the highest magnitude, which in this case might mean the highest influence on the area burned. 6. Conclusion In this project our primary task was to model the burned areas of fires in Portugal that occured between the years of 2000 and 2003 according to 12 predictors. We have started performing an intensive exploration of the dataset in each of its dimensions. The dataset variables related time, geographic regions, metheorology and the FWI system. After performing successive tasks and reshaping the dataset with new variables different models were proposed to model the area. After arriving to a subset of 3 final models they’re performance was compared according to RMSE and MAD metrics and finally the most relevant variables were identified. Some of the learning outcomes and relevat observations from the project. By developing heatmap plots we werre able to understand the relevance of the geographical component. Our next step was then to identify the riskiest areas and create dummy variables for each it. By creating new variables such as seasom and weekend, we could enhance our dataset with relevant and improved features. By identifyig the strong correlation between DC and DMC we were able to use them together in a model and explore the synergy. After performing all tasks this was a selected variable. Subset selection was extensevely used in our model development, which increased significantly the performance of our model with respect to ajusted R-squared and F-statistic. Removing influential points was crucial to our model performance. We used Cooks distance approach. A honest attemp to create a model by joinning to logist and linear models. Results were not extraordinary but model building rests as an outcome. Using RMSE and MAD to compare models gave a dimension of the success in the prediction task. 7. References Cortez, P., &amp; Morais, A. D. J. R. (2007). A data mining approach to predict forest fires using meteorological data. Retrieved from http://www3.dsi.uminho.pt/pcortez/fires.pdf Yanghe Huo. What Influences Forest Fires Area?. Retrieved from http://www.columbia.edu/~yh2693/ForestFire.html datasharkie. (Accessed on 2020, may 09). How to normalize data in R. Retrieved from https://datasharkie.com/how-to-normalize-data-in-r/ user3459010 (2019). *Removing outliers based on cook’s distance in R Language Retrieved from https://stats.stackexchange.com/questions/164099/removing-outliers-based-on-cooks-distance-in-r-language r-graph-gallery. (Accessed on 2020, may 09). Heatmap. Retrieved from https://www.r-graph-gallery.com/heatmap zx8754 (2019). Generate a dummy-variable https://stackoverflow.com/questions/11952706/generate-a-dummy-variable" /><meta property="og:description" content="Table of Contents Introduction Data Exploration Model Development Model Comparison Variable Identification and Explanation Conclusion References 1. Introduction In this project we aim to create models that can predict the area burned in fires. We will be working with data from the UCI machine learning repository and is a collection curated by scientists Paulo Cortez and Anibal Morais from the Unviersity of Minho, Portugal. The data includes meteorological measurements taken at the time the fire was reported, spatial/temporal measurements, and index metrics that take into a account weather data in the recent past. The index metrics are a part of the Canadian Fire Weather Index System (FWI). The data was collected from January 2000 to December 2003 from the northeast region of Portugal. Data was collected from a total of 517 fires. Many different ML models can be applied - in the basis paper the one who achieved the best performance was Support Vector Machines (SVM). However, in this project we will be testing advanced regression techniques only. Our work will follow the steps: Perform data exploration and understand the trends in the dataset. Do necessary data manipulations such as data reshaping and outlier removal to enhance the dataset. Create models to predict the burned area according to different regression techniques. Compare the models performance and choose a winner. Explain the most relevant predictors according to the models and the data exploration. Attribute information: Provided with the data 1. Spatial information X: x-axis spatial coordinate within the Montesinho park map: 1 to 9 Y: y-axis spatial coordinate within the Montesinho park map: 2 to 9 2. Temporal information month: month of the year: “jan” to “dec” day: day of the week: “mon” to “sun” 3. FWI: The forest Fire Weather Index (FWI). Which is the Canadian system for rating fire danger. FFMC: FFMC index from the FWI system: 18.7 to 96.20 DMC: DMC index from the FWI system: 1.1 to 291.3 DC: DC index from the FWI system: 7.9 to 860.6 ISI: ISI index from the FWI system: 0.0 to 56.10 4. Methorological information temp: temperature in Celsius degrees: 2.2 to 33.30 RH: relative humidity in %: 15.0 to 100 wind: wind speed in km/h: 0.40 to 9.40 rain: outside rain in mm/m2 : 0.0 to 6.4 5. area: the burned area of the forest (in ha): 0.00 to 1090.84 Programming Language: R 3.5.1 in Jupyter Notebook R Libraries used: caret data.table dplyr e1071 GGally ggplot2 grid gridExtra lattice leaps MASS PerformanceAnalytics Importing Libraries library(ggplot2) # for improved plots library(GGally) # for scatterplot matrix library(e1071) # For ML functions library(MASS) # For ML functions library(data.table) # manipultaion such as inner joins library(grid) # functions and classes that represent graphical objects or grobs library(gridExtra) # organizing plots library(lattice) # for levelplot library(dplyr) # for data manipulation library(PerformanceAnalytics) library(caret) # library(leaps) # for regsubsets function 2. Data Exploration Load the data df_fires &lt;- read.csv(file=&quot;forestfires.csv&quot;, header=TRUE, sep=&quot;,&quot;) head(df_fires) # Dysplay first six rows of the table id X Y month day FFMC DMC DC ISI temp RH wind rain area 1 7 5 mar fri 86.2 26.2 94.3 5.1 8.2 51 6.7 0.0 0 2 7 4 oct tue 90.6 35.4 669.1 6.7 18.0 33 0.9 0.0 0 3 7 4 oct sat 90.6 43.7 686.9 6.7 14.6 33 1.3 0.0 0 4 8 6 mar fri 91.7 33.3 77.5 9.0 8.3 97 4.0 0.2 0 5 8 6 mar sun 89.3 51.3 102.2 9.6 11.4 99 1.8 0.0 0 6 8 6 aug sun 92.3 85.3 488.0 14.7 22.2 29 5.4 0.0 0 Understanding the burned area distribution As previously stated we aim to predict the area of the fire according to the other variables. it is logical that we start our data exploration from the area. A first look at the table above show that the area is 0 in all of the first rows which is a concern. The authors in their paper have explained that an area smaller than $100m^2$ is replaced by 0. Lets check the distribution of the burned area using an histogram. options(repr.plot.width=7, repr.plot.height=5) # area of display ggplot(df_fires, aes(area)) + geom_histogram(bins = 50) + theme_linedraw() + ggtitle(&quot;Distribution of Area Burned (Histogram)&quot;) This is an extremely skewed variable and most likely to make a prediction we will have to handle it accordingly. We plan to do a regression in the future and this might be a problem, because for the residuals to be normal the predicted variable should not be extremely skewed distribution. A possible first strategy is to apply transformatio methods such as the logarithm and see how the data will reshape. Important: As we saw many of the data points of area are equal to 0 - so we cannot pass the pure log, but instead we will apply the formula . Log transformation on the area df_fires$logarea &lt;- log(df_fires$area+1) # plotting the new distribution ggplot(df_fires, aes(logarea)) + geom_histogram(bins = 100) + theme_linedraw() + ggtitle(&quot;Distribution of LogArea Burned (Histogram)&quot;) Our data remains skilled, however, can see small improve in the distribution of the data. We will make a final analysis, by checking what happens if we do not consider the very small fires (size 0). ggplot(df_fires[df_fires$logarea!= 0,], aes(logarea)) + geom_histogram(bins = 100) + theme_linedraw() + ggtitle(&quot;Distribution of LogArea Burned (Histogram)&quot;) Observations regarding the distribution of the data: The distribution of the burned area is very skill and this might be a problem for modelling. We have made a first log transformation that made slight improve. If we exclude the close to 0 fires we will find a closely normal distribution which might be good to work with for modelling tasks. Spatial Analysis The dataset contains spatial information representing the fires location. The X and Y variables represent the geographical locations in a map and can only be analysed together to make sense. The X axis ranges from 1 to 9 (integers) while the y axis from 2 to 9. Together, they form an area of 72 spaces. We will develop heatmaps in the folowing to identify areas that have been particular areas of focus of fires with respect to: The area affected. The number of fires. Other variables that we might want to compare # create a table # grouping other variables by area df_spatial &lt;- df_fires %&gt;% group_by(X,Y) %&gt;% summarize(Total_Area = sum(area, na.rm = TRUE), Count_Fires = n(), temp = median(temp, na.rm = TRUE), RH = median(RH, na.rm = TRUE), wind = median(wind, na.rm = TRUE), rain = median(rain, na.rm = TRUE), FFMC = median(FFMC, na.rm = TRUE), DMC = median(DMC, na.rm = TRUE), DC = median(DC, na.rm = TRUE), ISI = median(ISI, na.rm = TRUE) ) We want to develop a very specific heatmap, with many different features. To simplify the process of plotting we will create a function that will be used to make applied to make different plots. areaheatplot &lt;- function(scale, tittle) { Total.heatmap &lt;- ggplot(data = df_spatial, mapping = aes(x = X, y = Y, fill = scale)) + ggtitle(tittle) + geom_tile(position=position_nudge(x = 0.5, y= 0.5), colour = &quot;blue&quot;) + theme_linedraw() + theme(panel.grid.major = element_line(colour = &quot;blue&quot;)) + scale_fill_gradient(low=&quot;orange&quot;, high=&quot;red&quot;, na.value =&quot;white&quot;) + geom_text(aes(label = round(scale, 1)), position=position_nudge(x = 0.5, y= 0.5)) + scale_x_discrete(breaks=seq(1, 10, 1), limits = seq(1, 10, 1)) + scale_y_discrete(breaks=seq(1, 9, 1), limits = seq(1, 9, 1)) return (Total.heatmap) } Now, we will investigate different trends that data may show according to the region in which the fire happened. Firstly, we will try to observe some areas are more likely to have fires than others. area_plot &lt;- areaheatplot(df_spatial$Total_Area, &quot;Total Area&quot;) count_plot &lt;- areaheatplot(df_spatial$Count_Fires, &quot;Number of Fires&quot;) options(repr.plot.width=14, repr.plot.height=4) # managing the size grid.arrange(area_plot, count_plot, nrow = 1, ncol = 2) # making the plot Observations: Clearly there are more area that are more prone to fires than others. The interesection between X (6-9) and Y (4-7) accounts for more than half of fires. Most regions did not have fires at all. Now, we will try to explore the metheorological conditions by region to see if areas that have more fires have any peculiar trends. We will build 8 plots, regions against: Temperature, RH, Wind, Rain, FFMC, DMC, DC, ISI. temp_plot &lt;- areaheatplot(df_spatial$temp, &quot;Temperature&quot;) RH_plot &lt;- areaheatplot(df_spatial$RH, &quot;RH&quot;) wind_plot &lt;- areaheatplot(df_spatial$wind, &quot;Wind&quot;) rain_plot &lt;- areaheatplot(df_spatial$rain, &quot;Rain&quot;) FFMC_plot &lt;- areaheatplot(df_spatial$FFMC, &quot;FFMC&quot;) DMC_plot &lt;- areaheatplot(df_spatial$DMC, &quot;DMC&quot;) DC_plot &lt;- areaheatplot(df_spatial$DC, &quot;DC&quot;) ISI_plot &lt;- areaheatplot(df_spatial$ISI, &quot;ISI&quot;) options(repr.plot.width=14, repr.plot.height=15) # managing the size grid.arrange(temp_plot, RH_plot, wind_plot, rain_plot, FFMC_plot, DMC_plot, DC_plot, ISI_plot, nrow = 4, ncol = 2) # making the plot Observations: The latest charts are very useful to explore visually the relationship of variables with areas. Due to complexity, it is difficult to arrive to conclusions for modelling purposes. Apparently areas with more fires also have higher proportion of the other variables such as higher temperatures and Relative Humidity. Creating New Dummy Variables for Risky Areas - One Hot Encoding of Regions A region is a area formed by a X and a Y point. In total, there are 72 regions - with X ranging from 1-9 and Y raging from 2-9. Therefore we will create a new variable called region, because it will be better to analyse the data considering that hardly X and Y independently would make sense to analyse. As we have seen there are areas that are more prone to fires than others. This was explored even with relationship to other variables. We want our model to be able to capture this “risk” so we will make some modifications in our dataset. We will create dummy variables for all regions that concentrate more than 2% (at least 10) of the number of fires. We have chosen this threshold because we do not want our future models to overfit by using this new variables. # adding region variable df_area &lt;- data.frame(Region = 1:72, X = 1:9, Y = 2:9) df_fires &lt;- left_join(df_fires, df_area, by = c(&quot;X&quot;, &quot;Y&quot;)) # group by region the number of fires df_spatial &lt;- df_fires %&gt;% group_by(Region) %&gt;% summarize(Total_Area = sum(area, na.rm = TRUE), Count_Fires = n()) # filter areas with more than 10 fires attach(df_spatial) df_spatial &lt;- df_spatial[which(Count_Fires &gt; 10),] detach(df_spatial) danger_areas &lt;- df_spatial$Region cat(&quot;Danger Areas: Regions that have more than 10 registered fires \n&quot;, df_spatial$Region) Danger Areas: Regions that have more than 10 registered fires 1 3 4 11 19 20 42 43 52 53 58 59 60 65 67 # creating dummy variables for(i in (danger_areas)){ df_fires[,paste0(&quot;Region&quot;, i)] &lt;- ifelse(test = df_fires$Region == i, yes = 1, no = 0) } We have created 15 dummy variables that may be characterized as risk regions. Temporal Analysis We will further investigate the temporal dimension of the dataset. We want to know if fires are more likely to happen in a especific day or month. We noted, however, that it might be better to explore the data according to seasonality and weekends, because we beleive they should be better predictors. We will now: Create new variables, a dummy for weekends and a seasonality variable. Explore the trends of the variables weekends, seasonality, month and day. # create variable season df_fires$season &lt;- ifelse(df_fires$month == &quot;aug&quot; | df_fires$month == &quot;jun&quot; | df_fires$month == &quot;jul&quot;,&#39;summer&#39;, ifelse(df_fires$month == &quot;oct&quot; | df_fires$month == &quot;nov&quot; | df_fires$month == &quot;sep&quot;,&quot;autumn&quot;, ifelse(df_fires$month == &quot;feb&quot; | df_fires$month == &quot;jan&quot; | df_fires$month ==&quot;dec&quot;, &quot;winter&quot;, ifelse(df_fires$month == &quot;mar&quot; | df_fires$month == &quot;apr&quot; | df_fires$month ==&#39;may&#39;, &quot;spring&quot;, &#39;NA&#39;)))) # create variable weekend # note that we consider fruday a weekend day df_fires$weekend &lt;- ifelse(df_fires$day == &quot;mon&quot; | df_fires$day == &quot;tue&quot; | df_fires$day == &quot;wed&quot;| df_fires$day == &quot;thu&quot;, 0,1) # creating a table with the count of fires df_season &lt;- df_fires %&gt;% group_by(season, month, day, weekend) %&gt;% summarize(Total_Area = sum(logarea, na.rm = TRUE), Count_Fires = n()) day_order &lt;- c(&quot;mon&quot;, &quot;tue&quot;, &quot;wed&quot;, &quot;thu&quot;, &quot;fri&quot;, &quot;sat&quot;, &quot;sun&quot; ) season_order &lt;- c(&quot;summer&quot;, &quot;autumn&quot;, &quot;winter&quot;, &quot;spring&quot;) # Natural order of seasons month_order &lt;- c(&quot;jan&quot;, &quot;feb&quot;, &quot;mar&quot;, &quot;apr&quot;, &quot;may&quot;, &quot;jun&quot;, &quot;jul&quot;, &quot;aug&quot;, &quot;sep&quot;, &quot;oct&quot;, &quot;nov&quot;, &quot;dec&quot;) p1 &lt;- ggplot(df_fires, aes(x= factor(month, level = month_order), y =logarea)) + geom_boxplot(fill=&quot;slateblue&quot;, alpha=0.5) + theme_classic() + ggtitle(&quot;Distribution Fires by Month&quot;) p2 &lt;- ggplot(df_season, aes(x= factor(month, level = month_order), y =Total_Area)) + geom_bar(fill=&quot;grey&quot;, stat=&quot;identity&quot;) + theme_classic() + ggtitle(&quot;Distribution Fires by Month&quot;) p3 &lt;- ggplot(df_fires, aes(x= factor(season, level = season_order), y =logarea)) + geom_boxplot(fill=&quot;slateblue&quot;, alpha=0.5) + theme_classic() + ggtitle(&quot;Distribution Fires by Season&quot;) p4 &lt;- ggplot(df_season, aes(x= factor(season, level = season_order), y =Total_Area)) + geom_bar(fill=&quot;grey&quot;, stat=&quot;identity&quot;) + theme_classic() + ggtitle(&quot;Distribution Fires by Season&quot;) p5 &lt;- ggplot(df_fires, aes(x= factor(day, level = day_order), y =logarea)) + geom_boxplot(fill=&quot;slateblue&quot;, alpha=0.5) + theme_classic() + ggtitle(&quot;Distribution Fires by Day&quot;) p6 &lt;- ggplot(df_season, aes(x= factor(day, level = day_order), y =Total_Area)) + geom_bar(fill=&quot;grey&quot;, stat=&quot;identity&quot;) + theme_classic() + ggtitle(&quot;Distribution Fires by Day&quot;) p7 &lt;- ggplot(df_fires, aes(x= factor(weekend), y =logarea)) + geom_boxplot(fill=&quot;slateblue&quot;, alpha=0.5) + theme_classic() + ggtitle(&quot;Distribution Fires by Weekend&quot;) p8 &lt;- ggplot(df_season, aes(x= factor(weekend), y =Total_Area)) + geom_bar(fill=&quot;grey&quot;, stat=&quot;identity&quot;) + theme_classic() + ggtitle(&quot;Distribution Fires by Weekend&quot;) options(repr.plot.width=15, repr.plot.height=15) # managing the size grid.arrange(p1, p2, p3, p4, p5, p6, p7, p8, nrow = 4, ncol = 2) # making the plot Some observations about the temporal data. As expected summer has the highest number of fires, as we have seen that temperature is correlated to number of fires. Winter has a very small of fires compared to other seasons, but curiously the highest median. More than 70% of fires are either in summer or autumn. We expect this predictor to have a significant prediction power and we will create dummy variables for each season. We are considering weekends with 3 days and weekdays of 4 days. Nevertheless there are more fires in weekends. This might demonstrate a relationship of fires with human activity. This is especially true if we consider that there are many significant fire outliers on weekends. One Hot Encoding of Seasons To work with seasons it will be preferable to create dummy variables. This is what we will do next. seasons &lt;- unique(df_fires$season) for(i in (seasons)){ df_fires[,paste0(&quot;season&quot;, i)] &lt;- ifelse(test = df_fires$season == i, yes = 1, no = 0) } df_fires &lt;- subset(df_fires, select = -c(seasonspring)) # eliminating a season for the one_hot_encoding A first look at correlations Lets investigate how the variables relate to each other. To explore correlations we will leave the previously explored variables - related to temporal and and spatial analysis. options(repr.plot.width=15, repr.plot.height=10) # managing the size ggpairs(df_fires[,c(seq(5,13))]) This chart is particularly useful as other than the correlation we can see the distribution of the variables. With respect to correlation: There is no significant and strong correlation with two variables. Only one exception should be noticed, DC and DMC. They might be useful working together in our models. Temp apparently have a meaningful but small positive correlation with ISI, DC, DMC and FFMC. Even though many of the variables have been extracted from other variables, as an example, DC from rain and temperature, our variables seem to have a good level of independence that allow us to work with them together with no major concerns with colinearity and similar problems. 3. Model Development We will develop 2-3 models in this part of the project, with goal of predicting the burned area. Before performaing any modelling task, however, we will split the data in trainning and testing. Naturally, will we use a cross-validation approach. We will split the dataset in train and test, having 80% of trainning data. split Dataset in train and test set.seed(210) n &lt;- nrow(df_fires) shuffled &lt;- df_fires[sample(n),] df_train_fires &lt;- shuffled[1:round(0.80 * n),] df_test_fires &lt;- shuffled[(round(0.80 * n) + 1):n,] rownames(df_train_fires) &lt;- 1:nrow(df_train_fires) Influential Outliers Detection We have observed that the dataset has a right skewed distribution, and with significant outliers that may compromise our models. In this project we want to apply exclusevely linear models along with logistic regressions and therefore we would benefit from a clean dataset. Therefore we will remove significant outliers from our dataset. There are two recommended approaches in this situation: Remove outliers according to boxplot distribution. Remove Influential points according to Cooks distance. We have decided to take the second approach as we believe it is more aligned with the scope of our project and regression models. We will do it by the following steps. Filter from the dataset all non-zero area points. We want to do it because we will build some models that will target the non-zero distribution of the area. Build a simple linear regression with all predictors. Find influential points. Remove influential points from the dataset. Obs: The method used in this extraction was influenced by the following work. attach(df_train_fires) posit_data &lt;- df_train_fires[which(area &gt; 0),] options(repr.plot.width=15, repr.plot.height=10) # managing the size mod &lt;- lm(logarea ~ ., data=posit_data[c(seq(1,12),seq(14,31))]) # regression model cooksd &lt;- cooks.distance(mod) options(repr.plot.width=12, repr.plot.height=6) # managing the size plot(cooksd, pch=&quot;*&quot;, cex=2, main=&quot;Influential Obs by Cooks distance&quot;) # plot cook&#39;s distance abline(h = 4*mean(cooksd, na.rm=T), col=&quot;red&quot;) # add cutoff line text(x=1:length(cooksd), y=cooksd+0.002, labels=ifelse(cooksd&gt;4*mean(cooksd, na.rm=T),names(cooksd),&quot;&quot;), col=&quot;red&quot;) # add labels influential = which(cooksd&gt;4*mean(cooksd, na.rm=T)) # finding influential points df_train_fires[as.numeric(names(influential)), 1:13] id X Y month day FFMC DMC DC ISI temp RH wind rain area 11 8 8 aug wed 91.7 191.4 635.9 7.8 26.2 36 4.5 0 185.76 88 7 4 jul mon 89.2 103.9 431.6 6.4 22.6 57 4.9 0 278.53 112 8 6 aug thu 94.8 222.4 698.6 13.9 27.5 27 4.9 0 746.28 152 1 2 jul sat 90.0 51.3 296.3 8.7 16.6 53 5.4 0 0.71 173 7 4 aug sat 93.5 139.4 594.2 20.3 5.1 96 5.8 0 26.00 194 1 2 sep tue 91.0 129.5 692.6 7.0 18.8 40 2.2 0 212.88 204 6 5 sep sat 92.5 121.1 674.4 8.6 25.1 27 4.0 0 1090.84 304 4 3 aug wed 94.5 139.4 689.1 20.0 28.9 29 4.9 0 49.59 324 9 9 jul tue 85.8 48.3 313.4 3.9 18.0 42 2.7 0 0.36 411 2 4 aug sun 81.6 56.7 665.6 1.9 21.9 71 5.8 0 54.29 df_fires = df_fires[-as.numeric(names(influential)), ] # removing from the dataset Model 1 - Linear Regression Our first model will be a simple linear regression. We have observed that the area is not normally distributed and therefore it is preferable to predict the log of area. Nevertheless, we will also test a model to predict the area. As we know, the formula of the regression is: First Model: Second Model: When fitting a regression we want to obtain the best performance of our metrics. The most relevant are: R-Squared: Represents the proportion of the variance for a dependent variable that’s explained by independent variables. The higher the better. Adjusted R-squared: Simillar to R-squared, but also compares the explanatory power of regression models that contain different numbers of predictors. The higher the better. F-Test: Indicates if the model provides a better fit to the data than a model that contains no independent variables. The higher the better. RMSE: Represents the standard deviation of the differences between predicted values and observed values (residuals). The lower the better. names(df_train_fires) &#39;X&#39;&#39;Y&#39;&#39;month&#39;&#39;day&#39;&#39;FFMC&#39;&#39;DMC&#39;&#39;DC&#39;&#39;ISI&#39;&#39;temp&#39;&#39;RH&#39;&#39;wind&#39;&#39;rain&#39;&#39;area&#39;&#39;logarea&#39;&#39;Region&#39;&#39;Region1&#39;&#39;Region3&#39;&#39;Region4&#39;&#39;Region11&#39;&#39;Region19&#39;&#39;Region20&#39;&#39;Region42&#39;&#39;Region43&#39;&#39;Region52&#39;&#39;Region53&#39;&#39;Region58&#39;&#39;Region59&#39;&#39;Region60&#39;&#39;Region65&#39;&#39;Region67&#39;&#39;season&#39;&#39;weekend&#39;&#39;seasonautumn&#39;&#39;seasonsummer&#39;&#39;seasonwinter&#39; We will create a list of the variables called predictors that will help us in the progress of our model development. Also a support function that will be used to have less wording in the model development. A important note: We will explore the sinergy of DC and DMC - as we saw in the previous section and they are strongly correlated. # create a list of variables to use in modelling predictors &lt;- c(&quot;X&quot;, &quot;Y&quot;, &quot;FFMC&quot;, &quot;DMC&quot;, &quot;DMC:DC&quot;, &quot;ISI&quot;, &quot;temp&quot;, &quot;RH&quot;, &quot;wind&quot;, &quot;rain&quot;, &quot;Region1&quot;, &quot;Region3&quot;, &quot;Region4&quot;, &quot;Region11&quot;, &quot;Region19&quot;, &quot;Region20&quot;, &quot;Region42&quot;, &quot;Region43&quot;, &quot;Region52&quot;, &quot;Region53&quot;, &quot;Region58&quot;, &quot;Region59&quot;,&quot;Region60&quot;, &quot;Region65&quot;, &quot;weekend&quot;, &quot;seasonautumn&quot;, &quot;seasonwinter&quot;, &quot;seasonsummer&quot;) simplify &lt;- function(y, predictors){ return(as.formula(paste(y, &quot;~&quot;, paste(predictors, collapse = &quot;+&quot;)))) } # Fitting the models lm_area &lt;- lm(simplify(&quot;area&quot;, predictors), data = df_train_fires) lm_logarea &lt;- lm(simplify(&quot;logarea&quot;, predictors), data = df_train_fires) # summary of the model (estimates and metrics) summary(lm_area) summary(lm_logarea) Call: lm(formula = simplify(&quot;area&quot;, predictors), data = df_train_fires) Residuals: Min 1Q Median 3Q Max -60.70 -20.82 -6.98 5.01 1024.21 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) -5.768e+01 8.366e+01 -0.690 0.4909 X 3.379e+00 3.696e+00 0.914 0.3612 Y -4.351e-01 6.178e+00 -0.070 0.9439 FFMC -7.792e-02 8.029e-01 -0.097 0.9227 DMC 7.302e-01 3.462e-01 2.110 0.0355 * ISI -7.071e-01 9.687e-01 -0.730 0.4659 temp 1.939e+00 1.217e+00 1.594 0.1118 RH -9.880e-02 3.435e-01 -0.288 0.7738 wind 2.720e+00 2.184e+00 1.245 0.2139 rain -2.418e+00 1.158e+01 -0.209 0.8347 Region1 1.338e+01 2.543e+01 0.526 0.5992 Region3 -1.343e+00 1.610e+01 -0.083 0.9335 Region4 1.998e+00 1.835e+01 0.109 0.9134 Region11 4.730e-01 1.989e+01 0.024 0.9810 Region19 1.194e+01 2.603e+01 0.459 0.6466 Region20 -2.145e+00 2.206e+01 -0.097 0.9226 Region42 -1.216e+01 2.202e+01 -0.552 0.5812 Region43 -7.094e+00 1.783e+01 -0.398 0.6909 Region52 -9.631e+00 2.664e+01 -0.362 0.7179 Region53 6.323e+00 1.772e+01 0.357 0.7215 Region58 -1.579e+00 2.074e+01 -0.076 0.9394 Region59 -1.200e+01 1.811e+01 -0.663 0.5078 Region60 2.201e+01 1.478e+01 1.489 0.1373 Region65 1.033e+01 2.341e+01 0.441 0.6594 weekend 1.116e+00 7.387e+00 0.151 0.8800 seasonautumn 1.368e+01 1.581e+01 0.865 0.3876 seasonwinter 3.079e+01 2.022e+01 1.523 0.1286 seasonsummer -1.542e+01 1.756e+01 -0.878 0.3806 DMC:DC -7.666e-04 3.965e-04 -1.934 0.0539 . --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 70.83 on 385 degrees of freedom Multiple R-squared: 0.05539, Adjusted R-squared: -0.01331 F-statistic: 0.8063 on 28 and 385 DF, p-value: 0.7493 Call: lm(formula = simplify(&quot;logarea&quot;, predictors), data = df_train_fires) Residuals: Min 1Q Median 3Q Max -2.1635 -0.9899 -0.4054 0.7261 5.1428 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) -8.455e-01 1.646e+00 -0.514 0.60766 X 1.569e-01 7.271e-02 2.158 0.03154 * Y -2.417e-01 1.215e-01 -1.989 0.04740 * FFMC 1.281e-02 1.579e-02 0.811 0.41774 DMC 1.453e-02 6.809e-03 2.134 0.03345 * ISI -1.574e-02 1.905e-02 -0.826 0.40937 temp 3.150e-02 2.393e-02 1.316 0.18881 RH 2.656e-03 6.756e-03 0.393 0.69447 wind 9.700e-02 4.297e-02 2.258 0.02453 * rain 1.291e-01 2.277e-01 0.567 0.57099 Region1 -8.881e-01 5.002e-01 -1.775 0.07663 . Region3 -6.338e-01 3.166e-01 -2.002 0.04599 * Region4 -3.222e-01 3.610e-01 -0.893 0.37260 Region11 1.459e-01 3.913e-01 0.373 0.70946 Region19 5.081e-01 5.120e-01 0.992 0.32163 Region20 2.239e-01 4.340e-01 0.516 0.60619 Region42 -1.117e+00 4.331e-01 -2.579 0.01027 * Region43 -8.885e-01 3.507e-01 -2.533 0.01169 * Region52 -8.646e-01 5.240e-01 -1.650 0.09978 . Region53 -1.898e-01 3.486e-01 -0.545 0.58641 Region58 -2.241e-01 4.079e-01 -0.549 0.58309 Region59 -8.085e-01 3.561e-01 -2.270 0.02375 * Region60 -1.806e-01 2.908e-01 -0.621 0.53501 Region65 -6.117e-01 4.605e-01 -1.328 0.18482 weekend 1.277e-02 1.453e-01 0.088 0.93000 seasonautumn 2.510e-01 3.111e-01 0.807 0.42024 seasonwinter 1.121e+00 3.977e-01 2.818 0.00507 ** seasonsummer -5.150e-01 3.454e-01 -1.491 0.13682 DMC:DC -1.442e-05 7.799e-06 -1.849 0.06523 . --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.393 on 385 degrees of freedom Multiple R-squared: 0.1008, Adjusted R-squared: 0.0354 F-statistic: 1.541 on 28 and 385 DF, p-value: 0.04093 As expected lm_logarea performed better than lm_area, because logarea is more appropriate as a label. Therefore we will be working exclusevely with lm_logarea from now on. It calls our attention that the model has a small predictive power with respect to the metrics of performance, such as F-statistic and R-squared. In fact we found an negative adjusted R-Squared in lm_area which means the model contains terms that do not help to predict the response. Let’s proceed with diagnostic plots. options(repr.plot.width=10, repr.plot.height=8) # managing the size par(mfcol=c(2,2)) plot(lm_logarea) The diagnostic plots show residuals in four different ways. Some observations about the plots: Residual vs fitted plot and scale-location plot: They access if the residuals have non-linear patterns and if residuals are spread equally along the ranges of predictors. We can see an abnormal pattern such as some points in a linear trend. Other points are well behaved. Q-Q plot: Unfortunately we can observe that the distribution of the residuals is not normal and this might explain the performance of our model. Residual-leverage plot: Since we have previously performed data manipulation removing outliers and highly influential points, they are not a concern in this step. There is a limitrofe point just on the 0.5 line but we will keep it for now. Subset Selection In this task, we will use the regsubsets() function to perform best subset selection in order to choose the best model containing the predictors. We want the best model obtained according to $C_p$, $BIC$, and adjusted $R^2$. Show some plots to provide evidence for your answer, and report the coefficients of the best model obtained. lm_subset &lt;- regsubsets(simplify(&quot;logarea&quot;, predictors), data = df_train_fires, nvmax = 40) lm_subset.summary &lt;- summary(lm_subset) lm_subset.summary Subset selection object Call: regsubsets.formula(simplify(&quot;logarea&quot;, predictors), data = df_train_fires, nvmax = 40) 28 Variables (and intercept) Forced in Forced out X FALSE FALSE Y FALSE FALSE FFMC FALSE FALSE DMC FALSE FALSE ISI FALSE FALSE temp FALSE FALSE RH FALSE FALSE wind FALSE FALSE rain FALSE FALSE Region1 FALSE FALSE Region3 FALSE FALSE Region4 FALSE FALSE Region11 FALSE FALSE Region19 FALSE FALSE Region20 FALSE FALSE Region42 FALSE FALSE Region43 FALSE FALSE Region52 FALSE FALSE Region53 FALSE FALSE Region58 FALSE FALSE Region59 FALSE FALSE Region60 FALSE FALSE Region65 FALSE FALSE weekend FALSE FALSE seasonautumn FALSE FALSE seasonwinter FALSE FALSE seasonsummer FALSE FALSE DMC:DC FALSE FALSE 1 subsets of each size up to 28 Selection Algorithm: exhaustive X Y FFMC DMC ISI temp RH wind rain Region1 Region3 Region4 1 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 5 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 7 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 8 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 9 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 10 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 11 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 12 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 13 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 14 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 15 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 16 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 17 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 18 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 19 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 20 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 21 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 22 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 23 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 24 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 25 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; Region11 Region19 Region20 Region42 Region43 Region52 Region53 1 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 5 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 7 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 8 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 9 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 10 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 11 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; 12 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; 13 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; 14 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; 15 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 16 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 17 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 18 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 19 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 20 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 21 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 22 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 23 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 24 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 25 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 26 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; Region58 Region59 Region60 Region65 weekend seasonautumn seasonwinter 1 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; 5 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 7 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 8 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; 9 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; 10 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; 11 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; 12 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; 13 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 14 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; 15 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; 16 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; 17 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 18 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 19 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 20 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 21 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 22 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 23 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 24 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 25 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; seasonsummer DMC:DC 1 ( 1 ) &quot; &quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot; &quot; 5 ( 1 ) &quot;*&quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot; &quot; 7 ( 1 ) &quot; &quot; &quot;*&quot; 8 ( 1 ) &quot;*&quot; &quot;*&quot; 9 ( 1 ) &quot;*&quot; &quot;*&quot; 10 ( 1 ) &quot;*&quot; &quot;*&quot; 11 ( 1 ) &quot;*&quot; &quot;*&quot; 12 ( 1 ) &quot;*&quot; &quot;*&quot; 13 ( 1 ) &quot; &quot; &quot;*&quot; 14 ( 1 ) &quot;*&quot; &quot;*&quot; 15 ( 1 ) &quot;*&quot; &quot;*&quot; 16 ( 1 ) &quot;*&quot; &quot;*&quot; 17 ( 1 ) &quot;*&quot; &quot;*&quot; 18 ( 1 ) &quot;*&quot; &quot;*&quot; 19 ( 1 ) &quot;*&quot; &quot;*&quot; 20 ( 1 ) &quot;*&quot; &quot;*&quot; 21 ( 1 ) &quot;*&quot; &quot;*&quot; 22 ( 1 ) &quot;*&quot; &quot;*&quot; 23 ( 1 ) &quot;*&quot; &quot;*&quot; 24 ( 1 ) &quot;*&quot; &quot;*&quot; 25 ( 1 ) &quot;*&quot; &quot;*&quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; Due to the fact we have created many dummy variables for geographic region, our model may have up to 40 variables. We have found the best subset for n variables, when n ranges from 1 to 30. Now we will plot the number of variables from the best models against the accuracy indicators such as Cp, BIC, Ajusted R-squared and RSS. options(repr.plot.width=15, repr.plot.height=10) # managing the size par(mfrow = c(2, 2)) plot(lm_subset.summary$cp, xlab = &quot;Number of variables&quot;, ylab = &quot;C_p&quot;, type = &quot;l&quot;) points(which.min(lm_subset.summary$cp), lm_subset.summary$cp[which.min(lm_subset.summary$cp)], col = &quot;red&quot;, cex = 2, pch = 20) plot(lm_subset.summary$bic, xlab = &quot;Number of variables&quot;, ylab = &quot;BIC&quot;, type = &quot;l&quot;) points(which.min(lm_subset.summary$bic), lm_subset.summary$bic[which.min(lm_subset.summary$bic)], col = &quot;red&quot;, cex = 2, pch = 20) plot(lm_subset.summary$adjr2, xlab = &quot;Number of variables&quot;, ylab = &quot;Adjusted R^2&quot;, type = &quot;l&quot;) points(which.max(lm_subset.summary$adjr2), lm_subset.summary$adjr2[which.max(lm_subset.summary$adjr2)], col = &quot;red&quot;, cex = 2, pch = 20) plot(lm_subset.summary$rss, xlab = &quot;Number of variables&quot;, ylab = &quot;RSS&quot;, type = &quot;l&quot;) mtext(&quot;Plots of C_p, BIC, adjusted R^2 and RSS best subset selection selection&quot;, side = 3, line = -2, outer = TRUE) It is interesting the fact that we have found different models according to each indicator. Lets compare then. coef(lm_subset, which.min(lm_subset.summary$cp)) coef(lm_subset, which.min(lm_subset.summary$bic)) coef(lm_subset, which.max(lm_subset.summary$adjr2)) (Intercept):-0.0266117016454773 DMC: 0.0135111201577867 temp: 0.0301357865043537 wind:0.0794234546908572 Region:1-0.652129755329549 Region3:-0.556361498494578 seasonwinter:0.824436990829506 seasonsummer:-0.625817307938421 DMC:DC:-1.27126321593314e-05 (Intercept):1.19083283788439 Region: 3-0.549921309305286 (Intercept):0.55198302136147 X:0.0926165837619685 Y:-0.194404903439422 DMC0:.013670228896515 temp0:.0305312643068406 wind0:.0839199384373189 Region1:-0.968641287013757 Region3:-0.679272609210134 Region4:-0.416576766202436 Region42:-0.910932398029436 Region43:-0.668493899182849 Region52:-0.606346184501872 Region59:-0.718813149812681 Region65:-0.642247961402224 seasonwinter:0.990242150570015 seasonsummer:-0.691447562888277 DMC:DC:-1.2331282867293e-05 Observations from the subset selection: While $C_P$ indicates a total of 9 predictors, $BIC$ indicates only one. Adjusted-R-squared indicates 18 variables. We will reject the BIC analysis as we do not believe the model will have a good fit in the test data and work exclusevely with the second and third models. # create variables predictors_cp &lt;- c(&#39;DMC&#39;,&#39;temp&#39;,&#39;wind&#39;, &#39;Region1&#39;, &#39;Region3&#39;,&#39;seasonwinter&#39;, &#39;seasonsummer&#39;, &#39;DMC:DC&#39;) predictors_adjR &lt;- c(&#39;X&#39;, &#39;Y&#39;, &#39;DMC&#39;, &#39;temp&#39;, &#39;wind&#39;, &#39;Region1&#39;, &#39;Region3&#39;, &#39;Region4&#39;, &#39;Region42&#39;, &#39;Region43&#39;, &#39;Region52&#39;, &#39;Region59&#39;, &#39;Region65&#39;,&#39;seasonwinter&#39;, &#39;seasonsummer&#39;, &#39;DMC:DC&#39;) lm_cp_logarea &lt;- lm(simplify(&quot;logarea&quot;, predictors_cp), data = df_train_fires) lm_adjR2_logarea &lt;- lm(simplify(&quot;logarea&quot;, predictors_adjR), data = df_train_fires) summary(lm_cp_logarea) summary(lm_adjR2_logarea) Call: lm(formula = simplify(&quot;logarea&quot;, predictors_cp), data = df_train_fires) Residuals: Min 1Q Median 3Q Max -1.9576 -1.0736 -0.4319 0.8178 5.3502 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) -2.661e-02 3.775e-01 -0.071 0.94383 DMC 1.351e-02 6.282e-03 2.151 0.03208 * temp 3.014e-02 1.512e-02 1.993 0.04693 * wind 7.942e-02 4.035e-02 1.968 0.04972 * Region1 -6.521e-01 3.569e-01 -1.827 0.06841 . Region3 -5.564e-01 2.628e-01 -2.117 0.03484 * seasonwinter 8.244e-01 3.556e-01 2.318 0.02094 * seasonsummer -6.258e-01 2.088e-01 -2.998 0.00289 ** DMC:DC -1.271e-05 7.052e-06 -1.803 0.07218 . --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.389 on 405 degrees of freedom Multiple R-squared: 0.05992, Adjusted R-squared: 0.04135 F-statistic: 3.227 on 8 and 405 DF, p-value: 0.001433 Call: lm(formula = simplify(&quot;logarea&quot;, predictors_adjR), data = df_train_fires) Residuals: Min 1Q Median 3Q Max -2.0490 -1.0297 -0.3824 0.7927 5.1096 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 5.520e-01 5.484e-01 1.007 0.31475 X 9.262e-02 4.557e-02 2.033 0.04276 * Y -1.944e-01 9.841e-02 -1.975 0.04891 * DMC 1.367e-02 6.285e-03 2.175 0.03022 * temp 3.053e-02 1.523e-02 2.005 0.04566 * wind 8.392e-02 4.036e-02 2.079 0.03825 * Region1 -9.686e-01 4.217e-01 -2.297 0.02213 * Region3 -6.793e-01 2.770e-01 -2.453 0.01461 * Region4 -4.166e-01 3.287e-01 -1.268 0.20571 Region42 -9.109e-01 3.850e-01 -2.366 0.01846 * Region43 -6.685e-01 2.844e-01 -2.350 0.01924 * Region52 -6.063e-01 4.564e-01 -1.329 0.18476 Region59 -7.188e-01 3.268e-01 -2.200 0.02842 * Region65 -6.422e-01 3.961e-01 -1.622 0.10569 seasonwinter 9.902e-01 3.585e-01 2.762 0.00600 ** seasonsummer -6.914e-01 2.095e-01 -3.300 0.00105 ** DMC:DC -1.233e-05 7.052e-06 -1.749 0.08112 . --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.38 on 397 degrees of freedom Multiple R-squared: 0.09084, Adjusted R-squared: 0.0542 F-statistic: 2.479 on 16 and 397 DF, p-value: 0.001298 Apparently, lm_adjR2_logarea is the best performing model and therefore the winner of this first part. We arrived to this conclusion according to the F-statistic and the adjusted R-squared. Lets plot the residuals of the model. options(repr.plot.width=10, repr.plot.height=8) # managing the size par(mfcol=c(2,2)) plot(lm_adjR2_logarea) We can see that many of the problems of the first model persist. Lets make an anova analysis. anova(lm_logarea, lm_adjR2_logarea) Res.Df RSS Df Sum of Sq F Pr(&gt;F)   1 385 747.4043 NA NA NA NA 2 397 755.6820 -12 -8.277686 0.3553308 0.9774972 P-value is high and therefore we cannot affirm with certainty that there was an improvment in the model. It makes sense according to our previous plots. Second Model - Classification + Regression In our second model we will join a classification step to our model with the goal to split the dataset in fires that ~ 0 area burned and fires with more significant area burned. We follow the approach from Yanghe Huo. As we have seen in the data exploration the significant fires (more than 0) follow a normal distribution (closely). Therefore we have an expectation to be able to perform an improved analysis in this second model. Our model can be decribed as the following: Model: , where First Component: is a classification model that aims to identify observations with 0 area burned. Second Component: is a regression model that aims to estimate all area burned of all points that are different than 0. As we have observed, it is prefered to work with the logarea as it has a more well behaved distribution. Once we remove the points that are equal to 0 than we have almost a normal distribution, which is preferable when performing a regression. Again lets observe the distribution of the points &gt; 0. Logarea Burned area Distribution (&gt;0) options(repr.plot.width = 7, repr.plot.height = 5) # managing the size ggplot(df_fires[df_fires$logarea!= 0,], aes(logarea)) + geom_histogram(bins = 30) + theme_linedraw() + ggtitle(&quot;Distribution of LogArea Burned (Histogram)&quot;) Creating a binary variable for classification df_train_fires$binary_area &lt;- ifelse(df_train_fires$area == 0, 0, 1) df_test_fires$binary_area &lt;- ifelse(df_test_fires$area == 0, 0, 1) First Component: Binomial Regression # part 1 lr_area &lt;- glm(simplify(&quot;binary_area&quot;, predictors), data = df_train_fires, family = binomial()) summary(lr_area) Call: glm(formula = simplify(&quot;binary_area&quot;, predictors), family = binomial(), data = df_train_fires) Deviance Residuals: Min 1Q Median 3Q Max -1.8324 -1.1165 0.7112 1.0218 1.9726 Coefficients: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -5.251e+00 3.020e+00 -1.739 0.08206 . X 1.893e-01 1.158e-01 1.636 0.10193 Y -3.358e-01 1.892e-01 -1.775 0.07598 . FFMC 4.757e-02 3.074e-02 1.547 0.12176 DMC -1.199e-03 1.056e-02 -0.114 0.90959 ISI -5.425e-03 2.993e-02 -0.181 0.85615 temp 4.970e-02 3.709e-02 1.340 0.18028 RH 8.133e-03 1.053e-02 0.773 0.43970 wind 1.526e-01 6.831e-02 2.234 0.02546 * rain 2.433e-01 3.856e-01 0.631 0.52806 Region1 -2.061e+00 8.422e-01 -2.447 0.01441 * Region3 -8.628e-01 4.813e-01 -1.793 0.07303 . Region4 -7.284e-01 5.524e-01 -1.318 0.18736 Region11 7.205e-01 6.070e-01 1.187 0.23524 Region19 1.139e+00 8.198e-01 1.389 0.16488 Region20 9.303e-01 6.609e-01 1.408 0.15921 Region42 -1.642e+00 6.737e-01 -2.438 0.01479 * Region43 -7.425e-01 5.512e-01 -1.347 0.17802 Region52 -1.887e+00 8.804e-01 -2.144 0.03205 * Region53 -2.009e-01 5.291e-01 -0.380 0.70423 Region58 -8.546e-02 6.318e-01 -0.135 0.89240 Region59 -3.629e-01 5.438e-01 -0.667 0.50461 Region60 4.251e-01 4.608e-01 0.923 0.35626 Region65 -1.006e+00 6.928e-01 -1.452 0.14652 weekend -2.471e-01 2.228e-01 -1.109 0.26733 seasonautumn 3.495e-01 4.825e-01 0.724 0.46878 seasonwinter 1.736e+00 6.377e-01 2.723 0.00647 ** seasonsummer -3.709e-02 5.307e-01 -0.070 0.94427 DMC:DC 2.233e-06 1.209e-05 0.185 0.85344 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 571.13 on 413 degrees of freedom Residual deviance: 519.06 on 385 degrees of freedom AIC: 577.06 Number of Fisher Scoring iterations: 4 We have found some relevant variables in the task of predicting if an area had more than 0 area burned, notably specific variables linked to regions and seasons. We will now use the variables selected in part 1 to perform the logistic regression. We will not go through a process of subset selection variables because we expect the outcome to be the same due to math propoerties that are not relevant to this work. lr_adjR2_area &lt;- glm(simplify(&quot;binary_area&quot;, predictors_adjR), data = df_train_fires, family = binomial()) summary(lr_adjR2_area) Call: glm(formula = simplify(&quot;binary_area&quot;, predictors_adjR), family = binomial(), data = df_train_fires) Deviance Residuals: Min 1Q Median 3Q Max -1.7681 -1.1746 0.7446 1.0195 1.9581 Coefficients: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -1.323e-01 8.357e-01 -0.158 0.87420 X 6.577e-02 6.959e-02 0.945 0.34463 Y -2.391e-01 1.517e-01 -1.576 0.11504 DMC -1.143e-03 9.553e-03 -0.120 0.90480 temp 4.227e-02 2.347e-02 1.801 0.07169 . wind 1.306e-01 6.339e-02 2.061 0.03930 * Region1 -2.429e+00 7.469e-01 -3.252 0.00114 ** Region3 -1.188e+00 4.247e-01 -2.797 0.00515 ** Region4 -1.127e+00 5.061e-01 -2.228 0.02590 * Region42 -1.511e+00 5.871e-01 -2.574 0.01004 * Region43 -5.675e-01 4.318e-01 -1.314 0.18873 Region52 -1.528e+00 7.278e-01 -2.099 0.03582 * Region59 -3.943e-01 4.981e-01 -0.792 0.42857 Region65 -1.265e+00 5.988e-01 -2.112 0.03467 * seasonwinter 1.245e+00 5.658e-01 2.200 0.02782 * seasonsummer -2.009e-01 3.223e-01 -0.623 0.53303 DMC:DC 4.518e-06 1.072e-05 0.421 0.67352 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 571.13 on 413 degrees of freedom Residual deviance: 529.64 on 397 degrees of freedom AIC: 563.64 Number of Fisher Scoring iterations: 4 As expected, since we have reduceded the number of predictors, the Residual deviance had an slight increase. On the other hand, the AIC had a decrease. This indicates the model is now less prone to overffiting, and more likely to have a good performance in the test data. Now we will continue with a regression on the positive points of the dataset. df_posit_train_fires &lt;- df_train_fires[df_train_fires$area &gt; 0,] lm_posit_logarea &lt;- lm(simplify(&quot;logarea&quot;, predictors), data = df_posit_train_fires) summary(lm_posit_logarea) Call: lm(formula = simplify(&quot;logarea&quot;, predictors), data = df_posit_train_fires) Residuals: Min 1Q Median 3Q Max -2.3215 -0.8083 -0.1362 0.5900 4.3011 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 1.973e+00 3.588e+00 0.550 0.58306 X 1.104e-01 7.819e-02 1.411 0.15973 Y -8.190e-02 1.398e-01 -0.586 0.55873 FFMC -1.589e-02 3.888e-02 -0.409 0.68310 DMC 2.582e-02 8.727e-03 2.959 0.00347 ** ISI -2.199e-02 3.205e-02 -0.686 0.49338 temp 3.863e-02 3.109e-02 1.242 0.21558 RH 3.408e-03 9.110e-03 0.374 0.70873 wind 8.164e-02 5.605e-02 1.457 0.14684 rain -1.474e-01 2.427e-01 -0.607 0.54434 Region1 8.466e-01 8.488e-01 0.997 0.31976 Region3 -4.940e-01 4.419e-01 -1.118 0.26493 Region4 3.612e-01 5.263e-01 0.686 0.49335 Region11 -1.780e-01 4.688e-01 -0.380 0.70463 Region19 1.986e-01 5.689e-01 0.349 0.72736 Region20 -2.309e-01 4.953e-01 -0.466 0.64162 Region42 -2.128e-01 5.461e-01 -0.390 0.69724 Region43 -7.886e-01 3.890e-01 -2.027 0.04403 * Region52 9.929e-01 9.213e-01 1.078 0.28249 Region53 -5.627e-02 4.032e-01 -0.140 0.88914 Region58 -2.642e-01 4.565e-01 -0.579 0.56343 Region59 -8.935e-01 4.049e-01 -2.207 0.02850 * Region60 -4.706e-01 3.413e-01 -1.379 0.16953 Region65 2.748e-01 5.837e-01 0.471 0.63831 weekend 2.931e-01 1.824e-01 1.607 0.10970 seasonautumn 4.262e-02 4.379e-01 0.097 0.92255 seasonwinter 5.480e-01 5.195e-01 1.055 0.29276 seasonsummer -1.084e+00 4.689e-01 -2.311 0.02188 * DMC:DC -2.757e-05 9.916e-06 -2.781 0.00596 ** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.249 on 195 degrees of freedom Multiple R-squared: 0.1711, Adjusted R-squared: 0.0521 F-statistic: 1.438 on 28 and 195 DF, p-value: 0.08143 The model has a quite low performance and we will apply subset selection to try to improve it. lm_posit_subset &lt;- regsubsets(simplify(&quot;logarea&quot;, predictors), data = df_posit_train_fires, nvmax = 40) lm_posit_subset.summary &lt;- summary(lm_posit_subset) lm_posit_subset.summary Subset selection object Call: regsubsets.formula(simplify(&quot;logarea&quot;, predictors), data = df_posit_train_fires, nvmax = 40) 28 Variables (and intercept) Forced in Forced out X FALSE FALSE Y FALSE FALSE FFMC FALSE FALSE DMC FALSE FALSE ISI FALSE FALSE temp FALSE FALSE RH FALSE FALSE wind FALSE FALSE rain FALSE FALSE Region1 FALSE FALSE Region3 FALSE FALSE Region4 FALSE FALSE Region11 FALSE FALSE Region19 FALSE FALSE Region20 FALSE FALSE Region42 FALSE FALSE Region43 FALSE FALSE Region52 FALSE FALSE Region53 FALSE FALSE Region58 FALSE FALSE Region59 FALSE FALSE Region60 FALSE FALSE Region65 FALSE FALSE weekend FALSE FALSE seasonautumn FALSE FALSE seasonwinter FALSE FALSE seasonsummer FALSE FALSE DMC:DC FALSE FALSE 1 subsets of each size up to 28 Selection Algorithm: exhaustive X Y FFMC DMC ISI temp RH wind rain Region1 Region3 Region4 1 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 5 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 7 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 8 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 9 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 10 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 11 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 12 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 13 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 14 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 15 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 16 ( 1 ) &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 17 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 18 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 19 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 20 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 21 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 22 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 23 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 24 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 25 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; Region11 Region19 Region20 Region42 Region43 Region52 Region53 1 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 5 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 7 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 8 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 9 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 10 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 11 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 12 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 13 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 14 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 15 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 16 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 17 ( 1 ) &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 18 ( 1 ) &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 19 ( 1 ) &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 20 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 21 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 22 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 23 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 24 ( 1 ) &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 25 ( 1 ) &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; Region58 Region59 Region60 Region65 weekend seasonautumn seasonwinter 1 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 5 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 7 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 8 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 9 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 10 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 11 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 12 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 13 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 14 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 15 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 16 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 17 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 18 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 19 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 20 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 21 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 22 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 23 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 24 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 25 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; seasonsummer DMC:DC 1 ( 1 ) &quot;*&quot; &quot; &quot; 2 ( 1 ) &quot;*&quot; &quot; &quot; 3 ( 1 ) &quot;*&quot; &quot;*&quot; 4 ( 1 ) &quot;*&quot; &quot;*&quot; 5 ( 1 ) &quot;*&quot; &quot;*&quot; 6 ( 1 ) &quot;*&quot; &quot;*&quot; 7 ( 1 ) &quot;*&quot; &quot;*&quot; 8 ( 1 ) &quot;*&quot; &quot;*&quot; 9 ( 1 ) &quot;*&quot; &quot;*&quot; 10 ( 1 ) &quot;*&quot; &quot;*&quot; 11 ( 1 ) &quot;*&quot; &quot;*&quot; 12 ( 1 ) &quot;*&quot; &quot;*&quot; 13 ( 1 ) &quot;*&quot; &quot;*&quot; 14 ( 1 ) &quot;*&quot; &quot;*&quot; 15 ( 1 ) &quot;*&quot; &quot;*&quot; 16 ( 1 ) &quot;*&quot; &quot;*&quot; 17 ( 1 ) &quot;*&quot; &quot;*&quot; 18 ( 1 ) &quot;*&quot; &quot;*&quot; 19 ( 1 ) &quot;*&quot; &quot;*&quot; 20 ( 1 ) &quot;*&quot; &quot;*&quot; 21 ( 1 ) &quot;*&quot; &quot;*&quot; 22 ( 1 ) &quot;*&quot; &quot;*&quot; 23 ( 1 ) &quot;*&quot; &quot;*&quot; 24 ( 1 ) &quot;*&quot; &quot;*&quot; 25 ( 1 ) &quot;*&quot; &quot;*&quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; options(repr.plot.width=15, repr.plot.height=10) # managing the size par(mfrow = c(2, 2)) plot(lm_posit_subset.summary$cp, xlab = &quot;Number of variables&quot;, ylab = &quot;C_p&quot;, type = &quot;l&quot;) points(which.min(lm_posit_subset.summary$cp), lm_posit_subset.summary$cp[which.min(lm_posit_subset.summary$cp)], col = &quot;red&quot;, cex = 2, pch = 20) plot(lm_posit_subset.summary$bic, xlab = &quot;Number of variables&quot;, ylab = &quot;BIC&quot;, type = &quot;l&quot;) points(which.min(lm_posit_subset.summary$bic), lm_posit_subset.summary$bic[which.min(lm_posit_subset.summary$bic)], col = &quot;red&quot;, cex = 2, pch = 20) plot(lm_posit_subset.summary$adjr2, xlab = &quot;Number of variables&quot;, ylab = &quot;Adjusted R^2&quot;, type = &quot;l&quot;) points(which.max(lm_posit_subset.summary$adjr2), lm_posit_subset.summary$adjr2[which.max(lm_posit_subset.summary$adjr2)], col = &quot;red&quot;, cex = 2, pch = 20) plot(lm_posit_subset.summary$rss, xlab = &quot;Number of variables&quot;, ylab = &quot;RSS&quot;, type = &quot;l&quot;) mtext(&quot;Plots of C_p, BIC, adjusted R^2 and RSS best subset selection selection&quot;, side = 3, line = -2, outer = TRUE) coef(lm_posit_subset, which.min(lm_posit_subset.summary$cp)) coef(lm_posit_subset, which.min(lm_posit_subset.summary$bic)) coef(lm_posit_subset, which.max(lm_posit_subset.summary$adjr2)) (Intercept)1.48020595937141 X0.0809547752784181 DMC0.0219214865403856 Region43-0.68303590058244 Region59-0.798154315732607 Region60-0.54195856092524 weekend0.265913932174833 seasonsummer-1.00810076795683 DMC:DC-2.34940806014068e-05 (Intercept)1.70331143574566 DMC0.0241956909502708 seasonsummer-0.963236697621362 DMC:DC-2.55993473859988e-05 (Intercept)0.703865860612608 X0.0887125845951744 DMC0.0250398319780162 temp0.0200056262313652 wind0.0637379419620515 Region11.00845241123666 Region3-0.473888105030186 Region43-0.7151287573868 Region59-0.904038328051593 Region60-0.509101520453757 weekend0.266448108332819 seasonwinter0.619757365115371 seasonsummer-1.15204301839224 DMC:DC-2.65123492005568e-05 predictors_cp2 &lt;- c(&quot;X&quot;, &quot;DMC&quot;, &quot;Region43&quot;, &quot;Region59&quot;, &quot;Region60&quot;, &quot;weekend&quot;, &quot;seasonsummer&quot;, &quot;DMC:DC&quot;) predictors_adjR2 &lt;- c(&quot;X&quot;, &quot;Y&quot;, &quot;DMC&quot;, &quot;temp&quot;, &quot;wind&quot;, &quot;Region1&quot;,&quot;Region3&quot;, &quot;Region43&quot;, &quot;Region59&quot;, &quot;Region60&quot;, &quot;weekend&quot;, &quot;seasonwinter&quot;, &quot;seasonsummer&quot;, &quot;DMC:DC&quot;) lm_posit_cp_logarea &lt;- lm(simplify(&quot;logarea&quot;, predictors_cp2), data = df_posit_train_fires) lm_posit_adjR2_logarea &lt;- lm(simplify(&quot;logarea&quot;, predictors_adjR2), data = df_posit_train_fires) summary(lm_posit_cp_logarea) summary(lm_posit_adjR2_logarea) Call: lm(formula = simplify(&quot;logarea&quot;, predictors_cp2), data = df_posit_train_fires) Residuals: Min 1Q Median 3Q Max -2.1335 -0.8730 -0.1931 0.6051 4.5698 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 1.480e+00 2.986e-01 4.957 1.45e-06 *** X 8.095e-02 3.875e-02 2.089 0.03786 * DMC 2.192e-02 7.421e-03 2.954 0.00349 ** Region43 -6.830e-01 3.007e-01 -2.272 0.02409 * Region59 -7.982e-01 3.561e-01 -2.242 0.02601 * Region60 -5.420e-01 2.716e-01 -1.996 0.04723 * weekend 2.659e-01 1.694e-01 1.570 0.11800 seasonsummer -1.008e+00 2.437e-01 -4.137 5.06e-05 *** DMC:DC -2.349e-05 8.388e-06 -2.801 0.00556 ** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.225 on 215 degrees of freedom Multiple R-squared: 0.1204, Adjusted R-squared: 0.08768 F-statistic: 3.679 on 8 and 215 DF, p-value: 0.0004812 Call: lm(formula = simplify(&quot;logarea&quot;, predictors_adjR2), data = df_posit_train_fires) Residuals: Min 1Q Median 3Q Max -2.4881 -0.8463 -0.1342 0.5300 4.3711 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 9.065e-01 5.919e-01 1.532 0.12714 X 1.081e-01 4.651e-02 2.324 0.02107 * Y -7.255e-02 8.998e-02 -0.806 0.42098 DMC 2.524e-02 7.760e-03 3.252 0.00134 ** temp 2.075e-02 1.898e-02 1.093 0.27544 wind 6.185e-02 5.024e-02 1.231 0.21974 Region1 9.043e-01 7.429e-01 1.217 0.22490 Region3 -4.668e-01 3.913e-01 -1.193 0.23425 Region43 -7.845e-01 3.158e-01 -2.484 0.01376 * Region59 -9.384e-01 3.629e-01 -2.586 0.01040 * Region60 -4.830e-01 2.848e-01 -1.696 0.09135 . weekend 2.569e-01 1.712e-01 1.501 0.13497 seasonwinter 6.673e-01 4.272e-01 1.562 0.11980 seasonsummer -1.153e+00 2.545e-01 -4.532 9.83e-06 *** DMC:DC -2.652e-05 8.603e-06 -3.083 0.00232 ** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.221 on 209 degrees of freedom Multiple R-squared: 0.1512, Adjusted R-squared: 0.09432 F-statistic: 2.659 on 14 and 209 DF, p-value: 0.001364 Analysis We have decided to proceed with lm_posit_adjR2_logareaand lm_posit_cp_logarea as we beleive they are both succsseful models according to the development of our project. They have similar results, and while the fist has an improved adjusted R-squared the second has a better F-statistic. Final Model Our final models of this second part will join the classification step with the regression for exclusively positive points (area &gt; 0). It can be described as previsously: E[Y|X]=Pr(Y&gt;0|X)×E(Y|Y&gt;0,X), where: Pr(Y&gt;0|X) is given by lr_area, which is a logistic regression. E(Y|Y&gt;0,X) is given by lm_posit_adjR2_logarea or lm_posit_cp_logarea which is the linear model applied only to positive area points. 4. Model Comparsion We will now compare the models we have developed throughout the project. The metrics we will use are inspired in the paper from Paulo Cortez and Anibal Morais - Mean Absolute Deviation (MAD) and Root Mean Squared (RMSE). They can be computed according to the formulas: We will compare 3 different models, which are the following: 1.Model1: lm_adjR2_logarea: A basic model, a simple linear regression that predicts logarea and predictors X, Y, DMC, temp, wind,Region1, Region3, Region4, Region42, Region43, Region52, Region59, seasonwinter, seasonsummer. 2.Model2: lr_adjR2_area x lm_posit_adjR2_logarea: A model that joins a logistic regression with a linear regression. The first model aims to classify if a observation is likely to be zero while the second targets the total area of points thata area different than zero. E[Y|X]=Pr(Y&gt;0|X)×E(Y|Y&gt;0,X). The first regression uses the variables X, Y, DMC, temp, wind,Region1, Region3, Region4, Region42, Region43, Region52, Region59, seasonwinter, seasonsummer while the second uses X, Y, DMC, temp, Region1,Region3, Region43, Region59, Region60, Region60, weekend, seasonwinter, seasonsummer, DMC:DC. 3.Model3: lr_adjR2_area x lm_posit_cp_logarea: A model that joins a logistic regression with a linear regression. The first model aims to classify if a observation is likely to be zero while the second targets the total area of points thata area different than zero. E[Y|X]=Pr(Y&gt;0|X)×E(Y|Y&gt;0,X). The first regression uses the variables X, Y, FFMC, DMC, temp, wind, rain,Region1, Region3, Region19, Region20, Region42, Region43, Region52, Region58, Region59, seasonwinter, seasonsummer while the second uses X, DMC,Region43, Region59, Region60, weekend, seasonsummer, DMC:DC. Defining the functions RMSE &lt;- function(x, y) sqrt(mean((y - x)^2, na.rm = TRUE)) MAE &lt;- function(x, y) mean(abs(y - x), na.rm = TRUE) Performing the calculations phat &lt;- predict(lr_adjR2_area, df_test_fires, type = &quot;response&quot;) df_predictions &lt;- as.data.frame(df_test_fires[,&#39;area&#39;],colname = &#39;area&#39;) colnames(df_predictions)[1] &lt;- &quot;area&quot; df_predictions$model1 &lt;- predict(lm_adjR2_logarea, df_test_fires) df_predictions$model2 &lt;- phat * predict(lm_adjR2_logarea, df_test_fires) df_predictions$model3 &lt;- phat * predict(lm_posit_cp_logarea, df_test_fires) RMSE &lt;- c(RMSE(df_predictions$area, df_predictions$model1), RMSE(df_predictions$area, df_predictions$model2), RMSE(df_predictions$area, df_predictions$model3)) RMSE &lt;ol class=list-inline&gt;&lt;li&gt;20.9233173414873&lt;/li&gt;&lt;li&gt;21.0733370518129&lt;/li&gt;&lt;li&gt;20.943199595481&lt;/li&gt;&lt;/ol&gt; MAE &lt;- c(MAE(df_predictions$area, df_predictions$model1), MAE(df_predictions$area, df_predictions$model2), MAE(df_predictions$area, df_predictions$model3)) MAE 7.21449129803444 7.11280632073942 7.23581143455136 5. Variable Identification and Explanation Throghout this project we have the following manipulations to create new variables with our dataset. Created dummy variables for risk areas - which means, areas where more than 10 fires were registered. Created a dummy variable for seasons, as we observed the relevance of summer and other seasons in the fires. Created a dummy variable for weekends as we had expectations of a human component in the fires. Removed variables related to month and weekday. After performing such manipulations we developed different models where variable identification was a major component. We applied the subset selection tool regsubsets, and analysed all possible combinations of variables. We did not save any computation power by using the foward or backward methods that would lead possibly to inferior models. When identifying significant variables, the most important statistic we have to consider is the $p-value$. The p-value of each coefficient is made to test the null hypothesis, which is that the coefficient is equal to zero. Setting a threhold low such as $p-value$ &lt; 0.05 indicates that the null hypothesis can be rejected and therefore the variable is signicant. To sum up, a predictor with a low p-value is likely to be a meaningful addition to your model because changes in the predictor’s value are related to changes in the response variable. To base my variable identification I will use exclusevely the final models presented in the previous section. We have performed almost 10 modelling/regressions tasks over this project, but we will make use only of the final models to select variables. The folowing table describes our variable selection - all the predictors with a $p-value$ lower than 5% in one of the final models. Predictor Type Description Model X Spatial x-axis spatial coordinate within the Montesinho park map: 1 to 9 Model1, Log Model, Model2 Y Spatial y-axis spatial coordinate within the Montesinho park map: 2 to 9 Model1 Region1 Spatial Dummy variable to characterize region 1 Model1, Log Model Region20 Spatial Dummy variable to characterize region 20 Log Model, Region42 Spatial Dummy variable to characterize region 42 Model1, Log Model Region 43 Spatial Dummy variable to characterize region 43 Model1, Model2, Log Model Region52 Spatial Dummy variable to characterize region 52 Model1 Region59 Spatial Dummy variable to characterize region 59 Model1 DMC FWI DMC index from the FWI system: 1.1 to 291.3 Model2, Model3 DMC:DC FWI DC index from the FWI system: 7.9 to 860.6 Model2, Model3 seasonwinter Temporal Dummy variable for season winter Model1, Log Model seasonsummer Temporal Dummy variable for season summer Model1, Model2, Model3 Weekend Temporal Dummy variable for weekend (Friday, Saturday and Sunday) Model2, Model3 The results for the variable identification are in line with what we expected according to different steps such as data exploration and modelling. We will revise some of the tasks and exploration we have done throughout the project to justify this choices. We will also try to demonstrate with statistical exploration why the variables were selected. Spatial Component Variables: X, Y, Region1, Region20, Region42, Region43, Region52, Region59 First, lets revisite the plot developed in the data exploration part. options(repr.plot.width=7, repr.plot.height=5) # managing the size area_plot With this chart we can see clearly that some areas are more relevant than others for purposes of fire prediction. We will now create a table to see explore the differences of fires among regions. df_fires$risky_region &lt;- ifelse(df_fires$Region == 1, 1, ifelse(df_fires$Region == 20, 1, ifelse(df_fires$Region == 42, 1, ifelse(df_fires$Region == 43, 1, ifelse(df_fires$Region == 52, 1, ifelse(df_fires$Region == 52, 59, 0)))))) df_fires %&gt;% group_by(risky_region) %&gt;% summarize(Total_Area = sum(area, na.rm = TRUE), Count_Fires = n(), Mean_area = mean(area, na.rm = TRUE), Median_area = median(area, na.rm = TRUE),) risky_region Total_Area Count_Fires Mean_area Median_area 0 5558.29 391 14.215575 0.76 1 1054.37 116 9.089397 0.00 From this table we can observe: That fires in Risky Areas are proportionally in much higher number. They are 6 regions out of 72 and more than 1/4 of the fires. In addition, almost 1/5 of the burned areas were in risky regions. options(repr.plot.width=15, repr.plot.height=5) # managing the size df_fires$region_plot &lt;- df_fires$region for (i in 1:nrow(df_fires)){ df_fires[i, &#39;region_plot&#39;] &lt;- ifelse(df_fires[i, &#39;risky_region&#39;] == 1, df_fires[i, &#39;Region&#39;], &quot;Non_Risky&quot;) } region59 &lt;- df_fires[df_fires$Region == 59,] # Top Right: Set a different color for each group ggplot(df_fires, aes(x=region_plot, y=area, fill=region_plot)) + geom_boxplot(alpha=0.3) + theme(legend.position=&quot;none&quot;) Conclusion: The plot above is very conclusive, altough the oposite may be aparent. The predictors we salected from regions have: A small number of outliers compared to other variables. A big number of count of fires. In conclusion, they are well behaved, with a stable distribution and therefore are good predictors. Temporal Predictiors We will start by ploting a chart previously developed. options(repr.plot.width=15, repr.plot.height=10) # managing the size grid.arrange(p3, p4, p7, p8, nrow = 2, ncol = 2) # making the plot We consider this plots sufficient to demonstrate the importance of summer and autum in predicting the fires. We have alredy made clear that all models have selected seasonsummer and seasonautumn and weekend as predictors with a good P-value. FWI We have demostrated the correlation between DMC:DC and used it as a predictor which made it a chosen variable. Also DMC was chosen as a relevant variable. Choosing the Best Predictor Now, we will make a linear regression with the predictors normalized to finally compare than all in the same scale. df_fires$DMC_DC &lt;- df_fires$DMC * df_fires$DC # missing variable # normalize function normalize &lt;- function(x) { return ((x - min(x)) / (max(x) - min(x))) } df_fires_normal &lt;- df_fires df_fires_normal$X &lt;- normalize(df_fires$X) df_fires_normal$Y &lt;- normalize(df_fires$Y) df_fires_normal$Region1 &lt;- normalize(df_fires$Region1) df_fires_normal$Region20 &lt;- normalize(df_fires$Region20) df_fires_normal$Region42 &lt;- normalize(df_fires$Region42) df_fires_normal$Region43 &lt;- normalize(df_fires$Region43) df_fires_normal$Region52 &lt;- normalize(df_fires$Region52) df_fires_normal$Region59 &lt;- normalize(df_fires$Region59) df_fires_normal$DMC &lt;- normalize(df_fires$DMC) df_fires_normal$DMC_DC &lt;- normalize(df_fires$DMC_DC) df_fires_normal$seasonwinter &lt;- normalize(df_fires$seasonwinter) df_fires_normal$seasonsummer &lt;- normalize(df_fires$seasonsummer) df_fires_normal$weekend &lt;- normalize(df_fires$weekend) Final_predictors &lt;- c(&#39;X&#39;, &#39;Y&#39;, &#39;Region1&#39;, &#39;Region20&#39;, &#39;Region42&#39;, &#39;Region43&#39;, &#39;Region52&#39;, &#39;Region59&#39;, &#39;DMC&#39;, &#39;DMC_DC&#39;, &#39;seasonwinter&#39;, &#39;seasonsummer&#39;, &#39;weekend&#39;, &#39;logarea&#39;) summary(lm(simplify(&quot;logarea&quot;, Final_predictors), data = df_fires_normal)) Warning message in model.matrix.default(mt, mf, contrasts): &quot;the response appeared on the right-hand side and was dropped&quot; Warning message in model.matrix.default(mt, mf, contrasts): &quot;problem with term 14 in model.matrix: no columns are assigned&quot; Call: lm(formula = simplify(&quot;logarea&quot;, Final_predictors), data = df_fires_normal) Residuals: Min 1Q Median 3Q Max -1.7669 -1.0384 -0.5150 0.8502 5.5111 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 0.72073 0.23018 3.131 0.00184 ** X 0.88915 0.34406 2.584 0.01004 * Y -1.17358 0.55282 -2.123 0.03426 * Region1 -0.63040 0.36807 -1.713 0.08739 . Region20 0.42553 0.35053 1.214 0.22534 Region42 -0.63138 0.34022 -1.856 0.06408 . Region43 -0.50556 0.26307 -1.922 0.05521 . Region52 -0.45570 0.45342 -1.005 0.31538 Region59 -0.52602 0.30475 -1.726 0.08496 . DMC 3.62813 1.63565 2.218 0.02700 * DMC_DC -2.53069 1.57345 -1.608 0.10839 seasonwinter 0.75424 0.29133 2.589 0.00991 ** seasonsummer -0.50650 0.18525 -2.734 0.00648 ** weekend 0.03503 0.12526 0.280 0.77986 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.386 on 493 degrees of freedom Multiple R-squared: 0.05152, Adjusted R-squared: 0.02651 F-statistic: 2.06 on 13 and 493 DF, p-value: 0.01519 Observations: X, Y, Region1, DMC, seasonsummer and seasonwinter again showed p-value under 0.05 and therefore have influence. DMC and DMC_DC have the highest magnitude, which in this case might mean the highest influence on the area burned. 6. Conclusion In this project our primary task was to model the burned areas of fires in Portugal that occured between the years of 2000 and 2003 according to 12 predictors. We have started performing an intensive exploration of the dataset in each of its dimensions. The dataset variables related time, geographic regions, metheorology and the FWI system. After performing successive tasks and reshaping the dataset with new variables different models were proposed to model the area. After arriving to a subset of 3 final models they’re performance was compared according to RMSE and MAD metrics and finally the most relevant variables were identified. Some of the learning outcomes and relevat observations from the project. By developing heatmap plots we werre able to understand the relevance of the geographical component. Our next step was then to identify the riskiest areas and create dummy variables for each it. By creating new variables such as seasom and weekend, we could enhance our dataset with relevant and improved features. By identifyig the strong correlation between DC and DMC we were able to use them together in a model and explore the synergy. After performing all tasks this was a selected variable. Subset selection was extensevely used in our model development, which increased significantly the performance of our model with respect to ajusted R-squared and F-statistic. Removing influential points was crucial to our model performance. We used Cooks distance approach. A honest attemp to create a model by joinning to logist and linear models. Results were not extraordinary but model building rests as an outcome. Using RMSE and MAD to compare models gave a dimension of the success in the prediction task. 7. References Cortez, P., &amp; Morais, A. D. J. R. (2007). A data mining approach to predict forest fires using meteorological data. Retrieved from http://www3.dsi.uminho.pt/pcortez/fires.pdf Yanghe Huo. What Influences Forest Fires Area?. Retrieved from http://www.columbia.edu/~yh2693/ForestFire.html datasharkie. (Accessed on 2020, may 09). How to normalize data in R. Retrieved from https://datasharkie.com/how-to-normalize-data-in-r/ user3459010 (2019). *Removing outliers based on cook’s distance in R Language Retrieved from https://stats.stackexchange.com/questions/164099/removing-outliers-based-on-cooks-distance-in-r-language r-graph-gallery. (Accessed on 2020, may 09). Heatmap. Retrieved from https://www.r-graph-gallery.com/heatmap zx8754 (2019). Generate a dummy-variable https://stackoverflow.com/questions/11952706/generate-a-dummy-variable" /><link rel="canonical" href="http://localhost:4000/projects/Bushfire/" /><meta property="og:url" content="http://localhost:4000/projects/Bushfire/" /><meta property="og:site_name" content="Blackcurrant" /><meta property="og:image" content="http://localhost:4000/assets/images/fires.jpg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-11-01T00:00:00+11:00" /><script type="application/ld+json"> {"@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/projects/Bushfire/"},"datePublished":"2018-11-01T00:00:00+11:00","description":"Table of Contents Introduction Data Exploration Model Development Model Comparison Variable Identification and Explanation Conclusion References 1. Introduction In this project we aim to create models that can predict the area burned in fires. We will be working with data from the UCI machine learning repository and is a collection curated by scientists Paulo Cortez and Anibal Morais from the Unviersity of Minho, Portugal. The data includes meteorological measurements taken at the time the fire was reported, spatial/temporal measurements, and index metrics that take into a account weather data in the recent past. The index metrics are a part of the Canadian Fire Weather Index System (FWI). The data was collected from January 2000 to December 2003 from the northeast region of Portugal. Data was collected from a total of 517 fires. Many different ML models can be applied - in the basis paper the one who achieved the best performance was Support Vector Machines (SVM). However, in this project we will be testing advanced regression techniques only. Our work will follow the steps: Perform data exploration and understand the trends in the dataset. Do necessary data manipulations such as data reshaping and outlier removal to enhance the dataset. Create models to predict the burned area according to different regression techniques. Compare the models performance and choose a winner. Explain the most relevant predictors according to the models and the data exploration. Attribute information: Provided with the data 1. Spatial information X: x-axis spatial coordinate within the Montesinho park map: 1 to 9 Y: y-axis spatial coordinate within the Montesinho park map: 2 to 9 2. Temporal information month: month of the year: “jan” to “dec” day: day of the week: “mon” to “sun” 3. FWI: The forest Fire Weather Index (FWI). Which is the Canadian system for rating fire danger. FFMC: FFMC index from the FWI system: 18.7 to 96.20 DMC: DMC index from the FWI system: 1.1 to 291.3 DC: DC index from the FWI system: 7.9 to 860.6 ISI: ISI index from the FWI system: 0.0 to 56.10 4. Methorological information temp: temperature in Celsius degrees: 2.2 to 33.30 RH: relative humidity in %: 15.0 to 100 wind: wind speed in km/h: 0.40 to 9.40 rain: outside rain in mm/m2 : 0.0 to 6.4 5. area: the burned area of the forest (in ha): 0.00 to 1090.84 Programming Language: R 3.5.1 in Jupyter Notebook R Libraries used: caret data.table dplyr e1071 GGally ggplot2 grid gridExtra lattice leaps MASS PerformanceAnalytics Importing Libraries library(ggplot2) # for improved plots library(GGally) # for scatterplot matrix library(e1071) # For ML functions library(MASS) # For ML functions library(data.table) # manipultaion such as inner joins library(grid) # functions and classes that represent graphical objects or grobs library(gridExtra) # organizing plots library(lattice) # for levelplot library(dplyr) # for data manipulation library(PerformanceAnalytics) library(caret) # library(leaps) # for regsubsets function 2. Data Exploration Load the data df_fires &lt;- read.csv(file=&quot;forestfires.csv&quot;, header=TRUE, sep=&quot;,&quot;) head(df_fires) # Dysplay first six rows of the table id X Y month day FFMC DMC DC ISI temp RH wind rain area 1 7 5 mar fri 86.2 26.2 94.3 5.1 8.2 51 6.7 0.0 0 2 7 4 oct tue 90.6 35.4 669.1 6.7 18.0 33 0.9 0.0 0 3 7 4 oct sat 90.6 43.7 686.9 6.7 14.6 33 1.3 0.0 0 4 8 6 mar fri 91.7 33.3 77.5 9.0 8.3 97 4.0 0.2 0 5 8 6 mar sun 89.3 51.3 102.2 9.6 11.4 99 1.8 0.0 0 6 8 6 aug sun 92.3 85.3 488.0 14.7 22.2 29 5.4 0.0 0 Understanding the burned area distribution As previously stated we aim to predict the area of the fire according to the other variables. it is logical that we start our data exploration from the area. A first look at the table above show that the area is 0 in all of the first rows which is a concern. The authors in their paper have explained that an area smaller than $100m^2$ is replaced by 0. Lets check the distribution of the burned area using an histogram. options(repr.plot.width=7, repr.plot.height=5) # area of display ggplot(df_fires, aes(area)) + geom_histogram(bins = 50) + theme_linedraw() + ggtitle(&quot;Distribution of Area Burned (Histogram)&quot;) This is an extremely skewed variable and most likely to make a prediction we will have to handle it accordingly. We plan to do a regression in the future and this might be a problem, because for the residuals to be normal the predicted variable should not be extremely skewed distribution. A possible first strategy is to apply transformatio methods such as the logarithm and see how the data will reshape. Important: As we saw many of the data points of area are equal to 0 - so we cannot pass the pure log, but instead we will apply the formula . Log transformation on the area df_fires$logarea &lt;- log(df_fires$area+1) # plotting the new distribution ggplot(df_fires, aes(logarea)) + geom_histogram(bins = 100) + theme_linedraw() + ggtitle(&quot;Distribution of LogArea Burned (Histogram)&quot;) Our data remains skilled, however, can see small improve in the distribution of the data. We will make a final analysis, by checking what happens if we do not consider the very small fires (size 0). ggplot(df_fires[df_fires$logarea!= 0,], aes(logarea)) + geom_histogram(bins = 100) + theme_linedraw() + ggtitle(&quot;Distribution of LogArea Burned (Histogram)&quot;) Observations regarding the distribution of the data: The distribution of the burned area is very skill and this might be a problem for modelling. We have made a first log transformation that made slight improve. If we exclude the close to 0 fires we will find a closely normal distribution which might be good to work with for modelling tasks. Spatial Analysis The dataset contains spatial information representing the fires location. The X and Y variables represent the geographical locations in a map and can only be analysed together to make sense. The X axis ranges from 1 to 9 (integers) while the y axis from 2 to 9. Together, they form an area of 72 spaces. We will develop heatmaps in the folowing to identify areas that have been particular areas of focus of fires with respect to: The area affected. The number of fires. Other variables that we might want to compare # create a table # grouping other variables by area df_spatial &lt;- df_fires %&gt;% group_by(X,Y) %&gt;% summarize(Total_Area = sum(area, na.rm = TRUE), Count_Fires = n(), temp = median(temp, na.rm = TRUE), RH = median(RH, na.rm = TRUE), wind = median(wind, na.rm = TRUE), rain = median(rain, na.rm = TRUE), FFMC = median(FFMC, na.rm = TRUE), DMC = median(DMC, na.rm = TRUE), DC = median(DC, na.rm = TRUE), ISI = median(ISI, na.rm = TRUE) ) We want to develop a very specific heatmap, with many different features. To simplify the process of plotting we will create a function that will be used to make applied to make different plots. areaheatplot &lt;- function(scale, tittle) { Total.heatmap &lt;- ggplot(data = df_spatial, mapping = aes(x = X, y = Y, fill = scale)) + ggtitle(tittle) + geom_tile(position=position_nudge(x = 0.5, y= 0.5), colour = &quot;blue&quot;) + theme_linedraw() + theme(panel.grid.major = element_line(colour = &quot;blue&quot;)) + scale_fill_gradient(low=&quot;orange&quot;, high=&quot;red&quot;, na.value =&quot;white&quot;) + geom_text(aes(label = round(scale, 1)), position=position_nudge(x = 0.5, y= 0.5)) + scale_x_discrete(breaks=seq(1, 10, 1), limits = seq(1, 10, 1)) + scale_y_discrete(breaks=seq(1, 9, 1), limits = seq(1, 9, 1)) return (Total.heatmap) } Now, we will investigate different trends that data may show according to the region in which the fire happened. Firstly, we will try to observe some areas are more likely to have fires than others. area_plot &lt;- areaheatplot(df_spatial$Total_Area, &quot;Total Area&quot;) count_plot &lt;- areaheatplot(df_spatial$Count_Fires, &quot;Number of Fires&quot;) options(repr.plot.width=14, repr.plot.height=4) # managing the size grid.arrange(area_plot, count_plot, nrow = 1, ncol = 2) # making the plot Observations: Clearly there are more area that are more prone to fires than others. The interesection between X (6-9) and Y (4-7) accounts for more than half of fires. Most regions did not have fires at all. Now, we will try to explore the metheorological conditions by region to see if areas that have more fires have any peculiar trends. We will build 8 plots, regions against: Temperature, RH, Wind, Rain, FFMC, DMC, DC, ISI. temp_plot &lt;- areaheatplot(df_spatial$temp, &quot;Temperature&quot;) RH_plot &lt;- areaheatplot(df_spatial$RH, &quot;RH&quot;) wind_plot &lt;- areaheatplot(df_spatial$wind, &quot;Wind&quot;) rain_plot &lt;- areaheatplot(df_spatial$rain, &quot;Rain&quot;) FFMC_plot &lt;- areaheatplot(df_spatial$FFMC, &quot;FFMC&quot;) DMC_plot &lt;- areaheatplot(df_spatial$DMC, &quot;DMC&quot;) DC_plot &lt;- areaheatplot(df_spatial$DC, &quot;DC&quot;) ISI_plot &lt;- areaheatplot(df_spatial$ISI, &quot;ISI&quot;) options(repr.plot.width=14, repr.plot.height=15) # managing the size grid.arrange(temp_plot, RH_plot, wind_plot, rain_plot, FFMC_plot, DMC_plot, DC_plot, ISI_plot, nrow = 4, ncol = 2) # making the plot Observations: The latest charts are very useful to explore visually the relationship of variables with areas. Due to complexity, it is difficult to arrive to conclusions for modelling purposes. Apparently areas with more fires also have higher proportion of the other variables such as higher temperatures and Relative Humidity. Creating New Dummy Variables for Risky Areas - One Hot Encoding of Regions A region is a area formed by a X and a Y point. In total, there are 72 regions - with X ranging from 1-9 and Y raging from 2-9. Therefore we will create a new variable called region, because it will be better to analyse the data considering that hardly X and Y independently would make sense to analyse. As we have seen there are areas that are more prone to fires than others. This was explored even with relationship to other variables. We want our model to be able to capture this “risk” so we will make some modifications in our dataset. We will create dummy variables for all regions that concentrate more than 2% (at least 10) of the number of fires. We have chosen this threshold because we do not want our future models to overfit by using this new variables. # adding region variable df_area &lt;- data.frame(Region = 1:72, X = 1:9, Y = 2:9) df_fires &lt;- left_join(df_fires, df_area, by = c(&quot;X&quot;, &quot;Y&quot;)) # group by region the number of fires df_spatial &lt;- df_fires %&gt;% group_by(Region) %&gt;% summarize(Total_Area = sum(area, na.rm = TRUE), Count_Fires = n()) # filter areas with more than 10 fires attach(df_spatial) df_spatial &lt;- df_spatial[which(Count_Fires &gt; 10),] detach(df_spatial) danger_areas &lt;- df_spatial$Region cat(&quot;Danger Areas: Regions that have more than 10 registered fires \\n&quot;, df_spatial$Region) Danger Areas: Regions that have more than 10 registered fires 1 3 4 11 19 20 42 43 52 53 58 59 60 65 67 # creating dummy variables for(i in (danger_areas)){ df_fires[,paste0(&quot;Region&quot;, i)] &lt;- ifelse(test = df_fires$Region == i, yes = 1, no = 0) } We have created 15 dummy variables that may be characterized as risk regions. Temporal Analysis We will further investigate the temporal dimension of the dataset. We want to know if fires are more likely to happen in a especific day or month. We noted, however, that it might be better to explore the data according to seasonality and weekends, because we beleive they should be better predictors. We will now: Create new variables, a dummy for weekends and a seasonality variable. Explore the trends of the variables weekends, seasonality, month and day. # create variable season df_fires$season &lt;- ifelse(df_fires$month == &quot;aug&quot; | df_fires$month == &quot;jun&quot; | df_fires$month == &quot;jul&quot;,&#39;summer&#39;, ifelse(df_fires$month == &quot;oct&quot; | df_fires$month == &quot;nov&quot; | df_fires$month == &quot;sep&quot;,&quot;autumn&quot;, ifelse(df_fires$month == &quot;feb&quot; | df_fires$month == &quot;jan&quot; | df_fires$month ==&quot;dec&quot;, &quot;winter&quot;, ifelse(df_fires$month == &quot;mar&quot; | df_fires$month == &quot;apr&quot; | df_fires$month ==&#39;may&#39;, &quot;spring&quot;, &#39;NA&#39;)))) # create variable weekend # note that we consider fruday a weekend day df_fires$weekend &lt;- ifelse(df_fires$day == &quot;mon&quot; | df_fires$day == &quot;tue&quot; | df_fires$day == &quot;wed&quot;| df_fires$day == &quot;thu&quot;, 0,1) # creating a table with the count of fires df_season &lt;- df_fires %&gt;% group_by(season, month, day, weekend) %&gt;% summarize(Total_Area = sum(logarea, na.rm = TRUE), Count_Fires = n()) day_order &lt;- c(&quot;mon&quot;, &quot;tue&quot;, &quot;wed&quot;, &quot;thu&quot;, &quot;fri&quot;, &quot;sat&quot;, &quot;sun&quot; ) season_order &lt;- c(&quot;summer&quot;, &quot;autumn&quot;, &quot;winter&quot;, &quot;spring&quot;) # Natural order of seasons month_order &lt;- c(&quot;jan&quot;, &quot;feb&quot;, &quot;mar&quot;, &quot;apr&quot;, &quot;may&quot;, &quot;jun&quot;, &quot;jul&quot;, &quot;aug&quot;, &quot;sep&quot;, &quot;oct&quot;, &quot;nov&quot;, &quot;dec&quot;) p1 &lt;- ggplot(df_fires, aes(x= factor(month, level = month_order), y =logarea)) + geom_boxplot(fill=&quot;slateblue&quot;, alpha=0.5) + theme_classic() + ggtitle(&quot;Distribution Fires by Month&quot;) p2 &lt;- ggplot(df_season, aes(x= factor(month, level = month_order), y =Total_Area)) + geom_bar(fill=&quot;grey&quot;, stat=&quot;identity&quot;) + theme_classic() + ggtitle(&quot;Distribution Fires by Month&quot;) p3 &lt;- ggplot(df_fires, aes(x= factor(season, level = season_order), y =logarea)) + geom_boxplot(fill=&quot;slateblue&quot;, alpha=0.5) + theme_classic() + ggtitle(&quot;Distribution Fires by Season&quot;) p4 &lt;- ggplot(df_season, aes(x= factor(season, level = season_order), y =Total_Area)) + geom_bar(fill=&quot;grey&quot;, stat=&quot;identity&quot;) + theme_classic() + ggtitle(&quot;Distribution Fires by Season&quot;) p5 &lt;- ggplot(df_fires, aes(x= factor(day, level = day_order), y =logarea)) + geom_boxplot(fill=&quot;slateblue&quot;, alpha=0.5) + theme_classic() + ggtitle(&quot;Distribution Fires by Day&quot;) p6 &lt;- ggplot(df_season, aes(x= factor(day, level = day_order), y =Total_Area)) + geom_bar(fill=&quot;grey&quot;, stat=&quot;identity&quot;) + theme_classic() + ggtitle(&quot;Distribution Fires by Day&quot;) p7 &lt;- ggplot(df_fires, aes(x= factor(weekend), y =logarea)) + geom_boxplot(fill=&quot;slateblue&quot;, alpha=0.5) + theme_classic() + ggtitle(&quot;Distribution Fires by Weekend&quot;) p8 &lt;- ggplot(df_season, aes(x= factor(weekend), y =Total_Area)) + geom_bar(fill=&quot;grey&quot;, stat=&quot;identity&quot;) + theme_classic() + ggtitle(&quot;Distribution Fires by Weekend&quot;) options(repr.plot.width=15, repr.plot.height=15) # managing the size grid.arrange(p1, p2, p3, p4, p5, p6, p7, p8, nrow = 4, ncol = 2) # making the plot Some observations about the temporal data. As expected summer has the highest number of fires, as we have seen that temperature is correlated to number of fires. Winter has a very small of fires compared to other seasons, but curiously the highest median. More than 70% of fires are either in summer or autumn. We expect this predictor to have a significant prediction power and we will create dummy variables for each season. We are considering weekends with 3 days and weekdays of 4 days. Nevertheless there are more fires in weekends. This might demonstrate a relationship of fires with human activity. This is especially true if we consider that there are many significant fire outliers on weekends. One Hot Encoding of Seasons To work with seasons it will be preferable to create dummy variables. This is what we will do next. seasons &lt;- unique(df_fires$season) for(i in (seasons)){ df_fires[,paste0(&quot;season&quot;, i)] &lt;- ifelse(test = df_fires$season == i, yes = 1, no = 0) } df_fires &lt;- subset(df_fires, select = -c(seasonspring)) # eliminating a season for the one_hot_encoding A first look at correlations Lets investigate how the variables relate to each other. To explore correlations we will leave the previously explored variables - related to temporal and and spatial analysis. options(repr.plot.width=15, repr.plot.height=10) # managing the size ggpairs(df_fires[,c(seq(5,13))]) This chart is particularly useful as other than the correlation we can see the distribution of the variables. With respect to correlation: There is no significant and strong correlation with two variables. Only one exception should be noticed, DC and DMC. They might be useful working together in our models. Temp apparently have a meaningful but small positive correlation with ISI, DC, DMC and FFMC. Even though many of the variables have been extracted from other variables, as an example, DC from rain and temperature, our variables seem to have a good level of independence that allow us to work with them together with no major concerns with colinearity and similar problems. 3. Model Development We will develop 2-3 models in this part of the project, with goal of predicting the burned area. Before performaing any modelling task, however, we will split the data in trainning and testing. Naturally, will we use a cross-validation approach. We will split the dataset in train and test, having 80% of trainning data. split Dataset in train and test set.seed(210) n &lt;- nrow(df_fires) shuffled &lt;- df_fires[sample(n),] df_train_fires &lt;- shuffled[1:round(0.80 * n),] df_test_fires &lt;- shuffled[(round(0.80 * n) + 1):n,] rownames(df_train_fires) &lt;- 1:nrow(df_train_fires) Influential Outliers Detection We have observed that the dataset has a right skewed distribution, and with significant outliers that may compromise our models. In this project we want to apply exclusevely linear models along with logistic regressions and therefore we would benefit from a clean dataset. Therefore we will remove significant outliers from our dataset. There are two recommended approaches in this situation: Remove outliers according to boxplot distribution. Remove Influential points according to Cooks distance. We have decided to take the second approach as we believe it is more aligned with the scope of our project and regression models. We will do it by the following steps. Filter from the dataset all non-zero area points. We want to do it because we will build some models that will target the non-zero distribution of the area. Build a simple linear regression with all predictors. Find influential points. Remove influential points from the dataset. Obs: The method used in this extraction was influenced by the following work. attach(df_train_fires) posit_data &lt;- df_train_fires[which(area &gt; 0),] options(repr.plot.width=15, repr.plot.height=10) # managing the size mod &lt;- lm(logarea ~ ., data=posit_data[c(seq(1,12),seq(14,31))]) # regression model cooksd &lt;- cooks.distance(mod) options(repr.plot.width=12, repr.plot.height=6) # managing the size plot(cooksd, pch=&quot;*&quot;, cex=2, main=&quot;Influential Obs by Cooks distance&quot;) # plot cook&#39;s distance abline(h = 4*mean(cooksd, na.rm=T), col=&quot;red&quot;) # add cutoff line text(x=1:length(cooksd), y=cooksd+0.002, labels=ifelse(cooksd&gt;4*mean(cooksd, na.rm=T),names(cooksd),&quot;&quot;), col=&quot;red&quot;) # add labels influential = which(cooksd&gt;4*mean(cooksd, na.rm=T)) # finding influential points df_train_fires[as.numeric(names(influential)), 1:13] id X Y month day FFMC DMC DC ISI temp RH wind rain area 11 8 8 aug wed 91.7 191.4 635.9 7.8 26.2 36 4.5 0 185.76 88 7 4 jul mon 89.2 103.9 431.6 6.4 22.6 57 4.9 0 278.53 112 8 6 aug thu 94.8 222.4 698.6 13.9 27.5 27 4.9 0 746.28 152 1 2 jul sat 90.0 51.3 296.3 8.7 16.6 53 5.4 0 0.71 173 7 4 aug sat 93.5 139.4 594.2 20.3 5.1 96 5.8 0 26.00 194 1 2 sep tue 91.0 129.5 692.6 7.0 18.8 40 2.2 0 212.88 204 6 5 sep sat 92.5 121.1 674.4 8.6 25.1 27 4.0 0 1090.84 304 4 3 aug wed 94.5 139.4 689.1 20.0 28.9 29 4.9 0 49.59 324 9 9 jul tue 85.8 48.3 313.4 3.9 18.0 42 2.7 0 0.36 411 2 4 aug sun 81.6 56.7 665.6 1.9 21.9 71 5.8 0 54.29 df_fires = df_fires[-as.numeric(names(influential)), ] # removing from the dataset Model 1 - Linear Regression Our first model will be a simple linear regression. We have observed that the area is not normally distributed and therefore it is preferable to predict the log of area. Nevertheless, we will also test a model to predict the area. As we know, the formula of the regression is: First Model: Second Model: When fitting a regression we want to obtain the best performance of our metrics. The most relevant are: R-Squared: Represents the proportion of the variance for a dependent variable that’s explained by independent variables. The higher the better. Adjusted R-squared: Simillar to R-squared, but also compares the explanatory power of regression models that contain different numbers of predictors. The higher the better. F-Test: Indicates if the model provides a better fit to the data than a model that contains no independent variables. The higher the better. RMSE: Represents the standard deviation of the differences between predicted values and observed values (residuals). The lower the better. names(df_train_fires) &#39;X&#39;&#39;Y&#39;&#39;month&#39;&#39;day&#39;&#39;FFMC&#39;&#39;DMC&#39;&#39;DC&#39;&#39;ISI&#39;&#39;temp&#39;&#39;RH&#39;&#39;wind&#39;&#39;rain&#39;&#39;area&#39;&#39;logarea&#39;&#39;Region&#39;&#39;Region1&#39;&#39;Region3&#39;&#39;Region4&#39;&#39;Region11&#39;&#39;Region19&#39;&#39;Region20&#39;&#39;Region42&#39;&#39;Region43&#39;&#39;Region52&#39;&#39;Region53&#39;&#39;Region58&#39;&#39;Region59&#39;&#39;Region60&#39;&#39;Region65&#39;&#39;Region67&#39;&#39;season&#39;&#39;weekend&#39;&#39;seasonautumn&#39;&#39;seasonsummer&#39;&#39;seasonwinter&#39; We will create a list of the variables called predictors that will help us in the progress of our model development. Also a support function that will be used to have less wording in the model development. A important note: We will explore the sinergy of DC and DMC - as we saw in the previous section and they are strongly correlated. # create a list of variables to use in modelling predictors &lt;- c(&quot;X&quot;, &quot;Y&quot;, &quot;FFMC&quot;, &quot;DMC&quot;, &quot;DMC:DC&quot;, &quot;ISI&quot;, &quot;temp&quot;, &quot;RH&quot;, &quot;wind&quot;, &quot;rain&quot;, &quot;Region1&quot;, &quot;Region3&quot;, &quot;Region4&quot;, &quot;Region11&quot;, &quot;Region19&quot;, &quot;Region20&quot;, &quot;Region42&quot;, &quot;Region43&quot;, &quot;Region52&quot;, &quot;Region53&quot;, &quot;Region58&quot;, &quot;Region59&quot;,&quot;Region60&quot;, &quot;Region65&quot;, &quot;weekend&quot;, &quot;seasonautumn&quot;, &quot;seasonwinter&quot;, &quot;seasonsummer&quot;) simplify &lt;- function(y, predictors){ return(as.formula(paste(y, &quot;~&quot;, paste(predictors, collapse = &quot;+&quot;)))) } # Fitting the models lm_area &lt;- lm(simplify(&quot;area&quot;, predictors), data = df_train_fires) lm_logarea &lt;- lm(simplify(&quot;logarea&quot;, predictors), data = df_train_fires) # summary of the model (estimates and metrics) summary(lm_area) summary(lm_logarea) Call: lm(formula = simplify(&quot;area&quot;, predictors), data = df_train_fires) Residuals: Min 1Q Median 3Q Max -60.70 -20.82 -6.98 5.01 1024.21 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) -5.768e+01 8.366e+01 -0.690 0.4909 X 3.379e+00 3.696e+00 0.914 0.3612 Y -4.351e-01 6.178e+00 -0.070 0.9439 FFMC -7.792e-02 8.029e-01 -0.097 0.9227 DMC 7.302e-01 3.462e-01 2.110 0.0355 * ISI -7.071e-01 9.687e-01 -0.730 0.4659 temp 1.939e+00 1.217e+00 1.594 0.1118 RH -9.880e-02 3.435e-01 -0.288 0.7738 wind 2.720e+00 2.184e+00 1.245 0.2139 rain -2.418e+00 1.158e+01 -0.209 0.8347 Region1 1.338e+01 2.543e+01 0.526 0.5992 Region3 -1.343e+00 1.610e+01 -0.083 0.9335 Region4 1.998e+00 1.835e+01 0.109 0.9134 Region11 4.730e-01 1.989e+01 0.024 0.9810 Region19 1.194e+01 2.603e+01 0.459 0.6466 Region20 -2.145e+00 2.206e+01 -0.097 0.9226 Region42 -1.216e+01 2.202e+01 -0.552 0.5812 Region43 -7.094e+00 1.783e+01 -0.398 0.6909 Region52 -9.631e+00 2.664e+01 -0.362 0.7179 Region53 6.323e+00 1.772e+01 0.357 0.7215 Region58 -1.579e+00 2.074e+01 -0.076 0.9394 Region59 -1.200e+01 1.811e+01 -0.663 0.5078 Region60 2.201e+01 1.478e+01 1.489 0.1373 Region65 1.033e+01 2.341e+01 0.441 0.6594 weekend 1.116e+00 7.387e+00 0.151 0.8800 seasonautumn 1.368e+01 1.581e+01 0.865 0.3876 seasonwinter 3.079e+01 2.022e+01 1.523 0.1286 seasonsummer -1.542e+01 1.756e+01 -0.878 0.3806 DMC:DC -7.666e-04 3.965e-04 -1.934 0.0539 . --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 70.83 on 385 degrees of freedom Multiple R-squared: 0.05539, Adjusted R-squared: -0.01331 F-statistic: 0.8063 on 28 and 385 DF, p-value: 0.7493 Call: lm(formula = simplify(&quot;logarea&quot;, predictors), data = df_train_fires) Residuals: Min 1Q Median 3Q Max -2.1635 -0.9899 -0.4054 0.7261 5.1428 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) -8.455e-01 1.646e+00 -0.514 0.60766 X 1.569e-01 7.271e-02 2.158 0.03154 * Y -2.417e-01 1.215e-01 -1.989 0.04740 * FFMC 1.281e-02 1.579e-02 0.811 0.41774 DMC 1.453e-02 6.809e-03 2.134 0.03345 * ISI -1.574e-02 1.905e-02 -0.826 0.40937 temp 3.150e-02 2.393e-02 1.316 0.18881 RH 2.656e-03 6.756e-03 0.393 0.69447 wind 9.700e-02 4.297e-02 2.258 0.02453 * rain 1.291e-01 2.277e-01 0.567 0.57099 Region1 -8.881e-01 5.002e-01 -1.775 0.07663 . Region3 -6.338e-01 3.166e-01 -2.002 0.04599 * Region4 -3.222e-01 3.610e-01 -0.893 0.37260 Region11 1.459e-01 3.913e-01 0.373 0.70946 Region19 5.081e-01 5.120e-01 0.992 0.32163 Region20 2.239e-01 4.340e-01 0.516 0.60619 Region42 -1.117e+00 4.331e-01 -2.579 0.01027 * Region43 -8.885e-01 3.507e-01 -2.533 0.01169 * Region52 -8.646e-01 5.240e-01 -1.650 0.09978 . Region53 -1.898e-01 3.486e-01 -0.545 0.58641 Region58 -2.241e-01 4.079e-01 -0.549 0.58309 Region59 -8.085e-01 3.561e-01 -2.270 0.02375 * Region60 -1.806e-01 2.908e-01 -0.621 0.53501 Region65 -6.117e-01 4.605e-01 -1.328 0.18482 weekend 1.277e-02 1.453e-01 0.088 0.93000 seasonautumn 2.510e-01 3.111e-01 0.807 0.42024 seasonwinter 1.121e+00 3.977e-01 2.818 0.00507 ** seasonsummer -5.150e-01 3.454e-01 -1.491 0.13682 DMC:DC -1.442e-05 7.799e-06 -1.849 0.06523 . --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.393 on 385 degrees of freedom Multiple R-squared: 0.1008, Adjusted R-squared: 0.0354 F-statistic: 1.541 on 28 and 385 DF, p-value: 0.04093 As expected lm_logarea performed better than lm_area, because logarea is more appropriate as a label. Therefore we will be working exclusevely with lm_logarea from now on. It calls our attention that the model has a small predictive power with respect to the metrics of performance, such as F-statistic and R-squared. In fact we found an negative adjusted R-Squared in lm_area which means the model contains terms that do not help to predict the response. Let’s proceed with diagnostic plots. options(repr.plot.width=10, repr.plot.height=8) # managing the size par(mfcol=c(2,2)) plot(lm_logarea) The diagnostic plots show residuals in four different ways. Some observations about the plots: Residual vs fitted plot and scale-location plot: They access if the residuals have non-linear patterns and if residuals are spread equally along the ranges of predictors. We can see an abnormal pattern such as some points in a linear trend. Other points are well behaved. Q-Q plot: Unfortunately we can observe that the distribution of the residuals is not normal and this might explain the performance of our model. Residual-leverage plot: Since we have previously performed data manipulation removing outliers and highly influential points, they are not a concern in this step. There is a limitrofe point just on the 0.5 line but we will keep it for now. Subset Selection In this task, we will use the regsubsets() function to perform best subset selection in order to choose the best model containing the predictors. We want the best model obtained according to $C_p$, $BIC$, and adjusted $R^2$. Show some plots to provide evidence for your answer, and report the coefficients of the best model obtained. lm_subset &lt;- regsubsets(simplify(&quot;logarea&quot;, predictors), data = df_train_fires, nvmax = 40) lm_subset.summary &lt;- summary(lm_subset) lm_subset.summary Subset selection object Call: regsubsets.formula(simplify(&quot;logarea&quot;, predictors), data = df_train_fires, nvmax = 40) 28 Variables (and intercept) Forced in Forced out X FALSE FALSE Y FALSE FALSE FFMC FALSE FALSE DMC FALSE FALSE ISI FALSE FALSE temp FALSE FALSE RH FALSE FALSE wind FALSE FALSE rain FALSE FALSE Region1 FALSE FALSE Region3 FALSE FALSE Region4 FALSE FALSE Region11 FALSE FALSE Region19 FALSE FALSE Region20 FALSE FALSE Region42 FALSE FALSE Region43 FALSE FALSE Region52 FALSE FALSE Region53 FALSE FALSE Region58 FALSE FALSE Region59 FALSE FALSE Region60 FALSE FALSE Region65 FALSE FALSE weekend FALSE FALSE seasonautumn FALSE FALSE seasonwinter FALSE FALSE seasonsummer FALSE FALSE DMC:DC FALSE FALSE 1 subsets of each size up to 28 Selection Algorithm: exhaustive X Y FFMC DMC ISI temp RH wind rain Region1 Region3 Region4 1 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 5 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 7 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 8 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 9 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 10 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 11 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 12 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 13 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 14 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 15 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 16 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 17 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 18 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 19 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 20 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 21 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 22 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 23 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 24 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 25 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; Region11 Region19 Region20 Region42 Region43 Region52 Region53 1 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 5 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 7 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 8 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 9 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 10 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 11 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; 12 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; 13 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; 14 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; 15 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 16 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 17 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 18 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 19 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 20 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 21 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 22 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 23 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 24 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 25 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 26 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; Region58 Region59 Region60 Region65 weekend seasonautumn seasonwinter 1 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; 5 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 7 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 8 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; 9 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; 10 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; 11 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; 12 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; 13 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 14 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; 15 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; 16 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; 17 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 18 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 19 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 20 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 21 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 22 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 23 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 24 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 25 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; seasonsummer DMC:DC 1 ( 1 ) &quot; &quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot; &quot; 5 ( 1 ) &quot;*&quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot; &quot; 7 ( 1 ) &quot; &quot; &quot;*&quot; 8 ( 1 ) &quot;*&quot; &quot;*&quot; 9 ( 1 ) &quot;*&quot; &quot;*&quot; 10 ( 1 ) &quot;*&quot; &quot;*&quot; 11 ( 1 ) &quot;*&quot; &quot;*&quot; 12 ( 1 ) &quot;*&quot; &quot;*&quot; 13 ( 1 ) &quot; &quot; &quot;*&quot; 14 ( 1 ) &quot;*&quot; &quot;*&quot; 15 ( 1 ) &quot;*&quot; &quot;*&quot; 16 ( 1 ) &quot;*&quot; &quot;*&quot; 17 ( 1 ) &quot;*&quot; &quot;*&quot; 18 ( 1 ) &quot;*&quot; &quot;*&quot; 19 ( 1 ) &quot;*&quot; &quot;*&quot; 20 ( 1 ) &quot;*&quot; &quot;*&quot; 21 ( 1 ) &quot;*&quot; &quot;*&quot; 22 ( 1 ) &quot;*&quot; &quot;*&quot; 23 ( 1 ) &quot;*&quot; &quot;*&quot; 24 ( 1 ) &quot;*&quot; &quot;*&quot; 25 ( 1 ) &quot;*&quot; &quot;*&quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; Due to the fact we have created many dummy variables for geographic region, our model may have up to 40 variables. We have found the best subset for n variables, when n ranges from 1 to 30. Now we will plot the number of variables from the best models against the accuracy indicators such as Cp, BIC, Ajusted R-squared and RSS. options(repr.plot.width=15, repr.plot.height=10) # managing the size par(mfrow = c(2, 2)) plot(lm_subset.summary$cp, xlab = &quot;Number of variables&quot;, ylab = &quot;C_p&quot;, type = &quot;l&quot;) points(which.min(lm_subset.summary$cp), lm_subset.summary$cp[which.min(lm_subset.summary$cp)], col = &quot;red&quot;, cex = 2, pch = 20) plot(lm_subset.summary$bic, xlab = &quot;Number of variables&quot;, ylab = &quot;BIC&quot;, type = &quot;l&quot;) points(which.min(lm_subset.summary$bic), lm_subset.summary$bic[which.min(lm_subset.summary$bic)], col = &quot;red&quot;, cex = 2, pch = 20) plot(lm_subset.summary$adjr2, xlab = &quot;Number of variables&quot;, ylab = &quot;Adjusted R^2&quot;, type = &quot;l&quot;) points(which.max(lm_subset.summary$adjr2), lm_subset.summary$adjr2[which.max(lm_subset.summary$adjr2)], col = &quot;red&quot;, cex = 2, pch = 20) plot(lm_subset.summary$rss, xlab = &quot;Number of variables&quot;, ylab = &quot;RSS&quot;, type = &quot;l&quot;) mtext(&quot;Plots of C_p, BIC, adjusted R^2 and RSS best subset selection selection&quot;, side = 3, line = -2, outer = TRUE) It is interesting the fact that we have found different models according to each indicator. Lets compare then. coef(lm_subset, which.min(lm_subset.summary$cp)) coef(lm_subset, which.min(lm_subset.summary$bic)) coef(lm_subset, which.max(lm_subset.summary$adjr2)) (Intercept):-0.0266117016454773 DMC: 0.0135111201577867 temp: 0.0301357865043537 wind:0.0794234546908572 Region:1-0.652129755329549 Region3:-0.556361498494578 seasonwinter:0.824436990829506 seasonsummer:-0.625817307938421 DMC:DC:-1.27126321593314e-05 (Intercept):1.19083283788439 Region: 3-0.549921309305286 (Intercept):0.55198302136147 X:0.0926165837619685 Y:-0.194404903439422 DMC0:.013670228896515 temp0:.0305312643068406 wind0:.0839199384373189 Region1:-0.968641287013757 Region3:-0.679272609210134 Region4:-0.416576766202436 Region42:-0.910932398029436 Region43:-0.668493899182849 Region52:-0.606346184501872 Region59:-0.718813149812681 Region65:-0.642247961402224 seasonwinter:0.990242150570015 seasonsummer:-0.691447562888277 DMC:DC:-1.2331282867293e-05 Observations from the subset selection: While $C_P$ indicates a total of 9 predictors, $BIC$ indicates only one. Adjusted-R-squared indicates 18 variables. We will reject the BIC analysis as we do not believe the model will have a good fit in the test data and work exclusevely with the second and third models. # create variables predictors_cp &lt;- c(&#39;DMC&#39;,&#39;temp&#39;,&#39;wind&#39;, &#39;Region1&#39;, &#39;Region3&#39;,&#39;seasonwinter&#39;, &#39;seasonsummer&#39;, &#39;DMC:DC&#39;) predictors_adjR &lt;- c(&#39;X&#39;, &#39;Y&#39;, &#39;DMC&#39;, &#39;temp&#39;, &#39;wind&#39;, &#39;Region1&#39;, &#39;Region3&#39;, &#39;Region4&#39;, &#39;Region42&#39;, &#39;Region43&#39;, &#39;Region52&#39;, &#39;Region59&#39;, &#39;Region65&#39;,&#39;seasonwinter&#39;, &#39;seasonsummer&#39;, &#39;DMC:DC&#39;) lm_cp_logarea &lt;- lm(simplify(&quot;logarea&quot;, predictors_cp), data = df_train_fires) lm_adjR2_logarea &lt;- lm(simplify(&quot;logarea&quot;, predictors_adjR), data = df_train_fires) summary(lm_cp_logarea) summary(lm_adjR2_logarea) Call: lm(formula = simplify(&quot;logarea&quot;, predictors_cp), data = df_train_fires) Residuals: Min 1Q Median 3Q Max -1.9576 -1.0736 -0.4319 0.8178 5.3502 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) -2.661e-02 3.775e-01 -0.071 0.94383 DMC 1.351e-02 6.282e-03 2.151 0.03208 * temp 3.014e-02 1.512e-02 1.993 0.04693 * wind 7.942e-02 4.035e-02 1.968 0.04972 * Region1 -6.521e-01 3.569e-01 -1.827 0.06841 . Region3 -5.564e-01 2.628e-01 -2.117 0.03484 * seasonwinter 8.244e-01 3.556e-01 2.318 0.02094 * seasonsummer -6.258e-01 2.088e-01 -2.998 0.00289 ** DMC:DC -1.271e-05 7.052e-06 -1.803 0.07218 . --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.389 on 405 degrees of freedom Multiple R-squared: 0.05992, Adjusted R-squared: 0.04135 F-statistic: 3.227 on 8 and 405 DF, p-value: 0.001433 Call: lm(formula = simplify(&quot;logarea&quot;, predictors_adjR), data = df_train_fires) Residuals: Min 1Q Median 3Q Max -2.0490 -1.0297 -0.3824 0.7927 5.1096 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 5.520e-01 5.484e-01 1.007 0.31475 X 9.262e-02 4.557e-02 2.033 0.04276 * Y -1.944e-01 9.841e-02 -1.975 0.04891 * DMC 1.367e-02 6.285e-03 2.175 0.03022 * temp 3.053e-02 1.523e-02 2.005 0.04566 * wind 8.392e-02 4.036e-02 2.079 0.03825 * Region1 -9.686e-01 4.217e-01 -2.297 0.02213 * Region3 -6.793e-01 2.770e-01 -2.453 0.01461 * Region4 -4.166e-01 3.287e-01 -1.268 0.20571 Region42 -9.109e-01 3.850e-01 -2.366 0.01846 * Region43 -6.685e-01 2.844e-01 -2.350 0.01924 * Region52 -6.063e-01 4.564e-01 -1.329 0.18476 Region59 -7.188e-01 3.268e-01 -2.200 0.02842 * Region65 -6.422e-01 3.961e-01 -1.622 0.10569 seasonwinter 9.902e-01 3.585e-01 2.762 0.00600 ** seasonsummer -6.914e-01 2.095e-01 -3.300 0.00105 ** DMC:DC -1.233e-05 7.052e-06 -1.749 0.08112 . --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.38 on 397 degrees of freedom Multiple R-squared: 0.09084, Adjusted R-squared: 0.0542 F-statistic: 2.479 on 16 and 397 DF, p-value: 0.001298 Apparently, lm_adjR2_logarea is the best performing model and therefore the winner of this first part. We arrived to this conclusion according to the F-statistic and the adjusted R-squared. Lets plot the residuals of the model. options(repr.plot.width=10, repr.plot.height=8) # managing the size par(mfcol=c(2,2)) plot(lm_adjR2_logarea) We can see that many of the problems of the first model persist. Lets make an anova analysis. anova(lm_logarea, lm_adjR2_logarea) Res.Df RSS Df Sum of Sq F Pr(&gt;F)   1 385 747.4043 NA NA NA NA 2 397 755.6820 -12 -8.277686 0.3553308 0.9774972 P-value is high and therefore we cannot affirm with certainty that there was an improvment in the model. It makes sense according to our previous plots. Second Model - Classification + Regression In our second model we will join a classification step to our model with the goal to split the dataset in fires that ~ 0 area burned and fires with more significant area burned. We follow the approach from Yanghe Huo. As we have seen in the data exploration the significant fires (more than 0) follow a normal distribution (closely). Therefore we have an expectation to be able to perform an improved analysis in this second model. Our model can be decribed as the following: Model: , where First Component: is a classification model that aims to identify observations with 0 area burned. Second Component: is a regression model that aims to estimate all area burned of all points that are different than 0. As we have observed, it is prefered to work with the logarea as it has a more well behaved distribution. Once we remove the points that are equal to 0 than we have almost a normal distribution, which is preferable when performing a regression. Again lets observe the distribution of the points &gt; 0. Logarea Burned area Distribution (&gt;0) options(repr.plot.width = 7, repr.plot.height = 5) # managing the size ggplot(df_fires[df_fires$logarea!= 0,], aes(logarea)) + geom_histogram(bins = 30) + theme_linedraw() + ggtitle(&quot;Distribution of LogArea Burned (Histogram)&quot;) Creating a binary variable for classification df_train_fires$binary_area &lt;- ifelse(df_train_fires$area == 0, 0, 1) df_test_fires$binary_area &lt;- ifelse(df_test_fires$area == 0, 0, 1) First Component: Binomial Regression # part 1 lr_area &lt;- glm(simplify(&quot;binary_area&quot;, predictors), data = df_train_fires, family = binomial()) summary(lr_area) Call: glm(formula = simplify(&quot;binary_area&quot;, predictors), family = binomial(), data = df_train_fires) Deviance Residuals: Min 1Q Median 3Q Max -1.8324 -1.1165 0.7112 1.0218 1.9726 Coefficients: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -5.251e+00 3.020e+00 -1.739 0.08206 . X 1.893e-01 1.158e-01 1.636 0.10193 Y -3.358e-01 1.892e-01 -1.775 0.07598 . FFMC 4.757e-02 3.074e-02 1.547 0.12176 DMC -1.199e-03 1.056e-02 -0.114 0.90959 ISI -5.425e-03 2.993e-02 -0.181 0.85615 temp 4.970e-02 3.709e-02 1.340 0.18028 RH 8.133e-03 1.053e-02 0.773 0.43970 wind 1.526e-01 6.831e-02 2.234 0.02546 * rain 2.433e-01 3.856e-01 0.631 0.52806 Region1 -2.061e+00 8.422e-01 -2.447 0.01441 * Region3 -8.628e-01 4.813e-01 -1.793 0.07303 . Region4 -7.284e-01 5.524e-01 -1.318 0.18736 Region11 7.205e-01 6.070e-01 1.187 0.23524 Region19 1.139e+00 8.198e-01 1.389 0.16488 Region20 9.303e-01 6.609e-01 1.408 0.15921 Region42 -1.642e+00 6.737e-01 -2.438 0.01479 * Region43 -7.425e-01 5.512e-01 -1.347 0.17802 Region52 -1.887e+00 8.804e-01 -2.144 0.03205 * Region53 -2.009e-01 5.291e-01 -0.380 0.70423 Region58 -8.546e-02 6.318e-01 -0.135 0.89240 Region59 -3.629e-01 5.438e-01 -0.667 0.50461 Region60 4.251e-01 4.608e-01 0.923 0.35626 Region65 -1.006e+00 6.928e-01 -1.452 0.14652 weekend -2.471e-01 2.228e-01 -1.109 0.26733 seasonautumn 3.495e-01 4.825e-01 0.724 0.46878 seasonwinter 1.736e+00 6.377e-01 2.723 0.00647 ** seasonsummer -3.709e-02 5.307e-01 -0.070 0.94427 DMC:DC 2.233e-06 1.209e-05 0.185 0.85344 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 571.13 on 413 degrees of freedom Residual deviance: 519.06 on 385 degrees of freedom AIC: 577.06 Number of Fisher Scoring iterations: 4 We have found some relevant variables in the task of predicting if an area had more than 0 area burned, notably specific variables linked to regions and seasons. We will now use the variables selected in part 1 to perform the logistic regression. We will not go through a process of subset selection variables because we expect the outcome to be the same due to math propoerties that are not relevant to this work. lr_adjR2_area &lt;- glm(simplify(&quot;binary_area&quot;, predictors_adjR), data = df_train_fires, family = binomial()) summary(lr_adjR2_area) Call: glm(formula = simplify(&quot;binary_area&quot;, predictors_adjR), family = binomial(), data = df_train_fires) Deviance Residuals: Min 1Q Median 3Q Max -1.7681 -1.1746 0.7446 1.0195 1.9581 Coefficients: Estimate Std. Error z value Pr(&gt;|z|) (Intercept) -1.323e-01 8.357e-01 -0.158 0.87420 X 6.577e-02 6.959e-02 0.945 0.34463 Y -2.391e-01 1.517e-01 -1.576 0.11504 DMC -1.143e-03 9.553e-03 -0.120 0.90480 temp 4.227e-02 2.347e-02 1.801 0.07169 . wind 1.306e-01 6.339e-02 2.061 0.03930 * Region1 -2.429e+00 7.469e-01 -3.252 0.00114 ** Region3 -1.188e+00 4.247e-01 -2.797 0.00515 ** Region4 -1.127e+00 5.061e-01 -2.228 0.02590 * Region42 -1.511e+00 5.871e-01 -2.574 0.01004 * Region43 -5.675e-01 4.318e-01 -1.314 0.18873 Region52 -1.528e+00 7.278e-01 -2.099 0.03582 * Region59 -3.943e-01 4.981e-01 -0.792 0.42857 Region65 -1.265e+00 5.988e-01 -2.112 0.03467 * seasonwinter 1.245e+00 5.658e-01 2.200 0.02782 * seasonsummer -2.009e-01 3.223e-01 -0.623 0.53303 DMC:DC 4.518e-06 1.072e-05 0.421 0.67352 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 (Dispersion parameter for binomial family taken to be 1) Null deviance: 571.13 on 413 degrees of freedom Residual deviance: 529.64 on 397 degrees of freedom AIC: 563.64 Number of Fisher Scoring iterations: 4 As expected, since we have reduceded the number of predictors, the Residual deviance had an slight increase. On the other hand, the AIC had a decrease. This indicates the model is now less prone to overffiting, and more likely to have a good performance in the test data. Now we will continue with a regression on the positive points of the dataset. df_posit_train_fires &lt;- df_train_fires[df_train_fires$area &gt; 0,] lm_posit_logarea &lt;- lm(simplify(&quot;logarea&quot;, predictors), data = df_posit_train_fires) summary(lm_posit_logarea) Call: lm(formula = simplify(&quot;logarea&quot;, predictors), data = df_posit_train_fires) Residuals: Min 1Q Median 3Q Max -2.3215 -0.8083 -0.1362 0.5900 4.3011 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 1.973e+00 3.588e+00 0.550 0.58306 X 1.104e-01 7.819e-02 1.411 0.15973 Y -8.190e-02 1.398e-01 -0.586 0.55873 FFMC -1.589e-02 3.888e-02 -0.409 0.68310 DMC 2.582e-02 8.727e-03 2.959 0.00347 ** ISI -2.199e-02 3.205e-02 -0.686 0.49338 temp 3.863e-02 3.109e-02 1.242 0.21558 RH 3.408e-03 9.110e-03 0.374 0.70873 wind 8.164e-02 5.605e-02 1.457 0.14684 rain -1.474e-01 2.427e-01 -0.607 0.54434 Region1 8.466e-01 8.488e-01 0.997 0.31976 Region3 -4.940e-01 4.419e-01 -1.118 0.26493 Region4 3.612e-01 5.263e-01 0.686 0.49335 Region11 -1.780e-01 4.688e-01 -0.380 0.70463 Region19 1.986e-01 5.689e-01 0.349 0.72736 Region20 -2.309e-01 4.953e-01 -0.466 0.64162 Region42 -2.128e-01 5.461e-01 -0.390 0.69724 Region43 -7.886e-01 3.890e-01 -2.027 0.04403 * Region52 9.929e-01 9.213e-01 1.078 0.28249 Region53 -5.627e-02 4.032e-01 -0.140 0.88914 Region58 -2.642e-01 4.565e-01 -0.579 0.56343 Region59 -8.935e-01 4.049e-01 -2.207 0.02850 * Region60 -4.706e-01 3.413e-01 -1.379 0.16953 Region65 2.748e-01 5.837e-01 0.471 0.63831 weekend 2.931e-01 1.824e-01 1.607 0.10970 seasonautumn 4.262e-02 4.379e-01 0.097 0.92255 seasonwinter 5.480e-01 5.195e-01 1.055 0.29276 seasonsummer -1.084e+00 4.689e-01 -2.311 0.02188 * DMC:DC -2.757e-05 9.916e-06 -2.781 0.00596 ** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.249 on 195 degrees of freedom Multiple R-squared: 0.1711, Adjusted R-squared: 0.0521 F-statistic: 1.438 on 28 and 195 DF, p-value: 0.08143 The model has a quite low performance and we will apply subset selection to try to improve it. lm_posit_subset &lt;- regsubsets(simplify(&quot;logarea&quot;, predictors), data = df_posit_train_fires, nvmax = 40) lm_posit_subset.summary &lt;- summary(lm_posit_subset) lm_posit_subset.summary Subset selection object Call: regsubsets.formula(simplify(&quot;logarea&quot;, predictors), data = df_posit_train_fires, nvmax = 40) 28 Variables (and intercept) Forced in Forced out X FALSE FALSE Y FALSE FALSE FFMC FALSE FALSE DMC FALSE FALSE ISI FALSE FALSE temp FALSE FALSE RH FALSE FALSE wind FALSE FALSE rain FALSE FALSE Region1 FALSE FALSE Region3 FALSE FALSE Region4 FALSE FALSE Region11 FALSE FALSE Region19 FALSE FALSE Region20 FALSE FALSE Region42 FALSE FALSE Region43 FALSE FALSE Region52 FALSE FALSE Region53 FALSE FALSE Region58 FALSE FALSE Region59 FALSE FALSE Region60 FALSE FALSE Region65 FALSE FALSE weekend FALSE FALSE seasonautumn FALSE FALSE seasonwinter FALSE FALSE seasonsummer FALSE FALSE DMC:DC FALSE FALSE 1 subsets of each size up to 28 Selection Algorithm: exhaustive X Y FFMC DMC ISI temp RH wind rain Region1 Region3 Region4 1 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 5 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 7 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 8 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 9 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 10 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 11 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 12 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 13 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 14 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 15 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 16 ( 1 ) &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 17 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 18 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 19 ( 1 ) &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 20 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 21 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 22 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 23 ( 1 ) &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 24 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 25 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; Region11 Region19 Region20 Region42 Region43 Region52 Region53 1 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 5 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 7 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 8 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 9 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 10 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 11 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 12 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 13 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 14 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 15 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 16 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 17 ( 1 ) &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 18 ( 1 ) &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 19 ( 1 ) &quot; &quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 20 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 21 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 22 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 23 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 24 ( 1 ) &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 25 ( 1 ) &quot;*&quot; &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; Region58 Region59 Region60 Region65 weekend seasonautumn seasonwinter 1 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 2 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 3 ( 1 ) &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 4 ( 1 ) &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 5 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 6 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 7 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; &quot; 8 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 9 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot; &quot; 10 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 11 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 12 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 13 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 14 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 15 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 16 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 17 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 18 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 19 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 20 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 21 ( 1 ) &quot; &quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 22 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 23 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 24 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 25 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot; &quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; &quot;*&quot; seasonsummer DMC:DC 1 ( 1 ) &quot;*&quot; &quot; &quot; 2 ( 1 ) &quot;*&quot; &quot; &quot; 3 ( 1 ) &quot;*&quot; &quot;*&quot; 4 ( 1 ) &quot;*&quot; &quot;*&quot; 5 ( 1 ) &quot;*&quot; &quot;*&quot; 6 ( 1 ) &quot;*&quot; &quot;*&quot; 7 ( 1 ) &quot;*&quot; &quot;*&quot; 8 ( 1 ) &quot;*&quot; &quot;*&quot; 9 ( 1 ) &quot;*&quot; &quot;*&quot; 10 ( 1 ) &quot;*&quot; &quot;*&quot; 11 ( 1 ) &quot;*&quot; &quot;*&quot; 12 ( 1 ) &quot;*&quot; &quot;*&quot; 13 ( 1 ) &quot;*&quot; &quot;*&quot; 14 ( 1 ) &quot;*&quot; &quot;*&quot; 15 ( 1 ) &quot;*&quot; &quot;*&quot; 16 ( 1 ) &quot;*&quot; &quot;*&quot; 17 ( 1 ) &quot;*&quot; &quot;*&quot; 18 ( 1 ) &quot;*&quot; &quot;*&quot; 19 ( 1 ) &quot;*&quot; &quot;*&quot; 20 ( 1 ) &quot;*&quot; &quot;*&quot; 21 ( 1 ) &quot;*&quot; &quot;*&quot; 22 ( 1 ) &quot;*&quot; &quot;*&quot; 23 ( 1 ) &quot;*&quot; &quot;*&quot; 24 ( 1 ) &quot;*&quot; &quot;*&quot; 25 ( 1 ) &quot;*&quot; &quot;*&quot; 26 ( 1 ) &quot;*&quot; &quot;*&quot; 27 ( 1 ) &quot;*&quot; &quot;*&quot; 28 ( 1 ) &quot;*&quot; &quot;*&quot; options(repr.plot.width=15, repr.plot.height=10) # managing the size par(mfrow = c(2, 2)) plot(lm_posit_subset.summary$cp, xlab = &quot;Number of variables&quot;, ylab = &quot;C_p&quot;, type = &quot;l&quot;) points(which.min(lm_posit_subset.summary$cp), lm_posit_subset.summary$cp[which.min(lm_posit_subset.summary$cp)], col = &quot;red&quot;, cex = 2, pch = 20) plot(lm_posit_subset.summary$bic, xlab = &quot;Number of variables&quot;, ylab = &quot;BIC&quot;, type = &quot;l&quot;) points(which.min(lm_posit_subset.summary$bic), lm_posit_subset.summary$bic[which.min(lm_posit_subset.summary$bic)], col = &quot;red&quot;, cex = 2, pch = 20) plot(lm_posit_subset.summary$adjr2, xlab = &quot;Number of variables&quot;, ylab = &quot;Adjusted R^2&quot;, type = &quot;l&quot;) points(which.max(lm_posit_subset.summary$adjr2), lm_posit_subset.summary$adjr2[which.max(lm_posit_subset.summary$adjr2)], col = &quot;red&quot;, cex = 2, pch = 20) plot(lm_posit_subset.summary$rss, xlab = &quot;Number of variables&quot;, ylab = &quot;RSS&quot;, type = &quot;l&quot;) mtext(&quot;Plots of C_p, BIC, adjusted R^2 and RSS best subset selection selection&quot;, side = 3, line = -2, outer = TRUE) coef(lm_posit_subset, which.min(lm_posit_subset.summary$cp)) coef(lm_posit_subset, which.min(lm_posit_subset.summary$bic)) coef(lm_posit_subset, which.max(lm_posit_subset.summary$adjr2)) (Intercept)1.48020595937141 X0.0809547752784181 DMC0.0219214865403856 Region43-0.68303590058244 Region59-0.798154315732607 Region60-0.54195856092524 weekend0.265913932174833 seasonsummer-1.00810076795683 DMC:DC-2.34940806014068e-05 (Intercept)1.70331143574566 DMC0.0241956909502708 seasonsummer-0.963236697621362 DMC:DC-2.55993473859988e-05 (Intercept)0.703865860612608 X0.0887125845951744 DMC0.0250398319780162 temp0.0200056262313652 wind0.0637379419620515 Region11.00845241123666 Region3-0.473888105030186 Region43-0.7151287573868 Region59-0.904038328051593 Region60-0.509101520453757 weekend0.266448108332819 seasonwinter0.619757365115371 seasonsummer-1.15204301839224 DMC:DC-2.65123492005568e-05 predictors_cp2 &lt;- c(&quot;X&quot;, &quot;DMC&quot;, &quot;Region43&quot;, &quot;Region59&quot;, &quot;Region60&quot;, &quot;weekend&quot;, &quot;seasonsummer&quot;, &quot;DMC:DC&quot;) predictors_adjR2 &lt;- c(&quot;X&quot;, &quot;Y&quot;, &quot;DMC&quot;, &quot;temp&quot;, &quot;wind&quot;, &quot;Region1&quot;,&quot;Region3&quot;, &quot;Region43&quot;, &quot;Region59&quot;, &quot;Region60&quot;, &quot;weekend&quot;, &quot;seasonwinter&quot;, &quot;seasonsummer&quot;, &quot;DMC:DC&quot;) lm_posit_cp_logarea &lt;- lm(simplify(&quot;logarea&quot;, predictors_cp2), data = df_posit_train_fires) lm_posit_adjR2_logarea &lt;- lm(simplify(&quot;logarea&quot;, predictors_adjR2), data = df_posit_train_fires) summary(lm_posit_cp_logarea) summary(lm_posit_adjR2_logarea) Call: lm(formula = simplify(&quot;logarea&quot;, predictors_cp2), data = df_posit_train_fires) Residuals: Min 1Q Median 3Q Max -2.1335 -0.8730 -0.1931 0.6051 4.5698 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 1.480e+00 2.986e-01 4.957 1.45e-06 *** X 8.095e-02 3.875e-02 2.089 0.03786 * DMC 2.192e-02 7.421e-03 2.954 0.00349 ** Region43 -6.830e-01 3.007e-01 -2.272 0.02409 * Region59 -7.982e-01 3.561e-01 -2.242 0.02601 * Region60 -5.420e-01 2.716e-01 -1.996 0.04723 * weekend 2.659e-01 1.694e-01 1.570 0.11800 seasonsummer -1.008e+00 2.437e-01 -4.137 5.06e-05 *** DMC:DC -2.349e-05 8.388e-06 -2.801 0.00556 ** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.225 on 215 degrees of freedom Multiple R-squared: 0.1204, Adjusted R-squared: 0.08768 F-statistic: 3.679 on 8 and 215 DF, p-value: 0.0004812 Call: lm(formula = simplify(&quot;logarea&quot;, predictors_adjR2), data = df_posit_train_fires) Residuals: Min 1Q Median 3Q Max -2.4881 -0.8463 -0.1342 0.5300 4.3711 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 9.065e-01 5.919e-01 1.532 0.12714 X 1.081e-01 4.651e-02 2.324 0.02107 * Y -7.255e-02 8.998e-02 -0.806 0.42098 DMC 2.524e-02 7.760e-03 3.252 0.00134 ** temp 2.075e-02 1.898e-02 1.093 0.27544 wind 6.185e-02 5.024e-02 1.231 0.21974 Region1 9.043e-01 7.429e-01 1.217 0.22490 Region3 -4.668e-01 3.913e-01 -1.193 0.23425 Region43 -7.845e-01 3.158e-01 -2.484 0.01376 * Region59 -9.384e-01 3.629e-01 -2.586 0.01040 * Region60 -4.830e-01 2.848e-01 -1.696 0.09135 . weekend 2.569e-01 1.712e-01 1.501 0.13497 seasonwinter 6.673e-01 4.272e-01 1.562 0.11980 seasonsummer -1.153e+00 2.545e-01 -4.532 9.83e-06 *** DMC:DC -2.652e-05 8.603e-06 -3.083 0.00232 ** --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.221 on 209 degrees of freedom Multiple R-squared: 0.1512, Adjusted R-squared: 0.09432 F-statistic: 2.659 on 14 and 209 DF, p-value: 0.001364 Analysis We have decided to proceed with lm_posit_adjR2_logareaand lm_posit_cp_logarea as we beleive they are both succsseful models according to the development of our project. They have similar results, and while the fist has an improved adjusted R-squared the second has a better F-statistic. Final Model Our final models of this second part will join the classification step with the regression for exclusively positive points (area &gt; 0). It can be described as previsously: E[Y|X]=Pr(Y&gt;0|X)×E(Y|Y&gt;0,X), where: Pr(Y&gt;0|X) is given by lr_area, which is a logistic regression. E(Y|Y&gt;0,X) is given by lm_posit_adjR2_logarea or lm_posit_cp_logarea which is the linear model applied only to positive area points. 4. Model Comparsion We will now compare the models we have developed throughout the project. The metrics we will use are inspired in the paper from Paulo Cortez and Anibal Morais - Mean Absolute Deviation (MAD) and Root Mean Squared (RMSE). They can be computed according to the formulas: We will compare 3 different models, which are the following: 1.Model1: lm_adjR2_logarea: A basic model, a simple linear regression that predicts logarea and predictors X, Y, DMC, temp, wind,Region1, Region3, Region4, Region42, Region43, Region52, Region59, seasonwinter, seasonsummer. 2.Model2: lr_adjR2_area x lm_posit_adjR2_logarea: A model that joins a logistic regression with a linear regression. The first model aims to classify if a observation is likely to be zero while the second targets the total area of points thata area different than zero. E[Y|X]=Pr(Y&gt;0|X)×E(Y|Y&gt;0,X). The first regression uses the variables X, Y, DMC, temp, wind,Region1, Region3, Region4, Region42, Region43, Region52, Region59, seasonwinter, seasonsummer while the second uses X, Y, DMC, temp, Region1,Region3, Region43, Region59, Region60, Region60, weekend, seasonwinter, seasonsummer, DMC:DC. 3.Model3: lr_adjR2_area x lm_posit_cp_logarea: A model that joins a logistic regression with a linear regression. The first model aims to classify if a observation is likely to be zero while the second targets the total area of points thata area different than zero. E[Y|X]=Pr(Y&gt;0|X)×E(Y|Y&gt;0,X). The first regression uses the variables X, Y, FFMC, DMC, temp, wind, rain,Region1, Region3, Region19, Region20, Region42, Region43, Region52, Region58, Region59, seasonwinter, seasonsummer while the second uses X, DMC,Region43, Region59, Region60, weekend, seasonsummer, DMC:DC. Defining the functions RMSE &lt;- function(x, y) sqrt(mean((y - x)^2, na.rm = TRUE)) MAE &lt;- function(x, y) mean(abs(y - x), na.rm = TRUE) Performing the calculations phat &lt;- predict(lr_adjR2_area, df_test_fires, type = &quot;response&quot;) df_predictions &lt;- as.data.frame(df_test_fires[,&#39;area&#39;],colname = &#39;area&#39;) colnames(df_predictions)[1] &lt;- &quot;area&quot; df_predictions$model1 &lt;- predict(lm_adjR2_logarea, df_test_fires) df_predictions$model2 &lt;- phat * predict(lm_adjR2_logarea, df_test_fires) df_predictions$model3 &lt;- phat * predict(lm_posit_cp_logarea, df_test_fires) RMSE &lt;- c(RMSE(df_predictions$area, df_predictions$model1), RMSE(df_predictions$area, df_predictions$model2), RMSE(df_predictions$area, df_predictions$model3)) RMSE &lt;ol class=list-inline&gt;&lt;li&gt;20.9233173414873&lt;/li&gt;&lt;li&gt;21.0733370518129&lt;/li&gt;&lt;li&gt;20.943199595481&lt;/li&gt;&lt;/ol&gt; MAE &lt;- c(MAE(df_predictions$area, df_predictions$model1), MAE(df_predictions$area, df_predictions$model2), MAE(df_predictions$area, df_predictions$model3)) MAE 7.21449129803444 7.11280632073942 7.23581143455136 5. Variable Identification and Explanation Throghout this project we have the following manipulations to create new variables with our dataset. Created dummy variables for risk areas - which means, areas where more than 10 fires were registered. Created a dummy variable for seasons, as we observed the relevance of summer and other seasons in the fires. Created a dummy variable for weekends as we had expectations of a human component in the fires. Removed variables related to month and weekday. After performing such manipulations we developed different models where variable identification was a major component. We applied the subset selection tool regsubsets, and analysed all possible combinations of variables. We did not save any computation power by using the foward or backward methods that would lead possibly to inferior models. When identifying significant variables, the most important statistic we have to consider is the $p-value$. The p-value of each coefficient is made to test the null hypothesis, which is that the coefficient is equal to zero. Setting a threhold low such as $p-value$ &lt; 0.05 indicates that the null hypothesis can be rejected and therefore the variable is signicant. To sum up, a predictor with a low p-value is likely to be a meaningful addition to your model because changes in the predictor’s value are related to changes in the response variable. To base my variable identification I will use exclusevely the final models presented in the previous section. We have performed almost 10 modelling/regressions tasks over this project, but we will make use only of the final models to select variables. The folowing table describes our variable selection - all the predictors with a $p-value$ lower than 5% in one of the final models. Predictor Type Description Model X Spatial x-axis spatial coordinate within the Montesinho park map: 1 to 9 Model1, Log Model, Model2 Y Spatial y-axis spatial coordinate within the Montesinho park map: 2 to 9 Model1 Region1 Spatial Dummy variable to characterize region 1 Model1, Log Model Region20 Spatial Dummy variable to characterize region 20 Log Model, Region42 Spatial Dummy variable to characterize region 42 Model1, Log Model Region 43 Spatial Dummy variable to characterize region 43 Model1, Model2, Log Model Region52 Spatial Dummy variable to characterize region 52 Model1 Region59 Spatial Dummy variable to characterize region 59 Model1 DMC FWI DMC index from the FWI system: 1.1 to 291.3 Model2, Model3 DMC:DC FWI DC index from the FWI system: 7.9 to 860.6 Model2, Model3 seasonwinter Temporal Dummy variable for season winter Model1, Log Model seasonsummer Temporal Dummy variable for season summer Model1, Model2, Model3 Weekend Temporal Dummy variable for weekend (Friday, Saturday and Sunday) Model2, Model3 The results for the variable identification are in line with what we expected according to different steps such as data exploration and modelling. We will revise some of the tasks and exploration we have done throughout the project to justify this choices. We will also try to demonstrate with statistical exploration why the variables were selected. Spatial Component Variables: X, Y, Region1, Region20, Region42, Region43, Region52, Region59 First, lets revisite the plot developed in the data exploration part. options(repr.plot.width=7, repr.plot.height=5) # managing the size area_plot With this chart we can see clearly that some areas are more relevant than others for purposes of fire prediction. We will now create a table to see explore the differences of fires among regions. df_fires$risky_region &lt;- ifelse(df_fires$Region == 1, 1, ifelse(df_fires$Region == 20, 1, ifelse(df_fires$Region == 42, 1, ifelse(df_fires$Region == 43, 1, ifelse(df_fires$Region == 52, 1, ifelse(df_fires$Region == 52, 59, 0)))))) df_fires %&gt;% group_by(risky_region) %&gt;% summarize(Total_Area = sum(area, na.rm = TRUE), Count_Fires = n(), Mean_area = mean(area, na.rm = TRUE), Median_area = median(area, na.rm = TRUE),) risky_region Total_Area Count_Fires Mean_area Median_area 0 5558.29 391 14.215575 0.76 1 1054.37 116 9.089397 0.00 From this table we can observe: That fires in Risky Areas are proportionally in much higher number. They are 6 regions out of 72 and more than 1/4 of the fires. In addition, almost 1/5 of the burned areas were in risky regions. options(repr.plot.width=15, repr.plot.height=5) # managing the size df_fires$region_plot &lt;- df_fires$region for (i in 1:nrow(df_fires)){ df_fires[i, &#39;region_plot&#39;] &lt;- ifelse(df_fires[i, &#39;risky_region&#39;] == 1, df_fires[i, &#39;Region&#39;], &quot;Non_Risky&quot;) } region59 &lt;- df_fires[df_fires$Region == 59,] # Top Right: Set a different color for each group ggplot(df_fires, aes(x=region_plot, y=area, fill=region_plot)) + geom_boxplot(alpha=0.3) + theme(legend.position=&quot;none&quot;) Conclusion: The plot above is very conclusive, altough the oposite may be aparent. The predictors we salected from regions have: A small number of outliers compared to other variables. A big number of count of fires. In conclusion, they are well behaved, with a stable distribution and therefore are good predictors. Temporal Predictiors We will start by ploting a chart previously developed. options(repr.plot.width=15, repr.plot.height=10) # managing the size grid.arrange(p3, p4, p7, p8, nrow = 2, ncol = 2) # making the plot We consider this plots sufficient to demonstrate the importance of summer and autum in predicting the fires. We have alredy made clear that all models have selected seasonsummer and seasonautumn and weekend as predictors with a good P-value. FWI We have demostrated the correlation between DMC:DC and used it as a predictor which made it a chosen variable. Also DMC was chosen as a relevant variable. Choosing the Best Predictor Now, we will make a linear regression with the predictors normalized to finally compare than all in the same scale. df_fires$DMC_DC &lt;- df_fires$DMC * df_fires$DC # missing variable # normalize function normalize &lt;- function(x) { return ((x - min(x)) / (max(x) - min(x))) } df_fires_normal &lt;- df_fires df_fires_normal$X &lt;- normalize(df_fires$X) df_fires_normal$Y &lt;- normalize(df_fires$Y) df_fires_normal$Region1 &lt;- normalize(df_fires$Region1) df_fires_normal$Region20 &lt;- normalize(df_fires$Region20) df_fires_normal$Region42 &lt;- normalize(df_fires$Region42) df_fires_normal$Region43 &lt;- normalize(df_fires$Region43) df_fires_normal$Region52 &lt;- normalize(df_fires$Region52) df_fires_normal$Region59 &lt;- normalize(df_fires$Region59) df_fires_normal$DMC &lt;- normalize(df_fires$DMC) df_fires_normal$DMC_DC &lt;- normalize(df_fires$DMC_DC) df_fires_normal$seasonwinter &lt;- normalize(df_fires$seasonwinter) df_fires_normal$seasonsummer &lt;- normalize(df_fires$seasonsummer) df_fires_normal$weekend &lt;- normalize(df_fires$weekend) Final_predictors &lt;- c(&#39;X&#39;, &#39;Y&#39;, &#39;Region1&#39;, &#39;Region20&#39;, &#39;Region42&#39;, &#39;Region43&#39;, &#39;Region52&#39;, &#39;Region59&#39;, &#39;DMC&#39;, &#39;DMC_DC&#39;, &#39;seasonwinter&#39;, &#39;seasonsummer&#39;, &#39;weekend&#39;, &#39;logarea&#39;) summary(lm(simplify(&quot;logarea&quot;, Final_predictors), data = df_fires_normal)) Warning message in model.matrix.default(mt, mf, contrasts): &quot;the response appeared on the right-hand side and was dropped&quot; Warning message in model.matrix.default(mt, mf, contrasts): &quot;problem with term 14 in model.matrix: no columns are assigned&quot; Call: lm(formula = simplify(&quot;logarea&quot;, Final_predictors), data = df_fires_normal) Residuals: Min 1Q Median 3Q Max -1.7669 -1.0384 -0.5150 0.8502 5.5111 Coefficients: Estimate Std. Error t value Pr(&gt;|t|) (Intercept) 0.72073 0.23018 3.131 0.00184 ** X 0.88915 0.34406 2.584 0.01004 * Y -1.17358 0.55282 -2.123 0.03426 * Region1 -0.63040 0.36807 -1.713 0.08739 . Region20 0.42553 0.35053 1.214 0.22534 Region42 -0.63138 0.34022 -1.856 0.06408 . Region43 -0.50556 0.26307 -1.922 0.05521 . Region52 -0.45570 0.45342 -1.005 0.31538 Region59 -0.52602 0.30475 -1.726 0.08496 . DMC 3.62813 1.63565 2.218 0.02700 * DMC_DC -2.53069 1.57345 -1.608 0.10839 seasonwinter 0.75424 0.29133 2.589 0.00991 ** seasonsummer -0.50650 0.18525 -2.734 0.00648 ** weekend 0.03503 0.12526 0.280 0.77986 --- Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 Residual standard error: 1.386 on 493 degrees of freedom Multiple R-squared: 0.05152, Adjusted R-squared: 0.02651 F-statistic: 2.06 on 13 and 493 DF, p-value: 0.01519 Observations: X, Y, Region1, DMC, seasonsummer and seasonwinter again showed p-value under 0.05 and therefore have influence. DMC and DMC_DC have the highest magnitude, which in this case might mean the highest influence on the area burned. 6. Conclusion In this project our primary task was to model the burned areas of fires in Portugal that occured between the years of 2000 and 2003 according to 12 predictors. We have started performing an intensive exploration of the dataset in each of its dimensions. The dataset variables related time, geographic regions, metheorology and the FWI system. After performing successive tasks and reshaping the dataset with new variables different models were proposed to model the area. After arriving to a subset of 3 final models they’re performance was compared according to RMSE and MAD metrics and finally the most relevant variables were identified. Some of the learning outcomes and relevat observations from the project. By developing heatmap plots we werre able to understand the relevance of the geographical component. Our next step was then to identify the riskiest areas and create dummy variables for each it. By creating new variables such as seasom and weekend, we could enhance our dataset with relevant and improved features. By identifyig the strong correlation between DC and DMC we were able to use them together in a model and explore the synergy. After performing all tasks this was a selected variable. Subset selection was extensevely used in our model development, which increased significantly the performance of our model with respect to ajusted R-squared and F-statistic. Removing influential points was crucial to our model performance. We used Cooks distance approach. A honest attemp to create a model by joinning to logist and linear models. Results were not extraordinary but model building rests as an outcome. Using RMSE and MAD to compare models gave a dimension of the success in the prediction task. 7. References Cortez, P., &amp; Morais, A. D. J. R. (2007). A data mining approach to predict forest fires using meteorological data. Retrieved from http://www3.dsi.uminho.pt/pcortez/fires.pdf Yanghe Huo. What Influences Forest Fires Area?. Retrieved from http://www.columbia.edu/~yh2693/ForestFire.html datasharkie. (Accessed on 2020, may 09). How to normalize data in R. Retrieved from https://datasharkie.com/how-to-normalize-data-in-r/ user3459010 (2019). *Removing outliers based on cook’s distance in R Language Retrieved from https://stats.stackexchange.com/questions/164099/removing-outliers-based-on-cooks-distance-in-r-language r-graph-gallery. (Accessed on 2020, may 09). Heatmap. Retrieved from https://www.r-graph-gallery.com/heatmap zx8754 (2019). Generate a dummy-variable https://stackoverflow.com/questions/11952706/generate-a-dummy-variable","image":"http://localhost:4000/assets/images/fires.jpg","author":{"@type":"Person","name":"Alan Gewerc"},"headline":"Data Science for Social Good - Forecast Bushfires","url":"http://localhost:4000/projects/Bushfire/","dateModified":"2018-11-01T00:00:00+11:00","@context":"https://schema.org"}</script><link rel="stylesheet" href="/assets/css/main-default.css" /><link id="color-scheme" rel="stylesheet" href="/assets/css/main-default.css" /><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/apple-icon-60x60.png" /><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/apple-icon-114x114.png" /><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/apple-icon-152x152.png" /><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/android-icon-192x192.png" /><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" /><link rel="icon" href="/favicon.ico" type="image/x-icon" /><script src="https://cdn.jsdelivr.net/npm/ga-lite@1/dist/ga-lite.min.js" async></script><script> var galite = galite || {}; galite.UA = 'UA-92266803-3';</script><script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML"></script><script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script></head><div class="wrapper"><div class="container"><div class="main"><div class="main-container shadow"><div class="title-space"> <h1>Data Science for Social Good - Forecast Bushfires</h1></div><hr class="dashed"> <main> <ul class="breadcrumbs"> <li><a href="/">Home</a></li> <li><a href="/projects/">Projects</a></li> <li><a href="#">Bushfire</a></li> </ul><div class="meta" data-aos="fade-up"> <p> <small> <span> <i class="fa fa-calendar" aria-hidden="true"></i> 01 Nov 2018&nbsp; </span> <span> <i class="fa fa-user" aria-hidden="true"></i> Alan Gewerc&nbsp; </span> <span> <i class="fa fa-clock-o" aria-hidden="true"></i> 99 mins read. </span> </small> </p></div><div class="featured-image" style="background-image: url(/assets/images/fires.jpg)" data-aos="zoom-in" ></div><div class="container"> <article> <h2 id="table-of-contents">Table of Contents</h2> <ul> <li><a href="#sec_1">Introduction</a></li> <li><a href="#sec_2">Data Exploration</a></li> <li><a href="#sec_3">Model Development</a></li> <li><a href="#sec_4">Model Comparison</a></li> <li><a href="#sec_5">Variable Identification and Explanation</a></li> <li><a href="#sec_6">Conclusion</a></li> <li><a href="#sec_7">References</a></li> </ul> <h2 id="1-introduction-">1. Introduction <a class="anchor" id="sec_1"></a></h2> <p>In this project we aim to create models that can predict the area burned in fires. We will be working with data from the UCI machine learning <a href="http://archive.ics.uci.edu/ml/datasets/Forest+Fires">repository</a> and is a collection curated by scientists Paulo Cortez and Anibal Morais from the Unviersity of Minho, Portugal.</p> <p>The data includes meteorological measurements taken at the time the fire was reported, <code class="highlighter-rouge">spatial/temporal measurements, and index metrics</code> that take into a account weather data in the recent past. The index metrics are a part of the <strong>Canadian Fire Weather Index System (FWI)</strong>. The data was collected from January 2000 to December 2003 from the northeast region of Portugal. Data was collected from a total of 517 fires.</p> <p>Many different ML models can be applied - in the basis <a href="http://archive.ics.uci.edu/ml/datasets/Forest+Fires">paper</a> the one who achieved the best performance was Support Vector Machines (SVM). However, in this project we will be testing advanced regression techniques only.</p> <p>Our work will follow the steps:</p> <ol> <li>Perform data exploration and understand the trends in the dataset.</li> <li>Do necessary data manipulations such as data reshaping and outlier removal to enhance the dataset.</li> <li>Create models to predict the burned area according to different regression techniques.</li> <li>Compare the models performance and choose a winner.</li> <li>Explain the most relevant predictors according to the models and the data exploration.</li> </ol> <h4 id="attribute-information-provided-with-the-data">Attribute information: Provided with the data</h4> <p><strong>1. Spatial information</strong></p> <ul> <li><code class="highlighter-rouge">X</code>: x-axis spatial coordinate within the Montesinho park map: 1 to 9</li> <li><code class="highlighter-rouge">Y</code>: y-axis spatial coordinate within the Montesinho park map: 2 to 9</li> </ul> <p><strong>2. Temporal information</strong></p> <ul> <li><code class="highlighter-rouge">month</code>: month of the year: “jan” to “dec”</li> <li><code class="highlighter-rouge">day</code>: day of the week: “mon” to “sun”</li> </ul> <p><strong>3. FWI: The forest Fire Weather Index (FWI). Which is the Canadian system for rating fire danger.</strong></p> <ul> <li><code class="highlighter-rouge">FFMC</code>: FFMC index from the FWI system: 18.7 to 96.20</li> <li><code class="highlighter-rouge">DMC</code>: DMC index from the FWI system: 1.1 to 291.3</li> <li><code class="highlighter-rouge">DC</code>: DC index from the FWI system: 7.9 to 860.6</li> <li><code class="highlighter-rouge">ISI</code>: ISI index from the FWI system: 0.0 to 56.10</li> </ul> <p><strong>4. Methorological information</strong></p> <ul> <li><code class="highlighter-rouge">temp</code>: temperature in Celsius degrees: 2.2 to 33.30</li> <li><code class="highlighter-rouge">RH</code>: relative humidity in %: 15.0 to 100</li> <li><code class="highlighter-rouge">wind</code>: wind speed in km/h: 0.40 to 9.40</li> <li><code class="highlighter-rouge">rain</code>: outside rain in mm/m2 : 0.0 to 6.4</li> </ul> <p><strong>5. area</strong>: the burned area of the forest (in ha): 0.00 to 1090.84</p> <p>Programming Language: R 3.5.1 in Jupyter Notebook</p> <p>R Libraries used:</p> <ul> <li>caret</li> <li>data.table</li> <li>dplyr</li> <li>e1071</li> <li>GGally</li> <li>ggplot2</li> <li>grid</li> <li>gridExtra</li> <li>lattice</li> <li>leaps</li> <li>MASS</li> <li>PerformanceAnalytics</li> </ul> <h4 id="importing-libraries">Importing Libraries</h4><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w"> </span><span class="c1"># for improved plots</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">GGally</span><span class="p">)</span><span class="w"> </span><span class="c1"># for scatterplot matrix</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">e1071</span><span class="p">)</span><span class="w"> </span><span class="c1"># For ML functions</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">MASS</span><span class="p">)</span><span class="w"> </span><span class="c1"># For ML functions</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span><span class="w"> </span><span class="c1"># manipultaion such as inner joins</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span><span class="w"> </span><span class="c1"># functions and classes that represent graphical objects or grobs</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">gridExtra</span><span class="p">)</span><span class="w"> </span><span class="c1"># organizing plots</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">lattice</span><span class="p">)</span><span class="w"> </span><span class="c1"># for levelplot</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w"> </span><span class="c1"># for data manipulation</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">PerformanceAnalytics</span><span class="p">)</span><span class="w"> 
</span><span class="n">library</span><span class="p">(</span><span class="n">caret</span><span class="p">)</span><span class="w"> </span><span class="c1"># </span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">leaps</span><span class="p">)</span><span class="w"> </span><span class="c1"># for regsubsets function</span><span class="w">
</span></code></pre></div></div><h2 id="2-data-exploration">2. Data Exploration<a class="anchor" id="sec_2"></a></h2> <h4 id="load-the-data">Load the data</h4><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_fires</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read.csv</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="s2">"forestfires.csv"</span><span class="p">,</span><span class="w"> </span><span class="n">header</span><span class="o">=</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">sep</span><span class="o">=</span><span class="s2">","</span><span class="p">)</span><span class="w">
</span><span class="n">head</span><span class="p">(</span><span class="n">df_fires</span><span class="p">)</span><span class="w"> </span><span class="c1"># Dysplay first six rows of the table </span><span class="w">
</span></code></pre></div></div><table> <thead> <tr> <th style="text-align: right">id</th> <th style="text-align: right">X</th> <th style="text-align: right">Y</th> <th style="text-align: right">month</th> <th style="text-align: right">day</th> <th style="text-align: right">FFMC</th> <th style="text-align: right">DMC</th> <th style="text-align: right">DC</th> <th style="text-align: right">ISI</th> <th style="text-align: right">temp</th> <th style="text-align: right">RH</th> <th style="text-align: right">wind</th> <th style="text-align: right">rain</th> <th style="text-align: right">area</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">1</td> <td style="text-align: right">7</td> <td style="text-align: right">5</td> <td style="text-align: right">mar</td> <td style="text-align: right">fri</td> <td style="text-align: right">86.2</td> <td style="text-align: right">26.2</td> <td style="text-align: right">94.3</td> <td style="text-align: right">5.1</td> <td style="text-align: right">8.2</td> <td style="text-align: right">51</td> <td style="text-align: right">6.7</td> <td style="text-align: right">0.0</td> <td style="text-align: right">0</td> </tr> <tr> <td style="text-align: right">2</td> <td style="text-align: right">7</td> <td style="text-align: right">4</td> <td style="text-align: right">oct</td> <td style="text-align: right">tue</td> <td style="text-align: right">90.6</td> <td style="text-align: right">35.4</td> <td style="text-align: right">669.1</td> <td style="text-align: right">6.7</td> <td style="text-align: right">18.0</td> <td style="text-align: right">33</td> <td style="text-align: right">0.9</td> <td style="text-align: right">0.0</td> <td style="text-align: right">0</td> </tr> <tr> <td style="text-align: right">3</td> <td style="text-align: right">7</td> <td style="text-align: right">4</td> <td style="text-align: right">oct</td> <td style="text-align: right">sat</td> <td style="text-align: right">90.6</td> <td style="text-align: right">43.7</td> <td style="text-align: right">686.9</td> <td style="text-align: right">6.7</td> <td style="text-align: right">14.6</td> <td style="text-align: right">33</td> <td style="text-align: right">1.3</td> <td style="text-align: right">0.0</td> <td style="text-align: right">0</td> </tr> <tr> <td style="text-align: right">4</td> <td style="text-align: right">8</td> <td style="text-align: right">6</td> <td style="text-align: right">mar</td> <td style="text-align: right">fri</td> <td style="text-align: right">91.7</td> <td style="text-align: right">33.3</td> <td style="text-align: right">77.5</td> <td style="text-align: right">9.0</td> <td style="text-align: right">8.3</td> <td style="text-align: right">97</td> <td style="text-align: right">4.0</td> <td style="text-align: right">0.2</td> <td style="text-align: right">0</td> </tr> <tr> <td style="text-align: right">5</td> <td style="text-align: right">8</td> <td style="text-align: right">6</td> <td style="text-align: right">mar</td> <td style="text-align: right">sun</td> <td style="text-align: right">89.3</td> <td style="text-align: right">51.3</td> <td style="text-align: right">102.2</td> <td style="text-align: right">9.6</td> <td style="text-align: right">11.4</td> <td style="text-align: right">99</td> <td style="text-align: right">1.8</td> <td style="text-align: right">0.0</td> <td style="text-align: right">0</td> </tr> <tr> <td style="text-align: right">6</td> <td style="text-align: right">8</td> <td style="text-align: right">6</td> <td style="text-align: right">aug</td> <td style="text-align: right">sun</td> <td style="text-align: right">92.3</td> <td style="text-align: right">85.3</td> <td style="text-align: right">488.0</td> <td style="text-align: right">14.7</td> <td style="text-align: right">22.2</td> <td style="text-align: right">29</td> <td style="text-align: right">5.4</td> <td style="text-align: right">0.0</td> <td style="text-align: right">0</td> </tr> </tbody> </table> <h4 id="understanding-the-burned-area-distribution">Understanding the burned area distribution</h4> <p>As previously stated we aim to predict the area of the fire according to the other variables. it is logical that we start our data exploration from the area. A first look at the table above show that the area is 0 in all of the first rows which is a concern. The authors in their <em>paper</em> have explained that an area smaller than $100m^2$ is replaced by 0. Lets check the distribution of the burned area using an histogram.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="c1"># area of display</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_fires</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">area</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span><span class="n">theme_linedraw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Distribution of Area Burned (Histogram)"</span><span class="p">)</span><span class="w">

</span></code></pre></div></div><p><img src="/assets/images//Bushfire_6_0.png" alt="png" /></p> <p>This is an extremely skewed variable and most likely to make a prediction we will have to handle it accordingly. We plan to do a regression in the future and this might be a problem, because for the residuals to be normal the predicted variable should not be extremely skewed distribution. A possible first strategy is to apply transformatio methods such as the <code class="highlighter-rouge">logarithm</code> and see how the data will reshape. <br /> <strong>Important:</strong> As we saw many of the data points of area are equal to 0 - so we cannot pass the pure log, but instead we will apply the formula <br /></p> <p><script type="math/tex">y = (log_{10}x+1)</script>.</p> <h4 id="log-transformation-on-the-area">Log transformation on the area</h4><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_fires</span><span class="o">$</span><span class="n">logarea</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">log</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">area</span><span class="m">+1</span><span class="p">)</span><span class="w">

</span><span class="c1"># plotting the new distribution</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_fires</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">logarea</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span><span class="n">theme_linedraw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Distribution of LogArea Burned (Histogram)"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><p><img src="/assets/images//Bushfire_8_0.png" alt="png" /></p> <p>Our data remains skilled, however, can see small improve in the distribution of the data. We will make a final analysis, by checking what happens if we do not consider the very small fires (size 0).</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ggplot</span><span class="p">(</span><span class="n">df_fires</span><span class="p">[</span><span class="n">df_fires</span><span class="o">$</span><span class="n">logarea</span><span class="o">!=</span><span class="w"> </span><span class="m">0</span><span class="p">,],</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">logarea</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span><span class="n">theme_linedraw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Distribution of LogArea Burned (Histogram)"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><p><img src="/assets/images//Bushfire_10_0.png" alt="png" /></p> <p>Observations regarding the distribution of the data:</p> <ol> <li>The distribution of the burned area is very skill and this might be a problem for modelling.</li> <li>We have made a first log transformation that made slight improve.</li> <li>If we exclude the close to 0 fires we will find a closely normal distribution which might be good to work with for modelling tasks.</li> </ol> <h3 id="spatial-analysis">Spatial Analysis</h3> <p>The dataset contains spatial information representing the fires location. The X and Y variables represent the geographical locations in a map and can only be analysed together to make sense. The X axis ranges from 1 to 9 (integers) while the y axis from 2 to 9. Together, they form an area of 72 spaces. We will develop heatmaps in the folowing to identify areas that have been particular areas of focus of fires with respect to:</p> <ul> <li>The area affected.</li> <li>The number of fires.</li> <li>Other variables that we might want to compare</li> </ul><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># create a table</span><span class="w">
</span><span class="c1"># grouping other variables by area</span><span class="w">
</span><span class="n">df_spatial</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_fires</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarize</span><span class="p">(</span><span class="n">Total_Area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">area</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w">
            </span><span class="n">Count_Fires</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">(),</span><span class="w"> 
            </span><span class="n">temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">median</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w">
            </span><span class="n">RH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">median</span><span class="p">(</span><span class="n">RH</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w">
            </span><span class="n">wind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">median</span><span class="p">(</span><span class="n">wind</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w">
            </span><span class="n">rain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">median</span><span class="p">(</span><span class="n">rain</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w">
            </span><span class="n">FFMC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">median</span><span class="p">(</span><span class="n">FFMC</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w">
            </span><span class="n">DMC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">median</span><span class="p">(</span><span class="n">DMC</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w">
            </span><span class="n">DC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">median</span><span class="p">(</span><span class="n">DC</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w">
            </span><span class="n">ISI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">median</span><span class="p">(</span><span class="n">ISI</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
           </span><span class="p">)</span><span class="w">
</span></code></pre></div></div><p>We want to develop a very specific heatmap, with many different features. To simplify the process of plotting we will create a function that will be used to make applied to make different plots.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">areaheatplot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span><span class="w"> </span><span class="n">tittle</span><span class="p">)</span><span class="w"> 

</span><span class="p">{</span><span class="w">
    </span><span class="n">Total.heatmap</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_spatial</span><span class="p">,</span><span class="w"> </span><span class="n">mapping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Y</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">scale</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
    </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">tittle</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_tile</span><span class="p">(</span><span class="n">position</span><span class="o">=</span><span class="n">position_nudge</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">),</span><span class="w">  </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
    </span><span class="n">theme_linedraw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
    </span><span class="n">theme</span><span class="p">(</span><span class="n">panel.grid.major</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element_line</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"blue"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_fill_gradient</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="s2">"orange"</span><span class="p">,</span><span class="w"> </span><span class="n">high</span><span class="o">=</span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">na.value</span><span class="w"> </span><span class="o">=</span><span class="s2">"white"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
    </span><span class="n">geom_text</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)),</span><span class="w"> </span><span class="n">position</span><span class="o">=</span><span class="n">position_nudge</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
    </span><span class="n">scale_x_discrete</span><span class="p">(</span><span class="n">breaks</span><span class="o">=</span><span class="n">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w">  </span><span class="o">+</span><span class="w"> 
    </span><span class="n">scale_y_discrete</span><span class="p">(</span><span class="n">breaks</span><span class="o">=</span><span class="n">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w">
    </span><span class="n">return</span><span class="w"> </span><span class="p">(</span><span class="n">Total.heatmap</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div><p>Now, we will investigate different trends that data may show according to the region in which the fire happened. Firstly, we will try to observe some areas are more likely to have fires than others.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">area_plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">areaheatplot</span><span class="p">(</span><span class="n">df_spatial</span><span class="o">$</span><span class="n">Total_Area</span><span class="p">,</span><span class="w"> </span><span class="s2">"Total Area"</span><span class="p">)</span><span class="w">
</span><span class="n">count_plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">areaheatplot</span><span class="p">(</span><span class="n">df_spatial</span><span class="o">$</span><span class="n">Count_Fires</span><span class="p">,</span><span class="w"> </span><span class="s2">"Number of Fires"</span><span class="p">)</span><span class="w">
</span><span class="n">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="c1"># managing the size</span><span class="w">
</span><span class="n">grid.arrange</span><span class="p">(</span><span class="n">area_plot</span><span class="p">,</span><span class="w"> </span><span class="n">count_plot</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="c1"># making the plot</span><span class="w">
</span></code></pre></div></div><p><img src="/assets/images//Bushfire_16_0.png" alt="png" /></p> <p>Observations:</p> <ul> <li>Clearly there are more area that are more prone to fires than others.</li> <li>The interesection between X (6-9) and Y (4-7) accounts for more than half of fires.</li> <li>Most regions did not have fires at all.</li> </ul> <p>Now, we will try to explore the metheorological conditions by region to see if areas that have more fires have any peculiar trends. We will build 8 plots, regions against: Temperature, RH, Wind, Rain, FFMC, DMC, DC, ISI.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">temp_plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">areaheatplot</span><span class="p">(</span><span class="n">df_spatial</span><span class="o">$</span><span class="n">temp</span><span class="p">,</span><span class="w"> </span><span class="s2">"Temperature"</span><span class="p">)</span><span class="w">
</span><span class="n">RH_plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">areaheatplot</span><span class="p">(</span><span class="n">df_spatial</span><span class="o">$</span><span class="n">RH</span><span class="p">,</span><span class="w"> </span><span class="s2">"RH"</span><span class="p">)</span><span class="w">
</span><span class="n">wind_plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">areaheatplot</span><span class="p">(</span><span class="n">df_spatial</span><span class="o">$</span><span class="n">wind</span><span class="p">,</span><span class="w"> </span><span class="s2">"Wind"</span><span class="p">)</span><span class="w">
</span><span class="n">rain_plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">areaheatplot</span><span class="p">(</span><span class="n">df_spatial</span><span class="o">$</span><span class="n">rain</span><span class="p">,</span><span class="w"> </span><span class="s2">"Rain"</span><span class="p">)</span><span class="w">
</span><span class="n">FFMC_plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">areaheatplot</span><span class="p">(</span><span class="n">df_spatial</span><span class="o">$</span><span class="n">FFMC</span><span class="p">,</span><span class="w"> </span><span class="s2">"FFMC"</span><span class="p">)</span><span class="w">
</span><span class="n">DMC_plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">areaheatplot</span><span class="p">(</span><span class="n">df_spatial</span><span class="o">$</span><span class="n">DMC</span><span class="p">,</span><span class="w"> </span><span class="s2">"DMC"</span><span class="p">)</span><span class="w">
</span><span class="n">DC_plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">areaheatplot</span><span class="p">(</span><span class="n">df_spatial</span><span class="o">$</span><span class="n">DC</span><span class="p">,</span><span class="w"> </span><span class="s2">"DC"</span><span class="p">)</span><span class="w">
</span><span class="n">ISI_plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">areaheatplot</span><span class="p">(</span><span class="n">df_spatial</span><span class="o">$</span><span class="n">ISI</span><span class="p">,</span><span class="w"> </span><span class="s2">"ISI"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">15</span><span class="p">)</span><span class="w"> </span><span class="c1"># managing the size</span><span class="w">
</span><span class="n">grid.arrange</span><span class="p">(</span><span class="n">temp_plot</span><span class="p">,</span><span class="w"> </span><span class="n">RH_plot</span><span class="p">,</span><span class="w"> </span><span class="n">wind_plot</span><span class="p">,</span><span class="w"> </span><span class="n">rain_plot</span><span class="p">,</span><span class="w"> </span><span class="n">FFMC_plot</span><span class="p">,</span><span class="w"> </span><span class="n">DMC_plot</span><span class="p">,</span><span class="w"> </span><span class="n">DC_plot</span><span class="p">,</span><span class="w"> </span><span class="n">ISI_plot</span><span class="p">,</span><span class="w">
             </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="c1"># making the plot</span><span class="w">
</span></code></pre></div></div><p><img src="/assets/images//Bushfire_19_0.png" alt="png" /></p> <p>Observations:</p> <ul> <li>The latest charts are very useful to explore visually the relationship of variables with areas.</li> <li>Due to complexity, it is difficult to arrive to conclusions for modelling purposes.</li> <li>Apparently areas with more fires also have higher proportion of the other variables such as higher temperatures and Relative Humidity. <br /></li> </ul> <h4 id="creating-new-dummy-variables-for-risky-areas----one-hot-encoding-of-regions">Creating New Dummy Variables for Risky Areas - One Hot Encoding of Regions</h4> <p>A region is a area formed by a X and a Y point. In total, there are 72 regions - with X ranging from 1-9 and Y raging from 2-9. Therefore we will create a new variable called region, because it will be better to analyse the data considering that hardly X and Y independently would make sense to analyse.<br /> As we have seen there are areas that are more prone to fires than others. This was explored even with relationship to other variables. We want our model to be able to capture this “risk” so we will make some modifications in our dataset. We will create dummy variables for all regions that concentrate more than 2% (at least 10) of the number of fires. We have chosen this threshold because we do not want our future models to overfit by using this new variables.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># adding region variable</span><span class="w">
</span><span class="n">df_area</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">Region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">72</span><span class="p">,</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">9</span><span class="p">,</span><span class="w"> </span><span class="n">Y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="o">:</span><span class="m">9</span><span class="p">)</span><span class="w">
</span><span class="n">df_fires</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">left_join</span><span class="p">(</span><span class="n">df_fires</span><span class="p">,</span><span class="w"> </span><span class="n">df_area</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"X"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Y"</span><span class="p">))</span><span class="w">

</span><span class="c1"># group by region the number of fires</span><span class="w">
</span><span class="n">df_spatial</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_fires</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">Region</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarize</span><span class="p">(</span><span class="n">Total_Area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">area</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w">
            </span><span class="n">Count_Fires</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="w">

</span><span class="c1"># filter areas with more than 10 fires</span><span class="w">
</span><span class="n">attach</span><span class="p">(</span><span class="n">df_spatial</span><span class="p">)</span><span class="w">
</span><span class="n">df_spatial</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_spatial</span><span class="p">[</span><span class="n">which</span><span class="p">(</span><span class="n">Count_Fires</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">10</span><span class="p">),]</span><span class="w">
</span><span class="n">detach</span><span class="p">(</span><span class="n">df_spatial</span><span class="p">)</span><span class="w">

</span><span class="n">danger_areas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_spatial</span><span class="o">$</span><span class="n">Region</span><span class="w"> 
</span><span class="n">cat</span><span class="p">(</span><span class="s2">"Danger Areas: Regions that have more than 10 registered fires \n"</span><span class="p">,</span><span class="w"> </span><span class="n">df_spatial</span><span class="o">$</span><span class="n">Region</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><p><samp class="text-primary"> Danger Areas: Regions that have more than 10 registered fires <br /> 1 3 4 11 19 20 42 43 52 53 58 59 60 65 67<br /> </samp></p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># creating dummy variables</span><span class="w">
</span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="n">danger_areas</span><span class="p">)){</span><span class="w">
    </span><span class="n">df_fires</span><span class="p">[,</span><span class="n">paste0</span><span class="p">(</span><span class="s2">"Region"</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_fires</span><span class="o">$</span><span class="n">Region</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">yes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div></div><p>We have created 15 dummy variables that may be characterized as risk regions.</p> <h4 id="temporal-analysis">Temporal Analysis</h4> <p>We will further investigate the temporal dimension of the dataset. We want to know if fires are more likely to happen in a especific day or month. We noted, however, that it might be better to explore the data according to seasonality and weekends, because we beleive they should be better predictors. We will now:</p> <ol> <li>Create new variables, a dummy for weekends and a seasonality variable.</li> <li>Explore the trends of the variables <code class="highlighter-rouge">weekends</code>, <code class="highlighter-rouge">seasonality</code>, <code class="highlighter-rouge">month</code> and <code class="highlighter-rouge">day</code>.</li> </ol><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># create variable season</span><span class="w">
</span><span class="n">df_fires</span><span class="o">$</span><span class="n">season</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">month</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"aug"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">df_fires</span><span class="o">$</span><span class="n">month</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"jun"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">df_fires</span><span class="o">$</span><span class="n">month</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"jul"</span><span class="p">,</span><span class="s1">'summer'</span><span class="p">,</span><span class="w"> 
                          </span><span class="n">ifelse</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">month</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"oct"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">df_fires</span><span class="o">$</span><span class="n">month</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"nov"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">df_fires</span><span class="o">$</span><span class="n">month</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"sep"</span><span class="p">,</span><span class="s2">"autumn"</span><span class="p">,</span><span class="w">
                                 </span><span class="n">ifelse</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">month</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"feb"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">df_fires</span><span class="o">$</span><span class="n">month</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"jan"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">df_fires</span><span class="o">$</span><span class="n">month</span><span class="w"> </span><span class="o">==</span><span class="s2">"dec"</span><span class="p">,</span><span class="w"> </span><span class="s2">"winter"</span><span class="p">,</span><span class="w">
                                        </span><span class="n">ifelse</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">month</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"mar"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">df_fires</span><span class="o">$</span><span class="n">month</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"apr"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">df_fires</span><span class="o">$</span><span class="n">month</span><span class="w"> </span><span class="o">==</span><span class="s1">'may'</span><span class="p">,</span><span class="w"> </span><span class="s2">"spring"</span><span class="p">,</span><span class="w"> </span><span class="s1">'NA'</span><span class="p">))))</span><span class="w">
</span></code></pre></div></div><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># create variable weekend</span><span class="w">
</span><span class="c1"># note that we consider fruday a weekend day</span><span class="w">
</span><span class="n">df_fires</span><span class="o">$</span><span class="n">weekend</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">day</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"mon"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">df_fires</span><span class="o">$</span><span class="n">day</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"tue"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">df_fires</span><span class="o">$</span><span class="n">day</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"wed"</span><span class="o">|</span><span class="w"> </span><span class="n">df_fires</span><span class="o">$</span><span class="n">day</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"thu"</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># creating a table with the count of fires</span><span class="w">
</span><span class="n">df_season</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_fires</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">season</span><span class="p">,</span><span class="w"> </span><span class="n">month</span><span class="p">,</span><span class="w"> </span><span class="n">day</span><span class="p">,</span><span class="w"> </span><span class="n">weekend</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarize</span><span class="p">(</span><span class="n">Total_Area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">logarea</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w">
            </span><span class="n">Count_Fires</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">())</span><span class="w">
</span></code></pre></div></div><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">day_order</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"mon"</span><span class="p">,</span><span class="w"> </span><span class="s2">"tue"</span><span class="p">,</span><span class="w"> </span><span class="s2">"wed"</span><span class="p">,</span><span class="w"> </span><span class="s2">"thu"</span><span class="p">,</span><span class="w"> </span><span class="s2">"fri"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sat"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sun"</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">season_order</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"summer"</span><span class="p">,</span><span class="w"> </span><span class="s2">"autumn"</span><span class="p">,</span><span class="w"> </span><span class="s2">"winter"</span><span class="p">,</span><span class="w"> </span><span class="s2">"spring"</span><span class="p">)</span><span class="w"> </span><span class="c1"># Natural order of seasons</span><span class="w">
</span><span class="n">month_order</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"jan"</span><span class="p">,</span><span class="w"> </span><span class="s2">"feb"</span><span class="p">,</span><span class="w"> </span><span class="s2">"mar"</span><span class="p">,</span><span class="w"> </span><span class="s2">"apr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"may"</span><span class="p">,</span><span class="w"> </span><span class="s2">"jun"</span><span class="p">,</span><span class="w"> </span><span class="s2">"jul"</span><span class="p">,</span><span class="w"> </span><span class="s2">"aug"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sep"</span><span class="p">,</span><span class="w"> </span><span class="s2">"oct"</span><span class="p">,</span><span class="w"> </span><span class="s2">"nov"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dec"</span><span class="p">)</span><span class="w">

</span><span class="n">p1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_fires</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">month</span><span class="p">,</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">month_order</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="n">logarea</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_boxplot</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">"slateblue"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme_classic</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Distribution Fires by Month"</span><span class="p">)</span><span class="w">
</span><span class="n">p2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_season</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">month</span><span class="p">,</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">month_order</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="n">Total_Area</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">"grey"</span><span class="p">,</span><span class="w"> </span><span class="n">stat</span><span class="o">=</span><span class="s2">"identity"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme_classic</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Distribution Fires by Month"</span><span class="p">)</span><span class="w">

</span><span class="n">p3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_fires</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">season</span><span class="p">,</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season_order</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="n">logarea</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_boxplot</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">"slateblue"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme_classic</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Distribution Fires by Season"</span><span class="p">)</span><span class="w">
</span><span class="n">p4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_season</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">season</span><span class="p">,</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season_order</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="n">Total_Area</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">"grey"</span><span class="p">,</span><span class="w"> </span><span class="n">stat</span><span class="o">=</span><span class="s2">"identity"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme_classic</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Distribution Fires by Season"</span><span class="p">)</span><span class="w">

</span><span class="n">p5</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_fires</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">day</span><span class="p">,</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">day_order</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="n">logarea</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_boxplot</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">"slateblue"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme_classic</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Distribution Fires by Day"</span><span class="p">)</span><span class="w">
</span><span class="n">p6</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_season</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">day</span><span class="p">,</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">day_order</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="n">Total_Area</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">"grey"</span><span class="p">,</span><span class="w"> </span><span class="n">stat</span><span class="o">=</span><span class="s2">"identity"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme_classic</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Distribution Fires by Day"</span><span class="p">)</span><span class="w">

</span><span class="n">p7</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_fires</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">weekend</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="n">logarea</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_boxplot</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">"slateblue"</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="o">=</span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme_classic</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Distribution Fires by Weekend"</span><span class="p">)</span><span class="w">
</span><span class="n">p8</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_season</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">weekend</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="n">Total_Area</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="s2">"grey"</span><span class="p">,</span><span class="w"> </span><span class="n">stat</span><span class="o">=</span><span class="s2">"identity"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">theme_classic</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Distribution Fires by Weekend"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">15</span><span class="p">)</span><span class="w"> </span><span class="c1"># managing the size</span><span class="w">
</span><span class="n">grid.arrange</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">p2</span><span class="p">,</span><span class="w"> </span><span class="n">p3</span><span class="p">,</span><span class="w"> </span><span class="n">p4</span><span class="p">,</span><span class="w"> </span><span class="n">p5</span><span class="p">,</span><span class="w"> </span><span class="n">p6</span><span class="p">,</span><span class="w"> </span><span class="n">p7</span><span class="p">,</span><span class="w"> </span><span class="n">p8</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="c1"># making the plot</span><span class="w">
</span></code></pre></div></div><p><img src="/assets/images//Bushfire_28_0.png" alt="png" /></p> <p>Some observations about the temporal data.</p> <ol> <li>As expected summer has the highest number of fires, as we have seen that temperature is correlated to number of fires.</li> <li>Winter has a very small of fires compared to other seasons, but curiously the highest median.</li> <li>More than 70% of fires are either in summer or autumn. We expect this predictor to have a significant prediction power and we will create dummy variables for each season.</li> <li>We are considering weekends with 3 days and weekdays of 4 days. Nevertheless there are more fires in weekends. This might demonstrate a relationship of fires with human activity. This is especially true if we consider that there are many significant fire outliers on weekends.</li> </ol> <h4 id="one-hot-encoding-of-seasons">One Hot Encoding of Seasons</h4> <p>To work with seasons it will be preferable to create dummy variables. This is what we will do next.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">seasons</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">season</span><span class="p">)</span><span class="w"> 

</span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="p">(</span><span class="n">seasons</span><span class="p">)){</span><span class="w">
    </span><span class="n">df_fires</span><span class="p">[,</span><span class="n">paste0</span><span class="p">(</span><span class="s2">"season"</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_fires</span><span class="o">$</span><span class="n">season</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">yes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">df_fires</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">subset</span><span class="p">(</span><span class="n">df_fires</span><span class="p">,</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nf">c</span><span class="p">(</span><span class="n">seasonspring</span><span class="p">))</span><span class="w"> </span><span class="c1"># eliminating a season for the one_hot_encoding </span><span class="w">

</span></code></pre></div></div><h3 id="a-first-look-at-correlations">A first look at correlations</h3> <p>Lets investigate how the variables relate to each other. To explore correlations we will leave the previously explored variables - related to temporal and and spatial analysis.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="c1"># managing the size</span><span class="w">
</span><span class="n">ggpairs</span><span class="p">(</span><span class="n">df_fires</span><span class="p">[,</span><span class="nf">c</span><span class="p">(</span><span class="n">seq</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="m">13</span><span class="p">))])</span><span class="w">
</span></code></pre></div></div><p><img src="/assets/images//Bushfire_33_0.png" alt="png" /></p> <p>This chart is particularly useful as other than the correlation we can see the distribution of the variables. With respect to correlation:</p> <ul> <li>There is no significant and strong correlation with two variables. <ul> <li>Only one exception should be noticed, DC and DMC. <strong>They might be useful working together in our models</strong>.</li> </ul> </li> <li>Temp apparently have a meaningful but small positive correlation with ISI, DC, DMC and FFMC.</li> <li>Even though many of the variables have been extracted from other variables, as an example, DC from rain and temperature, our variables seem to have a good level of independence that allow us to work with them together with no major concerns with colinearity and similar problems.</li> </ul> <h2 id="3-model-development">3. Model Development<a class="anchor" id="sec_3"></a></h2> <p>We will develop 2-3 models in this part of the project, with goal of predicting the burned area. Before performaing any modelling task, however, we will split the data in trainning and testing. Naturally, will we use a cross-validation approach. We will split the dataset in train and test, having 80% of trainning data.</p> <h4 id="split-dataset-in-train-and-test">split Dataset in train and test</h4><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">210</span><span class="p">)</span><span class="w">
</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nrow</span><span class="p">(</span><span class="n">df_fires</span><span class="p">)</span><span class="w">
</span><span class="n">shuffled</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_fires</span><span class="p">[</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="p">),]</span><span class="w">
</span><span class="n">df_train_fires</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">shuffled</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="nf">round</span><span class="p">(</span><span class="m">0.80</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="p">),]</span><span class="w">
</span><span class="n">df_test_fires</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">shuffled</span><span class="p">[(</span><span class="nf">round</span><span class="p">(</span><span class="m">0.80</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="o">:</span><span class="n">n</span><span class="p">,]</span><span class="w">
</span><span class="n">rownames</span><span class="p">(</span><span class="n">df_train_fires</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">nrow</span><span class="p">(</span><span class="n">df_train_fires</span><span class="p">)</span><span class="w"> 
</span></code></pre></div></div><h4 id="influential-outliers-detection">Influential Outliers Detection</h4> <p>We have observed that the dataset has a right skewed distribution, and with significant outliers that may compromise our models. In this project we want to apply exclusevely linear models along with logistic regressions and therefore we would benefit from a clean dataset. Therefore we will remove significant outliers from our dataset. There are two recommended approaches in this situation:</p> <ul> <li>Remove outliers according to boxplot distribution.</li> <li>Remove Influential points according to Cooks distance.</li> </ul> <p>We have decided to take the second approach as we believe it is more aligned with the scope of our project and regression models. We will do it by the following steps.</p> <ol> <li>Filter from the dataset all non-zero area points. We want to do it because we will build some models that will target the non-zero distribution of the area.</li> <li>Build a simple linear regression with all predictors.</li> <li>Find influential points.</li> <li>Remove influential points from the dataset.</li> </ol> <p>Obs: The method used in this extraction was influenced by the following <a href="http://www.columbia.edu/~yh2693/ForestFire.html">work</a>.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">attach</span><span class="p">(</span><span class="n">df_train_fires</span><span class="p">)</span><span class="w">
</span><span class="n">posit_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_train_fires</span><span class="p">[</span><span class="n">which</span><span class="p">(</span><span class="n">area</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">),]</span><span class="w">
</span></code></pre></div></div><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="c1"># managing the size</span><span class="w">

</span><span class="n">mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">logarea</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="o">=</span><span class="n">posit_data</span><span class="p">[</span><span class="nf">c</span><span class="p">(</span><span class="n">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">12</span><span class="p">),</span><span class="n">seq</span><span class="p">(</span><span class="m">14</span><span class="p">,</span><span class="m">31</span><span class="p">))])</span><span class="w"> </span><span class="c1"># regression model</span><span class="w">
</span><span class="n">cooksd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">cooks.distance</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span><span class="w">

</span><span class="n">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">12</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">6</span><span class="p">)</span><span class="w"> </span><span class="c1"># managing the size</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">cooksd</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="o">=</span><span class="s2">"*"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="o">=</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="o">=</span><span class="s2">"Influential Obs by Cooks distance"</span><span class="p">)</span><span class="w">  </span><span class="c1"># plot cook's distance</span><span class="w">
</span><span class="n">abline</span><span class="p">(</span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="o">*</span><span class="n">mean</span><span class="p">(</span><span class="n">cooksd</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="nb">T</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span><span class="w">  </span><span class="c1"># add cutoff line</span><span class="w">
</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">cooksd</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">cooksd</span><span class="m">+0.002</span><span class="p">,</span><span class="w"> </span><span class="n">labels</span><span class="o">=</span><span class="n">ifelse</span><span class="p">(</span><span class="n">cooksd</span><span class="o">&gt;</span><span class="m">4</span><span class="o">*</span><span class="n">mean</span><span class="p">(</span><span class="n">cooksd</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="nb">T</span><span class="p">),</span><span class="nf">names</span><span class="p">(</span><span class="n">cooksd</span><span class="p">),</span><span class="s2">""</span><span class="p">),</span><span class="w"> </span><span class="n">col</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span><span class="w">  </span><span class="c1"># add labels</span><span class="w">
</span></code></pre></div></div><p><img src="/assets/images//Bushfire_39_0.png" alt="png" /></p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">influential</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">which</span><span class="p">(</span><span class="n">cooksd</span><span class="o">&gt;</span><span class="m">4</span><span class="o">*</span><span class="n">mean</span><span class="p">(</span><span class="n">cooksd</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="o">=</span><span class="nb">T</span><span class="p">))</span><span class="w"> </span><span class="c1"># finding influential points</span><span class="w">
</span><span class="n">df_train_fires</span><span class="p">[</span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">names</span><span class="p">(</span><span class="n">influential</span><span class="p">)),</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">13</span><span class="p">]</span><span class="w"> 
</span></code></pre></div></div><table> <thead> <tr> <th style="text-align: right">id</th> <th style="text-align: right">X</th> <th style="text-align: right">Y</th> <th style="text-align: right">month</th> <th style="text-align: right">day</th> <th style="text-align: right">FFMC</th> <th style="text-align: right">DMC</th> <th style="text-align: right">DC</th> <th style="text-align: right">ISI</th> <th style="text-align: right">temp</th> <th style="text-align: right">RH</th> <th style="text-align: right">wind</th> <th style="text-align: right">rain</th> <th style="text-align: right">area</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">11</td> <td style="text-align: right">8</td> <td style="text-align: right">8</td> <td style="text-align: right">aug</td> <td style="text-align: right">wed</td> <td style="text-align: right">91.7</td> <td style="text-align: right">191.4</td> <td style="text-align: right">635.9</td> <td style="text-align: right">7.8</td> <td style="text-align: right">26.2</td> <td style="text-align: right">36</td> <td style="text-align: right">4.5</td> <td style="text-align: right">0</td> <td style="text-align: right">185.76</td> </tr> <tr> <td style="text-align: right">88</td> <td style="text-align: right">7</td> <td style="text-align: right">4</td> <td style="text-align: right">jul</td> <td style="text-align: right">mon</td> <td style="text-align: right">89.2</td> <td style="text-align: right">103.9</td> <td style="text-align: right">431.6</td> <td style="text-align: right">6.4</td> <td style="text-align: right">22.6</td> <td style="text-align: right">57</td> <td style="text-align: right">4.9</td> <td style="text-align: right">0</td> <td style="text-align: right">278.53</td> </tr> <tr> <td style="text-align: right">112</td> <td style="text-align: right">8</td> <td style="text-align: right">6</td> <td style="text-align: right">aug</td> <td style="text-align: right">thu</td> <td style="text-align: right">94.8</td> <td style="text-align: right">222.4</td> <td style="text-align: right">698.6</td> <td style="text-align: right">13.9</td> <td style="text-align: right">27.5</td> <td style="text-align: right">27</td> <td style="text-align: right">4.9</td> <td style="text-align: right">0</td> <td style="text-align: right">746.28</td> </tr> <tr> <td style="text-align: right">152</td> <td style="text-align: right">1</td> <td style="text-align: right">2</td> <td style="text-align: right">jul</td> <td style="text-align: right">sat</td> <td style="text-align: right">90.0</td> <td style="text-align: right">51.3</td> <td style="text-align: right">296.3</td> <td style="text-align: right">8.7</td> <td style="text-align: right">16.6</td> <td style="text-align: right">53</td> <td style="text-align: right">5.4</td> <td style="text-align: right">0</td> <td style="text-align: right">0.71</td> </tr> <tr> <td style="text-align: right">173</td> <td style="text-align: right">7</td> <td style="text-align: right">4</td> <td style="text-align: right">aug</td> <td style="text-align: right">sat</td> <td style="text-align: right">93.5</td> <td style="text-align: right">139.4</td> <td style="text-align: right">594.2</td> <td style="text-align: right">20.3</td> <td style="text-align: right">5.1</td> <td style="text-align: right">96</td> <td style="text-align: right">5.8</td> <td style="text-align: right">0</td> <td style="text-align: right">26.00</td> </tr> <tr> <td style="text-align: right">194</td> <td style="text-align: right">1</td> <td style="text-align: right">2</td> <td style="text-align: right">sep</td> <td style="text-align: right">tue</td> <td style="text-align: right">91.0</td> <td style="text-align: right">129.5</td> <td style="text-align: right">692.6</td> <td style="text-align: right">7.0</td> <td style="text-align: right">18.8</td> <td style="text-align: right">40</td> <td style="text-align: right">2.2</td> <td style="text-align: right">0</td> <td style="text-align: right">212.88</td> </tr> <tr> <td style="text-align: right">204</td> <td style="text-align: right">6</td> <td style="text-align: right">5</td> <td style="text-align: right">sep</td> <td style="text-align: right">sat</td> <td style="text-align: right">92.5</td> <td style="text-align: right">121.1</td> <td style="text-align: right">674.4</td> <td style="text-align: right">8.6</td> <td style="text-align: right">25.1</td> <td style="text-align: right">27</td> <td style="text-align: right">4.0</td> <td style="text-align: right">0</td> <td style="text-align: right">1090.84</td> </tr> <tr> <td style="text-align: right">304</td> <td style="text-align: right">4</td> <td style="text-align: right">3</td> <td style="text-align: right">aug</td> <td style="text-align: right">wed</td> <td style="text-align: right">94.5</td> <td style="text-align: right">139.4</td> <td style="text-align: right">689.1</td> <td style="text-align: right">20.0</td> <td style="text-align: right">28.9</td> <td style="text-align: right">29</td> <td style="text-align: right">4.9</td> <td style="text-align: right">0</td> <td style="text-align: right">49.59</td> </tr> <tr> <td style="text-align: right">324</td> <td style="text-align: right">9</td> <td style="text-align: right">9</td> <td style="text-align: right">jul</td> <td style="text-align: right">tue</td> <td style="text-align: right">85.8</td> <td style="text-align: right">48.3</td> <td style="text-align: right">313.4</td> <td style="text-align: right">3.9</td> <td style="text-align: right">18.0</td> <td style="text-align: right">42</td> <td style="text-align: right">2.7</td> <td style="text-align: right">0</td> <td style="text-align: right">0.36</td> </tr> <tr> <td style="text-align: right">411</td> <td style="text-align: right">2</td> <td style="text-align: right">4</td> <td style="text-align: right">aug</td> <td style="text-align: right">sun</td> <td style="text-align: right">81.6</td> <td style="text-align: right">56.7</td> <td style="text-align: right">665.6</td> <td style="text-align: right">1.9</td> <td style="text-align: right">21.9</td> <td style="text-align: right">71</td> <td style="text-align: right">5.8</td> <td style="text-align: right">0</td> <td style="text-align: right">54.29</td> </tr> </tbody> </table><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_fires</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_fires</span><span class="p">[</span><span class="o">-</span><span class="nf">as.numeric</span><span class="p">(</span><span class="nf">names</span><span class="p">(</span><span class="n">influential</span><span class="p">)),</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="c1"># removing from the dataset</span><span class="w">
</span></code></pre></div></div><h2 id="model-1---linear-regression">Model 1 - Linear Regression</h2> <p>Our first model will be a simple linear regression. <br /> We have observed that the area is not normally distributed and therefore it is preferable to predict the log of area. Nevertheless, we will also test a model to predict the area. As we know, the formula of the regression is: <br /></p> <p><strong>First Model:</strong><script type="math/tex">y = \beta_0 + \beta_1 * x_1 + ... + \beta_n * x_n</script><br /> <strong>Second Model:</strong><script type="math/tex">log(y) = \beta_0 + \beta_1 * x_1 + ... + \beta_n * x_n</script></p> <p>When fitting a regression we want to obtain the best performance of our metrics. The most relevant are:</p> <ul> <li>R-Squared: Represents the proportion of the variance for a dependent variable that’s explained by independent variables. The higher the better.</li> <li>Adjusted R-squared: Simillar to R-squared, but also compares the explanatory power of regression models that contain different numbers of predictors. The higher the better.</li> <li>F-Test: Indicates if the model provides a better fit to the data than a model that contains no independent variables. The higher the better.</li> <li>RMSE: Represents the standard deviation of the differences between predicted values and observed values (residuals). The lower the better.</li> </ul><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">names</span><span class="p">(</span><span class="n">df_train_fires</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	'X''Y''month''day''FFMC''DMC''DC''ISI''temp''RH''wind''rain''area''logarea''Region''Region1''Region3''Region4''Region11''Region19''Region20''Region42''Region43''Region52''Region53''Region58''Region59''Region60''Region65''Region67''season''weekend''seasonautumn''seasonsummer''seasonwinter'
</code></pre></div></div><p>We will create a list of the variables called predictors that will help us in the progress of our model development. Also a support function that will be used to have less wording in the model development. A important note: We will explore the sinergy of <code class="highlighter-rouge">DC</code> and <code class="highlighter-rouge">DMC</code> - as we saw in the previous section and they are strongly correlated.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># create a list of variables to use in modelling</span><span class="w">
</span><span class="n">predictors</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"X"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Y"</span><span class="p">,</span><span class="w"> </span><span class="s2">"FFMC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"DMC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"DMC:DC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"ISI"</span><span class="p">,</span><span class="w"> </span><span class="s2">"temp"</span><span class="p">,</span><span class="w"> </span><span class="s2">"RH"</span><span class="p">,</span><span class="w"> </span><span class="s2">"wind"</span><span class="p">,</span><span class="w"> </span><span class="s2">"rain"</span><span class="p">,</span><span class="w"> 
           </span><span class="s2">"Region1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Region3"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Region4"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Region11"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Region19"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Region20"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Region42"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Region43"</span><span class="p">,</span><span class="w"> 
                </span><span class="s2">"Region52"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Region53"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Region58"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Region59"</span><span class="p">,</span><span class="s2">"Region60"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Region65"</span><span class="p">,</span><span class="w"> </span><span class="s2">"weekend"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"seasonautumn"</span><span class="p">,</span><span class="w"> </span><span class="s2">"seasonwinter"</span><span class="p">,</span><span class="w"> </span><span class="s2">"seasonsummer"</span><span class="p">)</span><span class="w">

</span><span class="n">simplify</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">predictors</span><span class="p">){</span><span class="w">
  </span><span class="nf">return</span><span class="p">(</span><span class="n">as.formula</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="s2">"~"</span><span class="p">,</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="n">predictors</span><span class="p">,</span><span class="w"> </span><span class="n">collapse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"+"</span><span class="p">))))</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Fitting the models </span><span class="w">

</span><span class="n">lm_area</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="s2">"area"</span><span class="p">,</span><span class="w"> </span><span class="n">predictors</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_train_fires</span><span class="p">)</span><span class="w"> 
</span><span class="n">lm_logarea</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="s2">"logarea"</span><span class="p">,</span><span class="w"> </span><span class="n">predictors</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_train_fires</span><span class="p">)</span><span class="w"> 

</span><span class="c1"># summary of the model (estimates and metrics)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">lm_area</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">lm_logarea</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Call:
lm(formula = simplify("area", predictors), data = df_train_fires)

Residuals:
    Min      1Q  Median      3Q     Max 
 -60.70  -20.82   -6.98    5.01 1024.21 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  -5.768e+01  8.366e+01  -0.690   0.4909  
X             3.379e+00  3.696e+00   0.914   0.3612  
Y            -4.351e-01  6.178e+00  -0.070   0.9439  
FFMC         -7.792e-02  8.029e-01  -0.097   0.9227  
DMC           7.302e-01  3.462e-01   2.110   0.0355 *
ISI          -7.071e-01  9.687e-01  -0.730   0.4659  
temp          1.939e+00  1.217e+00   1.594   0.1118  
RH           -9.880e-02  3.435e-01  -0.288   0.7738  
wind          2.720e+00  2.184e+00   1.245   0.2139  
rain         -2.418e+00  1.158e+01  -0.209   0.8347  
Region1       1.338e+01  2.543e+01   0.526   0.5992  
Region3      -1.343e+00  1.610e+01  -0.083   0.9335  
Region4       1.998e+00  1.835e+01   0.109   0.9134  
Region11      4.730e-01  1.989e+01   0.024   0.9810  
Region19      1.194e+01  2.603e+01   0.459   0.6466  
Region20     -2.145e+00  2.206e+01  -0.097   0.9226  
Region42     -1.216e+01  2.202e+01  -0.552   0.5812  
Region43     -7.094e+00  1.783e+01  -0.398   0.6909  
Region52     -9.631e+00  2.664e+01  -0.362   0.7179  
Region53      6.323e+00  1.772e+01   0.357   0.7215  
Region58     -1.579e+00  2.074e+01  -0.076   0.9394  
Region59     -1.200e+01  1.811e+01  -0.663   0.5078  
Region60      2.201e+01  1.478e+01   1.489   0.1373  
Region65      1.033e+01  2.341e+01   0.441   0.6594  
weekend       1.116e+00  7.387e+00   0.151   0.8800  
seasonautumn  1.368e+01  1.581e+01   0.865   0.3876  
seasonwinter  3.079e+01  2.022e+01   1.523   0.1286  
seasonsummer -1.542e+01  1.756e+01  -0.878   0.3806  
DMC:DC       -7.666e-04  3.965e-04  -1.934   0.0539 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 70.83 on 385 degrees of freedom
Multiple R-squared:  0.05539,	Adjusted R-squared:  -0.01331 
F-statistic: 0.8063 on 28 and 385 DF,  p-value: 0.7493





Call:
lm(formula = simplify("logarea", predictors), data = df_train_fires)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.1635 -0.9899 -0.4054  0.7261  5.1428 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  -8.455e-01  1.646e+00  -0.514  0.60766   
X             1.569e-01  7.271e-02   2.158  0.03154 * 
Y            -2.417e-01  1.215e-01  -1.989  0.04740 * 
FFMC          1.281e-02  1.579e-02   0.811  0.41774   
DMC           1.453e-02  6.809e-03   2.134  0.03345 * 
ISI          -1.574e-02  1.905e-02  -0.826  0.40937   
temp          3.150e-02  2.393e-02   1.316  0.18881   
RH            2.656e-03  6.756e-03   0.393  0.69447   
wind          9.700e-02  4.297e-02   2.258  0.02453 * 
rain          1.291e-01  2.277e-01   0.567  0.57099   
Region1      -8.881e-01  5.002e-01  -1.775  0.07663 . 
Region3      -6.338e-01  3.166e-01  -2.002  0.04599 * 
Region4      -3.222e-01  3.610e-01  -0.893  0.37260   
Region11      1.459e-01  3.913e-01   0.373  0.70946   
Region19      5.081e-01  5.120e-01   0.992  0.32163   
Region20      2.239e-01  4.340e-01   0.516  0.60619   
Region42     -1.117e+00  4.331e-01  -2.579  0.01027 * 
Region43     -8.885e-01  3.507e-01  -2.533  0.01169 * 
Region52     -8.646e-01  5.240e-01  -1.650  0.09978 . 
Region53     -1.898e-01  3.486e-01  -0.545  0.58641   
Region58     -2.241e-01  4.079e-01  -0.549  0.58309   
Region59     -8.085e-01  3.561e-01  -2.270  0.02375 * 
Region60     -1.806e-01  2.908e-01  -0.621  0.53501   
Region65     -6.117e-01  4.605e-01  -1.328  0.18482   
weekend       1.277e-02  1.453e-01   0.088  0.93000   
seasonautumn  2.510e-01  3.111e-01   0.807  0.42024   
seasonwinter  1.121e+00  3.977e-01   2.818  0.00507 **
seasonsummer -5.150e-01  3.454e-01  -1.491  0.13682   
DMC:DC       -1.442e-05  7.799e-06  -1.849  0.06523 . 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.393 on 385 degrees of freedom
Multiple R-squared:  0.1008,	Adjusted R-squared:  0.0354 
F-statistic: 1.541 on 28 and 385 DF,  p-value: 0.04093
</code></pre></div></div><p>As expected <code class="highlighter-rouge">lm_logarea</code> performed better than <code class="highlighter-rouge">lm_area</code>, because logarea is more appropriate as a label. Therefore we will be working exclusevely with lm_logarea from now on. It calls our attention that the model has a small predictive power with respect to the metrics of performance, such as F-statistic and R-squared. In fact we found an negative adjusted R-Squared in <code class="highlighter-rouge">lm_area</code> which means the model contains terms that do not help to predict the response. Let’s proceed with diagnostic plots.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">8</span><span class="p">)</span><span class="w"> </span><span class="c1"># managing the size</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">mfcol</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">lm_logarea</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><p><img src="/assets/images//Bushfire_48_0.png" alt="png" /></p> <p>The diagnostic plots show residuals in four different ways. Some observations about the plots:</p> <ul> <li><strong>Residual vs fitted plot and scale-location plot:</strong> They access if the residuals have non-linear patterns and if residuals are spread equally along the ranges of predictors. We can see an abnormal pattern such as some points in a linear trend. Other points are well behaved.</li> <li><strong>Q-Q plot:</strong> Unfortunately we can observe that the distribution of the residuals is not normal and this might explain the performance of our model.</li> <li><strong>Residual-leverage plot</strong>: Since we have previously performed data manipulation removing outliers and highly influential points, they are not a concern in this step. There is a limitrofe point just on the 0.5 line but we will keep it for now.</li> </ul> <h3 id="subset-selection">Subset Selection</h3> <p>In this task, we will use the regsubsets() function to perform best subset selection in order to choose the best model containing the predictors. We want the best model obtained according to $C_p$, $BIC$, and adjusted $R^2$. Show some plots to provide evidence for your answer, and report the coefficients of the best model obtained.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lm_subset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">regsubsets</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="s2">"logarea"</span><span class="p">,</span><span class="w"> </span><span class="n">predictors</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_train_fires</span><span class="p">,</span><span class="w"> </span><span class="n">nvmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">40</span><span class="p">)</span><span class="w">
</span><span class="n">lm_subset.summary</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">summary</span><span class="p">(</span><span class="n">lm_subset</span><span class="p">)</span><span class="w">
</span><span class="n">lm_subset.summary</span><span class="w">
</span></code></pre></div></div><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Subset selection object
Call: regsubsets.formula(simplify("logarea", predictors), data = df_train_fires, 
    nvmax = 40)
28 Variables  (and intercept)
             Forced in Forced out
X                FALSE      FALSE
Y                FALSE      FALSE
FFMC             FALSE      FALSE
DMC              FALSE      FALSE
ISI              FALSE      FALSE
temp             FALSE      FALSE
RH               FALSE      FALSE
wind             FALSE      FALSE
rain             FALSE      FALSE
Region1          FALSE      FALSE
Region3          FALSE      FALSE
Region4          FALSE      FALSE
Region11         FALSE      FALSE
Region19         FALSE      FALSE
Region20         FALSE      FALSE
Region42         FALSE      FALSE
Region43         FALSE      FALSE
Region52         FALSE      FALSE
Region53         FALSE      FALSE
Region58         FALSE      FALSE
Region59         FALSE      FALSE
Region60         FALSE      FALSE
Region65         FALSE      FALSE
weekend          FALSE      FALSE
seasonautumn     FALSE      FALSE
seasonwinter     FALSE      FALSE
seasonsummer     FALSE      FALSE
DMC:DC           FALSE      FALSE
1 subsets of each size up to 28
Selection Algorithm: exhaustive
          X   Y   FFMC DMC ISI temp RH  wind rain Region1 Region3 Region4
1  ( 1 )  " " " " " "  " " " " " "  " " " "  " "  " "     "*"     " "    
2  ( 1 )  " " " " " "  " " " " " "  " " " "  " "  "*"     "*"     " "    
3  ( 1 )  " " " " " "  " " " " " "  " " "*"  " "  "*"     "*"     " "    
4  ( 1 )  " " " " " "  " " " " " "  " " "*"  " "  "*"     "*"     " "    
5  ( 1 )  " " " " " "  "*" " " " "  " " "*"  " "  "*"     "*"     " "    
6  ( 1 )  " " " " " "  " " " " "*"  " " "*"  " "  "*"     "*"     " "    
7  ( 1 )  " " " " " "  "*" " " " "  " " "*"  " "  "*"     "*"     " "    
8  ( 1 )  " " " " " "  "*" " " "*"  " " "*"  " "  "*"     "*"     " "    
9  ( 1 )  " " " " " "  "*" " " "*"  " " "*"  " "  "*"     "*"     " "    
10  ( 1 ) " " " " " "  "*" " " "*"  " " "*"  " "  "*"     "*"     "*"    
11  ( 1 ) " " " " " "  "*" " " "*"  " " "*"  " "  "*"     "*"     "*"    
12  ( 1 ) " " " " " "  "*" " " "*"  " " "*"  " "  "*"     "*"     "*"    
13  ( 1 ) "*" "*" " "  "*" " " " "  " " "*"  " "  "*"     "*"     " "    
14  ( 1 ) "*" "*" " "  "*" " " "*"  " " "*"  " "  "*"     "*"     " "    
15  ( 1 ) "*" "*" " "  "*" " " "*"  " " "*"  " "  "*"     "*"     " "    
16  ( 1 ) "*" "*" " "  "*" " " "*"  " " "*"  " "  "*"     "*"     "*"    
17  ( 1 ) "*" "*" " "  "*" " " "*"  " " "*"  " "  "*"     "*"     "*"    
18  ( 1 ) "*" "*" " "  "*" " " "*"  " " "*"  " "  "*"     "*"     "*"    
19  ( 1 ) "*" "*" " "  "*" " " "*"  " " "*"  "*"  "*"     "*"     "*"    
20  ( 1 ) "*" "*" "*"  "*" "*" "*"  " " "*"  " "  "*"     "*"     "*"    
21  ( 1 ) "*" "*" "*"  "*" "*" "*"  " " "*"  "*"  "*"     "*"     "*"    
22  ( 1 ) "*" "*" "*"  "*" "*" "*"  " " "*"  "*"  "*"     "*"     "*"    
23  ( 1 ) "*" "*" "*"  "*" "*" "*"  " " "*"  "*"  "*"     "*"     "*"    
24  ( 1 ) "*" "*" "*"  "*" "*" "*"  " " "*"  "*"  "*"     "*"     "*"    
25  ( 1 ) "*" "*" "*"  "*" "*" "*"  "*" "*"  "*"  "*"     "*"     "*"    
26  ( 1 ) "*" "*" "*"  "*" "*" "*"  "*" "*"  "*"  "*"     "*"     "*"    
27  ( 1 ) "*" "*" "*"  "*" "*" "*"  "*" "*"  "*"  "*"     "*"     "*"    
28  ( 1 ) "*" "*" "*"  "*" "*" "*"  "*" "*"  "*"  "*"     "*"     "*"    
          Region11 Region19 Region20 Region42 Region43 Region52 Region53
1  ( 1 )  " "      " "      " "      " "      " "      " "      " "     
2  ( 1 )  " "      " "      " "      " "      " "      " "      " "     
3  ( 1 )  " "      " "      " "      " "      " "      " "      " "     
4  ( 1 )  " "      " "      " "      " "      " "      " "      " "     
5  ( 1 )  " "      " "      " "      " "      " "      " "      " "     
6  ( 1 )  " "      " "      " "      " "      " "      " "      " "     
7  ( 1 )  " "      " "      " "      " "      " "      " "      " "     
8  ( 1 )  " "      " "      " "      " "      " "      " "      " "     
9  ( 1 )  " "      " "      " "      " "      " "      " "      " "     
10  ( 1 ) " "      " "      " "      " "      " "      " "      " "     
11  ( 1 ) " "      " "      " "      "*"      " "      " "      " "     
12  ( 1 ) " "      " "      " "      "*"      "*"      " "      " "     
13  ( 1 ) " "      " "      " "      "*"      "*"      " "      " "     
14  ( 1 ) " "      " "      " "      "*"      "*"      " "      " "     
15  ( 1 ) " "      " "      " "      "*"      "*"      "*"      " "     
16  ( 1 ) " "      " "      " "      "*"      "*"      "*"      " "     
17  ( 1 ) " "      " "      " "      "*"      "*"      "*"      " "     
18  ( 1 ) " "      "*"      " "      "*"      "*"      "*"      " "     
19  ( 1 ) " "      "*"      " "      "*"      "*"      "*"      " "     
20  ( 1 ) " "      "*"      " "      "*"      "*"      "*"      " "     
21  ( 1 ) " "      "*"      " "      "*"      "*"      "*"      " "     
22  ( 1 ) " "      "*"      " "      "*"      "*"      "*"      " "     
23  ( 1 ) " "      "*"      " "      "*"      "*"      "*"      " "     
24  ( 1 ) " "      "*"      " "      "*"      "*"      "*"      "*"     
25  ( 1 ) " "      "*"      " "      "*"      "*"      "*"      "*"     
26  ( 1 ) " "      "*"      "*"      "*"      "*"      "*"      "*"     
27  ( 1 ) "*"      "*"      "*"      "*"      "*"      "*"      "*"     
28  ( 1 ) "*"      "*"      "*"      "*"      "*"      "*"      "*"     
          Region58 Region59 Region60 Region65 weekend seasonautumn seasonwinter
1  ( 1 )  " "      " "      " "      " "      " "     " "          " "         
2  ( 1 )  " "      " "      " "      " "      " "     " "          " "         
3  ( 1 )  " "      " "      " "      " "      " "     " "          " "         
4  ( 1 )  " "      " "      " "      " "      " "     "*"          " "         
5  ( 1 )  " "      " "      " "      " "      " "     " "          " "         
6  ( 1 )  " "      " "      " "      " "      " "     "*"          "*"         
7  ( 1 )  " "      " "      " "      " "      " "     "*"          "*"         
8  ( 1 )  " "      " "      " "      " "      " "     " "          "*"         
9  ( 1 )  " "      "*"      " "      " "      " "     " "          "*"         
10  ( 1 ) " "      "*"      " "      " "      " "     " "          "*"         
11  ( 1 ) " "      "*"      " "      " "      " "     " "          "*"         
12  ( 1 ) " "      "*"      " "      " "      " "     " "          "*"         
13  ( 1 ) " "      "*"      " "      "*"      " "     "*"          "*"         
14  ( 1 ) " "      "*"      " "      "*"      " "     " "          "*"         
15  ( 1 ) " "      "*"      " "      "*"      " "     " "          "*"         
16  ( 1 ) " "      "*"      " "      "*"      " "     " "          "*"         
17  ( 1 ) " "      "*"      " "      "*"      " "     "*"          "*"         
18  ( 1 ) " "      "*"      " "      "*"      " "     "*"          "*"         
19  ( 1 ) " "      "*"      " "      "*"      " "     "*"          "*"         
20  ( 1 ) " "      "*"      " "      "*"      " "     "*"          "*"         
21  ( 1 ) " "      "*"      " "      "*"      " "     "*"          "*"         
22  ( 1 ) "*"      "*"      " "      "*"      " "     "*"          "*"         
23  ( 1 ) "*"      "*"      "*"      "*"      " "     "*"          "*"         
24  ( 1 ) "*"      "*"      "*"      "*"      " "     "*"          "*"         
25  ( 1 ) "*"      "*"      "*"      "*"      " "     "*"          "*"         
26  ( 1 ) "*"      "*"      "*"      "*"      " "     "*"          "*"         
27  ( 1 ) "*"      "*"      "*"      "*"      " "     "*"          "*"         
28  ( 1 ) "*"      "*"      "*"      "*"      "*"     "*"          "*"         
          seasonsummer DMC:DC
1  ( 1 )  " "          " "   
2  ( 1 )  " "          " "   
3  ( 1 )  " "          " "   
4  ( 1 )  " "          " "   
5  ( 1 )  "*"          " "   
6  ( 1 )  " "          " "   
7  ( 1 )  " "          "*"   
8  ( 1 )  "*"          "*"   
9  ( 1 )  "*"          "*"   
10  ( 1 ) "*"          "*"   
11  ( 1 ) "*"          "*"   
12  ( 1 ) "*"          "*"   
13  ( 1 ) " "          "*"   
14  ( 1 ) "*"          "*"   
15  ( 1 ) "*"          "*"   
16  ( 1 ) "*"          "*"   
17  ( 1 ) "*"          "*"   
18  ( 1 ) "*"          "*"   
19  ( 1 ) "*"          "*"   
20  ( 1 ) "*"          "*"   
21  ( 1 ) "*"          "*"   
22  ( 1 ) "*"          "*"   
23  ( 1 ) "*"          "*"   
24  ( 1 ) "*"          "*"   
25  ( 1 ) "*"          "*"   
26  ( 1 ) "*"          "*"   
27  ( 1 ) "*"          "*"   
28  ( 1 ) "*"          "*"   
</code></pre></div></div><p>Due to the fact we have created many dummy variables for geographic region, our model may have up to 40 variables. We have found the best subset for n variables, when n ranges from 1 to 30. Now we will plot the number of variables from the best models against the accuracy indicators such as Cp, BIC, Ajusted R-squared and RSS.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="c1"># managing the size</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">lm_subset.summary</span><span class="o">$</span><span class="n">cp</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Number of variables"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"C_p"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">)</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">which.min</span><span class="p">(</span><span class="n">lm_subset.summary</span><span class="o">$</span><span class="n">cp</span><span class="p">),</span><span class="w"> </span><span class="n">lm_subset.summary</span><span class="o">$</span><span class="n">cp</span><span class="p">[</span><span class="n">which.min</span><span class="p">(</span><span class="n">lm_subset.summary</span><span class="o">$</span><span class="n">cp</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">lm_subset.summary</span><span class="o">$</span><span class="n">bic</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Number of variables"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"BIC"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">)</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">which.min</span><span class="p">(</span><span class="n">lm_subset.summary</span><span class="o">$</span><span class="n">bic</span><span class="p">),</span><span class="w"> </span><span class="n">lm_subset.summary</span><span class="o">$</span><span class="n">bic</span><span class="p">[</span><span class="n">which.min</span><span class="p">(</span><span class="n">lm_subset.summary</span><span class="o">$</span><span class="n">bic</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">lm_subset.summary</span><span class="o">$</span><span class="n">adjr2</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Number of variables"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Adjusted R^2"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">)</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">which.max</span><span class="p">(</span><span class="n">lm_subset.summary</span><span class="o">$</span><span class="n">adjr2</span><span class="p">),</span><span class="w"> </span><span class="n">lm_subset.summary</span><span class="o">$</span><span class="n">adjr2</span><span class="p">[</span><span class="n">which.max</span><span class="p">(</span><span class="n">lm_subset.summary</span><span class="o">$</span><span class="n">adjr2</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">lm_subset.summary</span><span class="o">$</span><span class="n">rss</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Number of variables"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"RSS"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">)</span><span class="w">
</span><span class="n">mtext</span><span class="p">(</span><span class="s2">"Plots of C_p, BIC, adjusted R^2 and RSS best subset selection selection"</span><span class="p">,</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-2</span><span class="p">,</span><span class="w"> </span><span class="n">outer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><p><img src="/assets/images//Bushfire_52_0.png" alt="png" /></p> <p>It is interesting the fact that we have found different models according to each indicator. Lets compare then.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">coef</span><span class="p">(</span><span class="n">lm_subset</span><span class="p">,</span><span class="w"> </span><span class="n">which.min</span><span class="p">(</span><span class="n">lm_subset.summary</span><span class="o">$</span><span class="n">cp</span><span class="p">))</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">lm_subset</span><span class="p">,</span><span class="w"> </span><span class="n">which.min</span><span class="p">(</span><span class="n">lm_subset.summary</span><span class="o">$</span><span class="n">bic</span><span class="p">))</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">lm_subset</span><span class="p">,</span><span class="w"> </span><span class="n">which.max</span><span class="p">(</span><span class="n">lm_subset.summary</span><span class="o">$</span><span class="n">adjr2</span><span class="p">))</span><span class="w">
</span></code></pre></div></div><p><strong>(Intercept):</strong>-0.0266117016454773 <strong>DMC:</strong> 0.0135111201577867 <strong>temp:</strong> 0.0301357865043537 <strong>wind:</strong>0.0794234546908572 <strong>Region:</strong>1-0.652129755329549 <strong>Region3:</strong>-0.556361498494578 <strong>seasonwinter:</strong>0.824436990829506 <strong>seasonsummer:</strong>-0.625817307938421 <strong>DMC:DC:</strong>-1.27126321593314e-05<br /> <strong>(Intercept):</strong>1.19083283788439 <strong>Region:</strong> 3-0.549921309305286<br /> <strong>(Intercept):</strong>0.55198302136147 <strong>X:</strong>0.0926165837619685 <strong>Y:</strong>-0.194404903439422 <strong>DMC0:</strong>.013670228896515 <strong>temp0:</strong>.0305312643068406 <strong>wind0:</strong>.0839199384373189 <strong>Region1:</strong>-0.968641287013757 <strong>Region3:</strong>-0.679272609210134 <strong>Region4:</strong>-0.416576766202436 <strong>Region42:</strong>-0.910932398029436 <strong>Region43:</strong>-0.668493899182849 <strong>Region52:</strong>-0.606346184501872 <strong>Region59:</strong>-0.718813149812681 <strong>Region65:</strong>-0.642247961402224 <strong>seasonwinter:</strong>0.990242150570015 <strong>seasonsummer:</strong>-0.691447562888277 <strong>DMC:DC:</strong>-1.2331282867293e-05</p> <p>Observations from the subset selection:</p> <ul> <li>While $C_P$ indicates a total of 9 predictors, $BIC$ indicates only one. Adjusted-R-squared indicates 18 variables.</li> <li>We will reject the BIC analysis as we do not believe the model will have a good fit in the test data and work exclusevely with the second and third models.</li> </ul><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># create variables</span><span class="w">
</span><span class="n">predictors_cp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s1">'DMC'</span><span class="p">,</span><span class="s1">'temp'</span><span class="p">,</span><span class="s1">'wind'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Region1'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Region3'</span><span class="p">,</span><span class="s1">'seasonwinter'</span><span class="p">,</span><span class="w"> </span><span class="s1">'seasonsummer'</span><span class="p">,</span><span class="w"> </span><span class="s1">'DMC:DC'</span><span class="p">)</span><span class="w">
</span><span class="n">predictors_adjR</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s1">'X'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Y'</span><span class="p">,</span><span class="w"> </span><span class="s1">'DMC'</span><span class="p">,</span><span class="w"> </span><span class="s1">'temp'</span><span class="p">,</span><span class="w"> </span><span class="s1">'wind'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Region1'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Region3'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Region4'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Region42'</span><span class="p">,</span><span class="w">
                     </span><span class="s1">'Region43'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Region52'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Region59'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Region65'</span><span class="p">,</span><span class="s1">'seasonwinter'</span><span class="p">,</span><span class="w"> </span><span class="s1">'seasonsummer'</span><span class="p">,</span><span class="w"> </span><span class="s1">'DMC:DC'</span><span class="p">)</span><span class="w">

</span><span class="n">lm_cp_logarea</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="s2">"logarea"</span><span class="p">,</span><span class="w"> </span><span class="n">predictors_cp</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_train_fires</span><span class="p">)</span><span class="w"> 
</span><span class="n">lm_adjR2_logarea</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="s2">"logarea"</span><span class="p">,</span><span class="w"> </span><span class="n">predictors_adjR</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_train_fires</span><span class="p">)</span><span class="w"> 

</span><span class="n">summary</span><span class="p">(</span><span class="n">lm_cp_logarea</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">lm_adjR2_logarea</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Call:
lm(formula = simplify("logarea", predictors_cp), data = df_train_fires)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.9576 -1.0736 -0.4319  0.8178  5.3502 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  -2.661e-02  3.775e-01  -0.071  0.94383   
DMC           1.351e-02  6.282e-03   2.151  0.03208 * 
temp          3.014e-02  1.512e-02   1.993  0.04693 * 
wind          7.942e-02  4.035e-02   1.968  0.04972 * 
Region1      -6.521e-01  3.569e-01  -1.827  0.06841 . 
Region3      -5.564e-01  2.628e-01  -2.117  0.03484 * 
seasonwinter  8.244e-01  3.556e-01   2.318  0.02094 * 
seasonsummer -6.258e-01  2.088e-01  -2.998  0.00289 **
DMC:DC       -1.271e-05  7.052e-06  -1.803  0.07218 . 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.389 on 405 degrees of freedom
Multiple R-squared:  0.05992,	Adjusted R-squared:  0.04135 
F-statistic: 3.227 on 8 and 405 DF,  p-value: 0.001433





Call:
lm(formula = simplify("logarea", predictors_adjR), data = df_train_fires)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.0490 -1.0297 -0.3824  0.7927  5.1096 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)   5.520e-01  5.484e-01   1.007  0.31475   
X             9.262e-02  4.557e-02   2.033  0.04276 * 
Y            -1.944e-01  9.841e-02  -1.975  0.04891 * 
DMC           1.367e-02  6.285e-03   2.175  0.03022 * 
temp          3.053e-02  1.523e-02   2.005  0.04566 * 
wind          8.392e-02  4.036e-02   2.079  0.03825 * 
Region1      -9.686e-01  4.217e-01  -2.297  0.02213 * 
Region3      -6.793e-01  2.770e-01  -2.453  0.01461 * 
Region4      -4.166e-01  3.287e-01  -1.268  0.20571   
Region42     -9.109e-01  3.850e-01  -2.366  0.01846 * 
Region43     -6.685e-01  2.844e-01  -2.350  0.01924 * 
Region52     -6.063e-01  4.564e-01  -1.329  0.18476   
Region59     -7.188e-01  3.268e-01  -2.200  0.02842 * 
Region65     -6.422e-01  3.961e-01  -1.622  0.10569   
seasonwinter  9.902e-01  3.585e-01   2.762  0.00600 **
seasonsummer -6.914e-01  2.095e-01  -3.300  0.00105 **
DMC:DC       -1.233e-05  7.052e-06  -1.749  0.08112 . 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.38 on 397 degrees of freedom
Multiple R-squared:  0.09084,	Adjusted R-squared:  0.0542 
F-statistic: 2.479 on 16 and 397 DF,  p-value: 0.001298
</code></pre></div></div><p>Apparently, <code class="highlighter-rouge">lm_adjR2_logarea</code> is the best performing model and therefore the winner of this first part. We arrived to this conclusion according to the F-statistic and the adjusted R-squared. Lets plot the residuals of the model.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">8</span><span class="p">)</span><span class="w"> </span><span class="c1"># managing the size</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">mfcol</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="m">2</span><span class="p">))</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">lm_adjR2_logarea</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><p><img src="/assets/images//Bushfire_58_0.png" alt="png" /></p> <p>We can see that many of the problems of the first model persist. Lets make an anova analysis.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">anova</span><span class="p">(</span><span class="n">lm_logarea</span><span class="p">,</span><span class="w"> </span><span class="n">lm_adjR2_logarea</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><table> <thead> <tr> <th style="text-align: right">Res.Df</th> <th style="text-align: right">RSS</th> <th style="text-align: right">Df</th> <th style="text-align: right">Sum of Sq</th> <th style="text-align: right">F</th> <th style="text-align: right">Pr(&gt;F)</th> <th> </th> </tr> </thead> <tbody> <tr> <td style="text-align: right">1</td> <td style="text-align: right">385</td> <td style="text-align: right">747.4043</td> <td style="text-align: right">NA</td> <td style="text-align: right">NA</td> <td style="text-align: right">NA</td> <td>NA</td> </tr> <tr> <td style="text-align: right">2</td> <td style="text-align: right">397</td> <td style="text-align: right">755.6820</td> <td style="text-align: right">-12</td> <td style="text-align: right">-8.277686</td> <td style="text-align: right">0.3553308</td> <td>0.9774972</td> </tr> </tbody> </table> <p>P-value is high and therefore we cannot affirm with certainty that there was an improvment in the model. It makes sense according to our previous plots.</p> <h2 id="second-model---classification--regression">Second Model - Classification + Regression</h2> <p>In our second model we will join a classification step to our model with the goal to split the dataset in fires that ~ 0 area burned and fires with more significant area burned. We follow the approach from <a href="http://www.columbia.edu/~yh2693/#reference">Yanghe Huo</a>. As we have seen in the data exploration the significant fires (more than 0) follow a normal distribution (closely). Therefore we have an expectation to be able to perform an improved analysis in this second model. Our model can be decribed as the following:</p> <p><strong>Model:</strong><script type="math/tex">E[Y\|X]=Pr(Y>0\|X)×E(Y\|Y>0,X)</script>, where <br /></p> <ul> <li>First Component:<script type="math/tex">Pr(Y>0\|X)</script>is a classification model that aims to identify observations with 0 area burned.</li> <li>Second Component:<script type="math/tex">E(Y\|Y>0,X)</script>is a regression model that aims to estimate all area burned of all points that are different than 0.</li> </ul> <p>As we have observed, it is prefered to work with the logarea as it has a more well behaved distribution. Once we remove the points that are equal to 0 than we have almost a normal distribution, which is preferable when performing a regression. Again lets observe the distribution of the points &gt; 0.</p> <h4 id="logarea-burned-area-distribution-0">Logarea Burned area Distribution (&gt;0)</h4><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="c1"># managing the size</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_fires</span><span class="p">[</span><span class="n">df_fires</span><span class="o">$</span><span class="n">logarea</span><span class="o">!=</span><span class="w"> </span><span class="m">0</span><span class="p">,],</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">logarea</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">bins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">30</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
</span><span class="n">theme_linedraw</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Distribution of LogArea Burned (Histogram)"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><p><img src="/assets/images//Bushfire_63_0.png" alt="png" /></p> <h4 id="creating-a-binary-variable-for-classification">Creating a binary variable for classification</h4><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_train_fires</span><span class="o">$</span><span class="n">binary_area</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">df_train_fires</span><span class="o">$</span><span class="n">area</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
</span><span class="n">df_test_fires</span><span class="o">$</span><span class="n">binary_area</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">df_test_fires</span><span class="o">$</span><span class="n">area</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><h4 id="first-component-binomial-regression">First Component: Binomial Regression</h4><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># part 1</span><span class="w">
</span><span class="n">lr_area</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="s2">"binary_area"</span><span class="p">,</span><span class="w"> </span><span class="n">predictors</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_train_fires</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">binomial</span><span class="p">())</span><span class="w">          
</span><span class="n">summary</span><span class="p">(</span><span class="n">lr_area</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Call:
glm(formula = simplify("binary_area", predictors), family = binomial(), 
    data = df_train_fires)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.8324  -1.1165   0.7112   1.0218   1.9726  

Coefficients:
               Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)  -5.251e+00  3.020e+00  -1.739  0.08206 . 
X             1.893e-01  1.158e-01   1.636  0.10193   
Y            -3.358e-01  1.892e-01  -1.775  0.07598 . 
FFMC          4.757e-02  3.074e-02   1.547  0.12176   
DMC          -1.199e-03  1.056e-02  -0.114  0.90959   
ISI          -5.425e-03  2.993e-02  -0.181  0.85615   
temp          4.970e-02  3.709e-02   1.340  0.18028   
RH            8.133e-03  1.053e-02   0.773  0.43970   
wind          1.526e-01  6.831e-02   2.234  0.02546 * 
rain          2.433e-01  3.856e-01   0.631  0.52806   
Region1      -2.061e+00  8.422e-01  -2.447  0.01441 * 
Region3      -8.628e-01  4.813e-01  -1.793  0.07303 . 
Region4      -7.284e-01  5.524e-01  -1.318  0.18736   
Region11      7.205e-01  6.070e-01   1.187  0.23524   
Region19      1.139e+00  8.198e-01   1.389  0.16488   
Region20      9.303e-01  6.609e-01   1.408  0.15921   
Region42     -1.642e+00  6.737e-01  -2.438  0.01479 * 
Region43     -7.425e-01  5.512e-01  -1.347  0.17802   
Region52     -1.887e+00  8.804e-01  -2.144  0.03205 * 
Region53     -2.009e-01  5.291e-01  -0.380  0.70423   
Region58     -8.546e-02  6.318e-01  -0.135  0.89240   
Region59     -3.629e-01  5.438e-01  -0.667  0.50461   
Region60      4.251e-01  4.608e-01   0.923  0.35626   
Region65     -1.006e+00  6.928e-01  -1.452  0.14652   
weekend      -2.471e-01  2.228e-01  -1.109  0.26733   
seasonautumn  3.495e-01  4.825e-01   0.724  0.46878   
seasonwinter  1.736e+00  6.377e-01   2.723  0.00647 **
seasonsummer -3.709e-02  5.307e-01  -0.070  0.94427   
DMC:DC        2.233e-06  1.209e-05   0.185  0.85344   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 571.13  on 413  degrees of freedom
Residual deviance: 519.06  on 385  degrees of freedom
AIC: 577.06

Number of Fisher Scoring iterations: 4
</code></pre></div></div><p>We have found some relevant variables in the task of predicting if an area had more than 0 area burned, notably specific variables linked to regions and seasons. We will now use the variables selected in part 1 to perform the logistic regression. We will not go through a process of subset selection variables because we expect the outcome to be the same due to math propoerties that are not relevant to this work.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lr_adjR2_area</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="s2">"binary_area"</span><span class="p">,</span><span class="w"> </span><span class="n">predictors_adjR</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_train_fires</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">binomial</span><span class="p">())</span><span class="w">          
</span><span class="n">summary</span><span class="p">(</span><span class="n">lr_adjR2_area</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Call:
glm(formula = simplify("binary_area", predictors_adjR), family = binomial(), 
    data = df_train_fires)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-1.7681  -1.1746   0.7446   1.0195   1.9581  

Coefficients:
               Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)  -1.323e-01  8.357e-01  -0.158  0.87420   
X             6.577e-02  6.959e-02   0.945  0.34463   
Y            -2.391e-01  1.517e-01  -1.576  0.11504   
DMC          -1.143e-03  9.553e-03  -0.120  0.90480   
temp          4.227e-02  2.347e-02   1.801  0.07169 . 
wind          1.306e-01  6.339e-02   2.061  0.03930 * 
Region1      -2.429e+00  7.469e-01  -3.252  0.00114 **
Region3      -1.188e+00  4.247e-01  -2.797  0.00515 **
Region4      -1.127e+00  5.061e-01  -2.228  0.02590 * 
Region42     -1.511e+00  5.871e-01  -2.574  0.01004 * 
Region43     -5.675e-01  4.318e-01  -1.314  0.18873   
Region52     -1.528e+00  7.278e-01  -2.099  0.03582 * 
Region59     -3.943e-01  4.981e-01  -0.792  0.42857   
Region65     -1.265e+00  5.988e-01  -2.112  0.03467 * 
seasonwinter  1.245e+00  5.658e-01   2.200  0.02782 * 
seasonsummer -2.009e-01  3.223e-01  -0.623  0.53303   
DMC:DC        4.518e-06  1.072e-05   0.421  0.67352   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 571.13  on 413  degrees of freedom
Residual deviance: 529.64  on 397  degrees of freedom
AIC: 563.64

Number of Fisher Scoring iterations: 4
</code></pre></div></div><p>As expected, since we have reduceded the number of predictors, the Residual deviance had an slight increase. On the other hand, the AIC had a decrease. This indicates the model is now less prone to overffiting, and more likely to have a good performance in the test data. Now we will continue with a regression on the positive points of the dataset.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_posit_train_fires</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_train_fires</span><span class="p">[</span><span class="n">df_train_fires</span><span class="o">$</span><span class="n">area</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">,]</span><span class="w">
</span><span class="n">lm_posit_logarea</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="s2">"logarea"</span><span class="p">,</span><span class="w"> </span><span class="n">predictors</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_posit_train_fires</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">lm_posit_logarea</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Call:
lm(formula = simplify("logarea", predictors), data = df_posit_train_fires)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.3215 -0.8083 -0.1362  0.5900  4.3011 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)   1.973e+00  3.588e+00   0.550  0.58306   
X             1.104e-01  7.819e-02   1.411  0.15973   
Y            -8.190e-02  1.398e-01  -0.586  0.55873   
FFMC         -1.589e-02  3.888e-02  -0.409  0.68310   
DMC           2.582e-02  8.727e-03   2.959  0.00347 **
ISI          -2.199e-02  3.205e-02  -0.686  0.49338   
temp          3.863e-02  3.109e-02   1.242  0.21558   
RH            3.408e-03  9.110e-03   0.374  0.70873   
wind          8.164e-02  5.605e-02   1.457  0.14684   
rain         -1.474e-01  2.427e-01  -0.607  0.54434   
Region1       8.466e-01  8.488e-01   0.997  0.31976   
Region3      -4.940e-01  4.419e-01  -1.118  0.26493   
Region4       3.612e-01  5.263e-01   0.686  0.49335   
Region11     -1.780e-01  4.688e-01  -0.380  0.70463   
Region19      1.986e-01  5.689e-01   0.349  0.72736   
Region20     -2.309e-01  4.953e-01  -0.466  0.64162   
Region42     -2.128e-01  5.461e-01  -0.390  0.69724   
Region43     -7.886e-01  3.890e-01  -2.027  0.04403 * 
Region52      9.929e-01  9.213e-01   1.078  0.28249   
Region53     -5.627e-02  4.032e-01  -0.140  0.88914   
Region58     -2.642e-01  4.565e-01  -0.579  0.56343   
Region59     -8.935e-01  4.049e-01  -2.207  0.02850 * 
Region60     -4.706e-01  3.413e-01  -1.379  0.16953   
Region65      2.748e-01  5.837e-01   0.471  0.63831   
weekend       2.931e-01  1.824e-01   1.607  0.10970   
seasonautumn  4.262e-02  4.379e-01   0.097  0.92255   
seasonwinter  5.480e-01  5.195e-01   1.055  0.29276   
seasonsummer -1.084e+00  4.689e-01  -2.311  0.02188 * 
DMC:DC       -2.757e-05  9.916e-06  -2.781  0.00596 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.249 on 195 degrees of freedom
Multiple R-squared:  0.1711,	Adjusted R-squared:  0.0521 
F-statistic: 1.438 on 28 and 195 DF,  p-value: 0.08143
</code></pre></div></div><p>The model has a quite low performance and we will apply subset selection to try to improve it.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">lm_posit_subset</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">regsubsets</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="s2">"logarea"</span><span class="p">,</span><span class="w"> </span><span class="n">predictors</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_posit_train_fires</span><span class="p">,</span><span class="w"> </span><span class="n">nvmax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">40</span><span class="p">)</span><span class="w">
</span><span class="n">lm_posit_subset.summary</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">summary</span><span class="p">(</span><span class="n">lm_posit_subset</span><span class="p">)</span><span class="w">
</span><span class="n">lm_posit_subset.summary</span><span class="w">
</span></code></pre></div></div><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Subset selection object
Call: regsubsets.formula(simplify("logarea", predictors), data = df_posit_train_fires, 
    nvmax = 40)
28 Variables  (and intercept)
             Forced in Forced out
X                FALSE      FALSE
Y                FALSE      FALSE
FFMC             FALSE      FALSE
DMC              FALSE      FALSE
ISI              FALSE      FALSE
temp             FALSE      FALSE
RH               FALSE      FALSE
wind             FALSE      FALSE
rain             FALSE      FALSE
Region1          FALSE      FALSE
Region3          FALSE      FALSE
Region4          FALSE      FALSE
Region11         FALSE      FALSE
Region19         FALSE      FALSE
Region20         FALSE      FALSE
Region42         FALSE      FALSE
Region43         FALSE      FALSE
Region52         FALSE      FALSE
Region53         FALSE      FALSE
Region58         FALSE      FALSE
Region59         FALSE      FALSE
Region60         FALSE      FALSE
Region65         FALSE      FALSE
weekend          FALSE      FALSE
seasonautumn     FALSE      FALSE
seasonwinter     FALSE      FALSE
seasonsummer     FALSE      FALSE
DMC:DC           FALSE      FALSE
1 subsets of each size up to 28
Selection Algorithm: exhaustive
          X   Y   FFMC DMC ISI temp RH  wind rain Region1 Region3 Region4
1  ( 1 )  " " " " " "  " " " " " "  " " " "  " "  " "     " "     " "    
2  ( 1 )  " " " " " "  " " " " " "  " " " "  " "  " "     " "     " "    
3  ( 1 )  " " " " " "  "*" " " " "  " " " "  " "  " "     " "     " "    
4  ( 1 )  " " " " " "  "*" " " " "  " " " "  " "  " "     " "     " "    
5  ( 1 )  " " " " " "  "*" " " " "  " " " "  " "  " "     " "     " "    
6  ( 1 )  " " " " " "  "*" " " " "  " " " "  " "  " "     " "     " "    
7  ( 1 )  "*" " " " "  "*" " " " "  " " " "  " "  " "     " "     " "    
8  ( 1 )  "*" " " " "  "*" " " " "  " " " "  " "  " "     " "     " "    
9  ( 1 )  "*" " " " "  "*" " " " "  " " " "  " "  "*"     " "     " "    
10  ( 1 ) "*" " " " "  "*" " " " "  " " " "  " "  "*"     " "     " "    
11  ( 1 ) "*" " " " "  "*" " " " "  " " " "  " "  "*"     "*"     " "    
12  ( 1 ) "*" " " " "  "*" " " " "  " " "*"  " "  "*"     "*"     " "    
13  ( 1 ) "*" " " " "  "*" " " "*"  " " "*"  " "  "*"     "*"     " "    
14  ( 1 ) "*" " " " "  "*" " " "*"  " " "*"  " "  "*"     "*"     " "    
15  ( 1 ) "*" " " " "  "*" " " "*"  " " "*"  " "  "*"     "*"     " "    
16  ( 1 ) "*" " " "*"  "*" " " "*"  " " "*"  " "  "*"     "*"     " "    
17  ( 1 ) "*" " " " "  "*" "*" "*"  " " "*"  " "  "*"     "*"     " "    
18  ( 1 ) "*" " " " "  "*" "*" "*"  " " "*"  " "  "*"     "*"     "*"    
19  ( 1 ) "*" " " " "  "*" "*" "*"  " " "*"  "*"  "*"     "*"     "*"    
20  ( 1 ) "*" "*" " "  "*" "*" "*"  " " "*"  "*"  "*"     "*"     "*"    
21  ( 1 ) "*" "*" " "  "*" "*" "*"  "*" "*"  "*"  "*"     "*"     "*"    
22  ( 1 ) "*" "*" " "  "*" "*" "*"  "*" "*"  "*"  "*"     "*"     "*"    
23  ( 1 ) "*" "*" " "  "*" "*" "*"  "*" "*"  "*"  "*"     "*"     "*"    
24  ( 1 ) "*" "*" "*"  "*" "*" "*"  "*" "*"  "*"  "*"     "*"     "*"    
25  ( 1 ) "*" "*" "*"  "*" "*" "*"  "*" "*"  "*"  "*"     "*"     "*"    
26  ( 1 ) "*" "*" "*"  "*" "*" "*"  "*" "*"  "*"  "*"     "*"     "*"    
27  ( 1 ) "*" "*" "*"  "*" "*" "*"  "*" "*"  "*"  "*"     "*"     "*"    
28  ( 1 ) "*" "*" "*"  "*" "*" "*"  "*" "*"  "*"  "*"     "*"     "*"    
          Region11 Region19 Region20 Region42 Region43 Region52 Region53
1  ( 1 )  " "      " "      " "      " "      " "      " "      " "     
2  ( 1 )  " "      " "      " "      " "      " "      " "      " "     
3  ( 1 )  " "      " "      " "      " "      " "      " "      " "     
4  ( 1 )  " "      " "      " "      " "      " "      " "      " "     
5  ( 1 )  " "      " "      " "      " "      " "      " "      " "     
6  ( 1 )  " "      " "      " "      " "      "*"      " "      " "     
7  ( 1 )  " "      " "      " "      " "      "*"      " "      " "     
8  ( 1 )  " "      " "      " "      " "      "*"      " "      " "     
9  ( 1 )  " "      " "      " "      " "      "*"      " "      " "     
10  ( 1 ) " "      " "      " "      " "      "*"      " "      " "     
11  ( 1 ) " "      " "      " "      " "      "*"      " "      " "     
12  ( 1 ) " "      " "      " "      " "      "*"      " "      " "     
13  ( 1 ) " "      " "      " "      " "      "*"      " "      " "     
14  ( 1 ) " "      " "      " "      " "      "*"      "*"      " "     
15  ( 1 ) " "      " "      " "      " "      "*"      "*"      " "     
16  ( 1 ) " "      " "      " "      " "      "*"      "*"      " "     
17  ( 1 ) " "      " "      "*"      " "      "*"      "*"      " "     
18  ( 1 ) " "      " "      "*"      " "      "*"      "*"      " "     
19  ( 1 ) " "      " "      "*"      " "      "*"      "*"      " "     
20  ( 1 ) " "      "*"      " "      " "      "*"      "*"      " "     
21  ( 1 ) " "      "*"      " "      " "      "*"      "*"      " "     
22  ( 1 ) " "      "*"      " "      " "      "*"      "*"      " "     
23  ( 1 ) " "      "*"      " "      "*"      "*"      "*"      " "     
24  ( 1 ) "*"      " "      "*"      "*"      "*"      "*"      " "     
25  ( 1 ) "*"      " "      "*"      "*"      "*"      "*"      " "     
26  ( 1 ) "*"      "*"      "*"      "*"      "*"      "*"      " "     
27  ( 1 ) "*"      "*"      "*"      "*"      "*"      "*"      "*"     
28  ( 1 ) "*"      "*"      "*"      "*"      "*"      "*"      "*"     
          Region58 Region59 Region60 Region65 weekend seasonautumn seasonwinter
1  ( 1 )  " "      " "      " "      " "      " "     " "          " "         
2  ( 1 )  " "      "*"      " "      " "      " "     " "          " "         
3  ( 1 )  " "      " "      " "      " "      " "     " "          " "         
4  ( 1 )  " "      "*"      " "      " "      " "     " "          " "         
5  ( 1 )  " "      "*"      "*"      " "      " "     " "          " "         
6  ( 1 )  " "      "*"      "*"      " "      " "     " "          " "         
7  ( 1 )  " "      "*"      "*"      " "      " "     " "          " "         
8  ( 1 )  " "      "*"      "*"      " "      "*"     " "          " "         
9  ( 1 )  " "      "*"      "*"      " "      "*"     " "          " "         
10  ( 1 ) " "      "*"      "*"      " "      "*"     " "          "*"         
11  ( 1 ) " "      "*"      "*"      " "      "*"     " "          "*"         
12  ( 1 ) " "      "*"      "*"      " "      "*"     " "          "*"         
13  ( 1 ) " "      "*"      "*"      " "      "*"     " "          "*"         
14  ( 1 ) " "      "*"      "*"      " "      "*"     " "          "*"         
15  ( 1 ) " "      "*"      "*"      "*"      "*"     " "          "*"         
16  ( 1 ) " "      "*"      "*"      "*"      "*"     " "          "*"         
17  ( 1 ) " "      "*"      "*"      "*"      "*"     " "          "*"         
18  ( 1 ) " "      "*"      "*"      "*"      "*"     " "          "*"         
19  ( 1 ) " "      "*"      "*"      "*"      "*"     " "          "*"         
20  ( 1 ) " "      "*"      "*"      "*"      "*"     " "          "*"         
21  ( 1 ) " "      "*"      "*"      "*"      "*"     " "          "*"         
22  ( 1 ) "*"      "*"      "*"      "*"      "*"     " "          "*"         
23  ( 1 ) "*"      "*"      "*"      "*"      "*"     " "          "*"         
24  ( 1 ) "*"      "*"      "*"      " "      "*"     " "          "*"         
25  ( 1 ) "*"      "*"      "*"      "*"      "*"     " "          "*"         
26  ( 1 ) "*"      "*"      "*"      "*"      "*"     " "          "*"         
27  ( 1 ) "*"      "*"      "*"      "*"      "*"     " "          "*"         
28  ( 1 ) "*"      "*"      "*"      "*"      "*"     "*"          "*"         
          seasonsummer DMC:DC
1  ( 1 )  "*"          " "   
2  ( 1 )  "*"          " "   
3  ( 1 )  "*"          "*"   
4  ( 1 )  "*"          "*"   
5  ( 1 )  "*"          "*"   
6  ( 1 )  "*"          "*"   
7  ( 1 )  "*"          "*"   
8  ( 1 )  "*"          "*"   
9  ( 1 )  "*"          "*"   
10  ( 1 ) "*"          "*"   
11  ( 1 ) "*"          "*"   
12  ( 1 ) "*"          "*"   
13  ( 1 ) "*"          "*"   
14  ( 1 ) "*"          "*"   
15  ( 1 ) "*"          "*"   
16  ( 1 ) "*"          "*"   
17  ( 1 ) "*"          "*"   
18  ( 1 ) "*"          "*"   
19  ( 1 ) "*"          "*"   
20  ( 1 ) "*"          "*"   
21  ( 1 ) "*"          "*"   
22  ( 1 ) "*"          "*"   
23  ( 1 ) "*"          "*"   
24  ( 1 ) "*"          "*"   
25  ( 1 ) "*"          "*"   
26  ( 1 ) "*"          "*"   
27  ( 1 ) "*"          "*"   
28  ( 1 ) "*"          "*"   
</code></pre></div></div><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="c1"># managing the size</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">lm_posit_subset.summary</span><span class="o">$</span><span class="n">cp</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Number of variables"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"C_p"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">)</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">which.min</span><span class="p">(</span><span class="n">lm_posit_subset.summary</span><span class="o">$</span><span class="n">cp</span><span class="p">),</span><span class="w"> </span><span class="n">lm_posit_subset.summary</span><span class="o">$</span><span class="n">cp</span><span class="p">[</span><span class="n">which.min</span><span class="p">(</span><span class="n">lm_posit_subset.summary</span><span class="o">$</span><span class="n">cp</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">lm_posit_subset.summary</span><span class="o">$</span><span class="n">bic</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Number of variables"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"BIC"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">)</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">which.min</span><span class="p">(</span><span class="n">lm_posit_subset.summary</span><span class="o">$</span><span class="n">bic</span><span class="p">),</span><span class="w"> </span><span class="n">lm_posit_subset.summary</span><span class="o">$</span><span class="n">bic</span><span class="p">[</span><span class="n">which.min</span><span class="p">(</span><span class="n">lm_posit_subset.summary</span><span class="o">$</span><span class="n">bic</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">lm_posit_subset.summary</span><span class="o">$</span><span class="n">adjr2</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Number of variables"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Adjusted R^2"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">)</span><span class="w">
</span><span class="n">points</span><span class="p">(</span><span class="n">which.max</span><span class="p">(</span><span class="n">lm_posit_subset.summary</span><span class="o">$</span><span class="n">adjr2</span><span class="p">),</span><span class="w"> </span><span class="n">lm_posit_subset.summary</span><span class="o">$</span><span class="n">adjr2</span><span class="p">[</span><span class="n">which.max</span><span class="p">(</span><span class="n">lm_posit_subset.summary</span><span class="o">$</span><span class="n">adjr2</span><span class="p">)],</span><span class="w"> </span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">lm_posit_subset.summary</span><span class="o">$</span><span class="n">rss</span><span class="p">,</span><span class="w"> </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Number of variables"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"RSS"</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">)</span><span class="w">
</span><span class="n">mtext</span><span class="p">(</span><span class="s2">"Plots of C_p, BIC, adjusted R^2 and RSS best subset selection selection"</span><span class="p">,</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-2</span><span class="p">,</span><span class="w"> </span><span class="n">outer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><p><img src="/assets/images//Bushfire_74_0.png" alt="png" /></p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">coef</span><span class="p">(</span><span class="n">lm_posit_subset</span><span class="p">,</span><span class="w"> </span><span class="n">which.min</span><span class="p">(</span><span class="n">lm_posit_subset.summary</span><span class="o">$</span><span class="n">cp</span><span class="p">))</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">lm_posit_subset</span><span class="p">,</span><span class="w"> </span><span class="n">which.min</span><span class="p">(</span><span class="n">lm_posit_subset.summary</span><span class="o">$</span><span class="n">bic</span><span class="p">))</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">lm_posit_subset</span><span class="p">,</span><span class="w"> </span><span class="n">which.max</span><span class="p">(</span><span class="n">lm_posit_subset.summary</span><span class="o">$</span><span class="n">adjr2</span><span class="p">))</span><span class="w">
</span></code></pre></div></div><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(Intercept)1.48020595937141		X0.0809547752784181		DMC0.0219214865403856	Region43-0.68303590058244		Region59-0.798154315732607		Region60-0.54195856092524	weekend0.265913932174833	seasonsummer-1.00810076795683	DMC:DC-2.34940806014068e-05
(Intercept)1.70331143574566		DMC0.0241956909502708	seasonsummer-0.963236697621362		DMC:DC-2.55993473859988e-05
(Intercept)0.703865860612608	X0.0887125845951744		DMC0.0250398319780162		temp0.0200056262313652		wind0.0637379419620515	Region11.00845241123666		Region3-0.473888105030186		Region43-0.7151287573868		Region59-0.904038328051593		Region60-0.509101520453757		weekend0.266448108332819		seasonwinter0.619757365115371		seasonsummer-1.15204301839224		DMC:DC-2.65123492005568e-05
</code></pre></div></div><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">predictors_cp2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"X"</span><span class="p">,</span><span class="w"> </span><span class="s2">"DMC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Region43"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Region59"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Region60"</span><span class="p">,</span><span class="w"> </span><span class="s2">"weekend"</span><span class="p">,</span><span class="w"> </span><span class="s2">"seasonsummer"</span><span class="p">,</span><span class="w"> </span><span class="s2">"DMC:DC"</span><span class="p">)</span><span class="w"> 
</span><span class="n">predictors_adjR2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"X"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Y"</span><span class="p">,</span><span class="w"> </span><span class="s2">"DMC"</span><span class="p">,</span><span class="w"> </span><span class="s2">"temp"</span><span class="p">,</span><span class="w"> </span><span class="s2">"wind"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Region1"</span><span class="p">,</span><span class="s2">"Region3"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Region43"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Region59"</span><span class="p">,</span><span class="w"> 
                      </span><span class="s2">"Region60"</span><span class="p">,</span><span class="w"> </span><span class="s2">"weekend"</span><span class="p">,</span><span class="w"> </span><span class="s2">"seasonwinter"</span><span class="p">,</span><span class="w"> </span><span class="s2">"seasonsummer"</span><span class="p">,</span><span class="w"> </span><span class="s2">"DMC:DC"</span><span class="p">)</span><span class="w"> 

</span><span class="n">lm_posit_cp_logarea</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="s2">"logarea"</span><span class="p">,</span><span class="w"> </span><span class="n">predictors_cp2</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_posit_train_fires</span><span class="p">)</span><span class="w">
</span><span class="n">lm_posit_adjR2_logarea</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="s2">"logarea"</span><span class="p">,</span><span class="w"> </span><span class="n">predictors_adjR2</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_posit_train_fires</span><span class="p">)</span><span class="w">

</span><span class="n">summary</span><span class="p">(</span><span class="n">lm_posit_cp_logarea</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">lm_posit_adjR2_logarea</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Call:
lm(formula = simplify("logarea", predictors_cp2), data = df_posit_train_fires)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.1335 -0.8730 -0.1931  0.6051  4.5698 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.480e+00  2.986e-01   4.957 1.45e-06 ***
X             8.095e-02  3.875e-02   2.089  0.03786 *  
DMC           2.192e-02  7.421e-03   2.954  0.00349 ** 
Region43     -6.830e-01  3.007e-01  -2.272  0.02409 *  
Region59     -7.982e-01  3.561e-01  -2.242  0.02601 *  
Region60     -5.420e-01  2.716e-01  -1.996  0.04723 *  
weekend       2.659e-01  1.694e-01   1.570  0.11800    
seasonsummer -1.008e+00  2.437e-01  -4.137 5.06e-05 ***
DMC:DC       -2.349e-05  8.388e-06  -2.801  0.00556 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.225 on 215 degrees of freedom
Multiple R-squared:  0.1204,	Adjusted R-squared:  0.08768 
F-statistic: 3.679 on 8 and 215 DF,  p-value: 0.0004812





Call:
lm(formula = simplify("logarea", predictors_adjR2), data = df_posit_train_fires)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.4881 -0.8463 -0.1342  0.5300  4.3711 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   9.065e-01  5.919e-01   1.532  0.12714    
X             1.081e-01  4.651e-02   2.324  0.02107 *  
Y            -7.255e-02  8.998e-02  -0.806  0.42098    
DMC           2.524e-02  7.760e-03   3.252  0.00134 ** 
temp          2.075e-02  1.898e-02   1.093  0.27544    
wind          6.185e-02  5.024e-02   1.231  0.21974    
Region1       9.043e-01  7.429e-01   1.217  0.22490    
Region3      -4.668e-01  3.913e-01  -1.193  0.23425    
Region43     -7.845e-01  3.158e-01  -2.484  0.01376 *  
Region59     -9.384e-01  3.629e-01  -2.586  0.01040 *  
Region60     -4.830e-01  2.848e-01  -1.696  0.09135 .  
weekend       2.569e-01  1.712e-01   1.501  0.13497    
seasonwinter  6.673e-01  4.272e-01   1.562  0.11980    
seasonsummer -1.153e+00  2.545e-01  -4.532 9.83e-06 ***
DMC:DC       -2.652e-05  8.603e-06  -3.083  0.00232 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.221 on 209 degrees of freedom
Multiple R-squared:  0.1512,	Adjusted R-squared:  0.09432 
F-statistic: 2.659 on 14 and 209 DF,  p-value: 0.001364
</code></pre></div></div><h5 id="analysis">Analysis</h5> <p>We have decided to proceed with <code class="highlighter-rouge">lm_posit_adjR2_logarea</code>and <code class="highlighter-rouge">lm_posit_cp_logarea</code> as we beleive they are both succsseful models according to the development of our project. They have similar results, and while the fist has an improved <code class="highlighter-rouge">adjusted R-squared</code> the second has a better <code class="highlighter-rouge">F-statistic</code>.</p> <h3 id="final-model">Final Model</h3> <p>Our final models of this second part will join the classification step with the regression for exclusively positive points (area &gt; 0). <br /> It can be described as previsously: <code class="highlighter-rouge">E[Y|X]=Pr(Y&gt;0|X)×E(Y|Y&gt;0,X)</code>, where:</p> <ul> <li><code class="highlighter-rouge">Pr(Y&gt;0|X)</code> is given by <code class="highlighter-rouge">lr_area</code>, which is a logistic regression.</li> <li><code class="highlighter-rouge">E(Y|Y&gt;0,X)</code> is given by <code class="highlighter-rouge">lm_posit_adjR2_logarea</code> or <code class="highlighter-rouge">lm_posit_cp_logarea</code> which is the linear model applied only to positive area points.</li> </ul> <h2 id="4-model-comparsion">4. Model Comparsion<a class="anchor" id="sec_4"></a></h2> <p>We will now compare the models we have developed throughout the project. The metrics we will use are inspired in the <a href="http://www3.dsi.uminho.pt/pcortez/fires.pdf">paper</a> from Paulo Cortez and Anibal Morais - Mean Absolute Deviation (MAD) and Root Mean Squared (RMSE). They can be computed according to the formulas:</p><script type="math/tex; mode=display">RMSE = \sqrt{\frac{1}{n}\Sigma_{i=1}^{n}{\Big({\hat{y_i} - y_i}\Big)^2}}</script><script type="math/tex; mode=display">MAE = (\frac{1}{n})\sum_{i=1}^{n}\left \| \hat{y_i} - {y_i} \right |</script><p>We will compare 3 different models, which are the following: <br /></p> <p>1.<strong><code class="highlighter-rouge">Model1: lm_adjR2_logarea:</code></strong> A basic model, a simple linear regression that predicts <strong><code class="highlighter-rouge">logarea</code></strong> and predictors <code class="highlighter-rouge">X</code>, <code class="highlighter-rouge">Y</code>, <code class="highlighter-rouge">DMC</code>, <code class="highlighter-rouge">temp</code>, <code class="highlighter-rouge">wind</code>,<code class="highlighter-rouge">Region1</code>, <code class="highlighter-rouge">Region3</code>, <code class="highlighter-rouge">Region4</code>, <code class="highlighter-rouge">Region42</code>, <code class="highlighter-rouge">Region43</code>, <code class="highlighter-rouge">Region52</code>, <code class="highlighter-rouge">Region59</code>, <code class="highlighter-rouge">seasonwinter</code>, <code class="highlighter-rouge">seasonsummer</code>.</p> <p>2.<strong><code class="highlighter-rouge">Model2: lr_adjR2_area x lm_posit_adjR2_logarea:</code></strong> A model that joins a logistic regression with a linear regression. The first model aims to classify if a observation is likely to be zero while the second targets the total area of points thata area different than zero. <code class="highlighter-rouge">E[Y|X]=Pr(Y&gt;0|X)×E(Y|Y&gt;0,X)</code>. The first regression uses the variables <code class="highlighter-rouge">X</code>, <code class="highlighter-rouge">Y</code>, <code class="highlighter-rouge">DMC</code>, <code class="highlighter-rouge">temp</code>, <code class="highlighter-rouge">wind</code>,<code class="highlighter-rouge">Region1</code>, <code class="highlighter-rouge">Region3</code>, <code class="highlighter-rouge">Region4</code>, <code class="highlighter-rouge">Region42</code>, <code class="highlighter-rouge">Region43</code>, <code class="highlighter-rouge">Region52</code>, <code class="highlighter-rouge">Region59</code>, <code class="highlighter-rouge">seasonwinter</code>, <code class="highlighter-rouge">seasonsummer</code> while the second uses <code class="highlighter-rouge">X</code>, <code class="highlighter-rouge">Y</code>, <code class="highlighter-rouge">DMC</code>, <code class="highlighter-rouge">temp</code>, <code class="highlighter-rouge">Region1</code>,<code class="highlighter-rouge">Region3</code>, <code class="highlighter-rouge">Region43</code>, <code class="highlighter-rouge">Region59</code>, <code class="highlighter-rouge">Region60</code>, <code class="highlighter-rouge">Region60</code>, <code class="highlighter-rouge">weekend</code>, <code class="highlighter-rouge">seasonwinter</code>, <code class="highlighter-rouge">seasonsummer</code>, <code class="highlighter-rouge">DMC:DC</code>.</p> <p>3.<strong><code class="highlighter-rouge">Model3: lr_adjR2_area x lm_posit_cp_logarea:</code></strong> A model that joins a logistic regression with a linear regression. The first model aims to classify if a observation is likely to be zero while the second targets the total area of points thata area different than zero. <code class="highlighter-rouge">E[Y|X]=Pr(Y&gt;0|X)×E(Y|Y&gt;0,X)</code>. The first regression uses the variables <code class="highlighter-rouge">X</code>, <code class="highlighter-rouge">Y</code>, <code class="highlighter-rouge">FFMC</code>, <code class="highlighter-rouge">DMC</code>, <code class="highlighter-rouge">temp</code>, <code class="highlighter-rouge">wind</code>, <code class="highlighter-rouge">rain</code>,<code class="highlighter-rouge">Region1</code>, <code class="highlighter-rouge">Region3</code>, <code class="highlighter-rouge">Region19</code>, <code class="highlighter-rouge">Region20</code>, <code class="highlighter-rouge">Region42</code>, <code class="highlighter-rouge">Region43</code>, <code class="highlighter-rouge">Region52</code>, <code class="highlighter-rouge">Region58</code>, <code class="highlighter-rouge">Region59</code>, <code class="highlighter-rouge">seasonwinter</code>, <code class="highlighter-rouge">seasonsummer</code> while the second uses <code class="highlighter-rouge">X</code>, <code class="highlighter-rouge">DMC</code>,<code class="highlighter-rouge">Region43</code>, <code class="highlighter-rouge">Region59</code>, <code class="highlighter-rouge">Region60</code>, <code class="highlighter-rouge">weekend</code>, <code class="highlighter-rouge">seasonsummer</code>, <code class="highlighter-rouge">DMC:DC</code>.</p> <h4 id="defining-the-functions">Defining the functions</h4><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">RMSE</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w">  </span><span class="nf">sqrt</span><span class="p">(</span><span class="n">mean</span><span class="p">((</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w">
</span><span class="n">MAE</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w">  </span><span class="n">mean</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">
</span></code></pre></div></div><h4 id="performing-the-calculations">Performing the calculations</h4><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">phat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">lr_adjR2_area</span><span class="p">,</span><span class="w"> </span><span class="n">df_test_fires</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"response"</span><span class="p">)</span><span class="w">

</span><span class="n">df_predictions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">as.data.frame</span><span class="p">(</span><span class="n">df_test_fires</span><span class="p">[,</span><span class="s1">'area'</span><span class="p">],</span><span class="n">colname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'area'</span><span class="p">)</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">df_predictions</span><span class="p">)[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"area"</span><span class="w">
</span><span class="n">df_predictions</span><span class="o">$</span><span class="n">model1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">lm_adjR2_logarea</span><span class="p">,</span><span class="w"> </span><span class="n">df_test_fires</span><span class="p">)</span><span class="w">
</span><span class="n">df_predictions</span><span class="o">$</span><span class="n">model2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">phat</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">lm_adjR2_logarea</span><span class="p">,</span><span class="w"> </span><span class="n">df_test_fires</span><span class="p">)</span><span class="w">
</span><span class="n">df_predictions</span><span class="o">$</span><span class="n">model3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">phat</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">lm_posit_cp_logarea</span><span class="p">,</span><span class="w"> </span><span class="n">df_test_fires</span><span class="p">)</span><span class="w">

</span></code></pre></div></div><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">RMSE</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">RMSE</span><span class="p">(</span><span class="n">df_predictions</span><span class="o">$</span><span class="n">area</span><span class="p">,</span><span class="w"> </span><span class="n">df_predictions</span><span class="o">$</span><span class="n">model1</span><span class="p">),</span><span class="w">
          </span><span class="n">RMSE</span><span class="p">(</span><span class="n">df_predictions</span><span class="o">$</span><span class="n">area</span><span class="p">,</span><span class="w"> </span><span class="n">df_predictions</span><span class="o">$</span><span class="n">model2</span><span class="p">),</span><span class="w">
          </span><span class="n">RMSE</span><span class="p">(</span><span class="n">df_predictions</span><span class="o">$</span><span class="n">area</span><span class="p">,</span><span class="w"> </span><span class="n">df_predictions</span><span class="o">$</span><span class="n">model3</span><span class="p">))</span><span class="w">
</span><span class="n">RMSE</span><span class="w">
</span></code></pre></div></div><style> .list-inline {list-style: none; margin:0; padding: 0} .list-inline>li {display: inline-block} .list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex} </style> <p>&lt;ol class=list-inline&gt;&lt;li&gt;20.9233173414873&lt;/li&gt;&lt;li&gt;21.0733370518129&lt;/li&gt;&lt;li&gt;20.943199595481&lt;/li&gt;&lt;/ol&gt;</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">MAE</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">MAE</span><span class="p">(</span><span class="n">df_predictions</span><span class="o">$</span><span class="n">area</span><span class="p">,</span><span class="w"> </span><span class="n">df_predictions</span><span class="o">$</span><span class="n">model1</span><span class="p">),</span><span class="w">
         </span><span class="n">MAE</span><span class="p">(</span><span class="n">df_predictions</span><span class="o">$</span><span class="n">area</span><span class="p">,</span><span class="w"> </span><span class="n">df_predictions</span><span class="o">$</span><span class="n">model2</span><span class="p">),</span><span class="w">
         </span><span class="n">MAE</span><span class="p">(</span><span class="n">df_predictions</span><span class="o">$</span><span class="n">area</span><span class="p">,</span><span class="w"> </span><span class="n">df_predictions</span><span class="o">$</span><span class="n">model3</span><span class="p">))</span><span class="w">
</span><span class="n">MAE</span><span class="w">
</span></code></pre></div></div><p><samp> 7.21449129803444 7.11280632073942 7.23581143455136 </samp></p> <h2 id="5-variable-identification-and-explanation-">5. Variable Identification and Explanation <a class="anchor" id="sec_5"></a></h2> <p>Throghout this project we have the following manipulations to create new variables with our dataset.</p> <ol> <li>Created dummy variables for risk areas - which means, areas where more than 10 fires were registered.</li> <li>Created a dummy variable for seasons, as we observed the relevance of summer and other seasons in the fires.</li> <li>Created a dummy variable for weekends as we had expectations of a human component in the fires.</li> <li>Removed variables related to month and weekday.</li> </ol> <p>After performing such manipulations we developed different models where variable identification was a major component. We applied the subset selection tool <code class="highlighter-rouge">regsubsets</code>, and analysed all possible combinations of variables. We did not save any computation power by using the foward or backward methods that would lead possibly to inferior models.</p> <p>When identifying significant variables, the most important statistic we have to consider is the $p-value$. The p-value of each coefficient is made to test the null hypothesis, which is that the coefficient is equal to zero. Setting a threhold low such as $p-value$ &lt; 0.05 indicates that the null hypothesis can be rejected and therefore the variable is signicant. To sum up, a predictor with a low p-value is likely to be a meaningful addition to your model because changes in the predictor’s value are related to changes in the response variable.</p> <p>To base my variable identification I will use exclusevely the final models presented in the previous section. We have performed almost 10 modelling/regressions tasks over this project, but we will make use only of the final models to select variables. The folowing table describes our variable selection - all the predictors with a $p-value$ lower than 5% in one of the final models.</p> <table> <thead> <tr> <th>Predictor</th> <th>Type</th> <th>Description</th> <th>Model</th> </tr> </thead> <tbody> <tr> <td>X</td> <td>Spatial</td> <td>x-axis spatial coordinate within the Montesinho park map: 1 to 9</td> <td>Model1, Log Model, Model2</td> </tr> <tr> <td>Y</td> <td>Spatial</td> <td>y-axis spatial coordinate within the Montesinho park map: 2 to 9</td> <td>Model1</td> </tr> <tr> <td>Region1</td> <td>Spatial</td> <td>Dummy variable to characterize region 1</td> <td>Model1, Log Model</td> </tr> <tr> <td>Region20</td> <td>Spatial</td> <td>Dummy variable to characterize region 20</td> <td>Log Model,</td> </tr> <tr> <td>Region42</td> <td>Spatial</td> <td>Dummy variable to characterize region 42</td> <td>Model1, Log Model</td> </tr> <tr> <td>Region 43</td> <td>Spatial</td> <td>Dummy variable to characterize region 43</td> <td>Model1, Model2, Log Model</td> </tr> <tr> <td>Region52</td> <td>Spatial</td> <td>Dummy variable to characterize region 52</td> <td>Model1</td> </tr> <tr> <td>Region59</td> <td>Spatial</td> <td>Dummy variable to characterize region 59</td> <td>Model1</td> </tr> <tr> <td>DMC</td> <td>FWI</td> <td>DMC index from the FWI system: 1.1 to 291.3</td> <td>Model2, Model3</td> </tr> <tr> <td>DMC:DC</td> <td>FWI</td> <td>DC index from the FWI system: 7.9 to 860.6</td> <td>Model2, Model3</td> </tr> <tr> <td>seasonwinter</td> <td>Temporal</td> <td>Dummy variable for season winter</td> <td>Model1, Log Model</td> </tr> <tr> <td>seasonsummer</td> <td>Temporal</td> <td>Dummy variable for season summer</td> <td>Model1, Model2, Model3</td> </tr> <tr> <td>Weekend</td> <td>Temporal</td> <td>Dummy variable for weekend (Friday, Saturday and Sunday)</td> <td>Model2, Model3</td> </tr> </tbody> </table> <p><br /> The results for the variable identification are in line with what we expected according to different steps such as data exploration and modelling. We will revise some of the tasks and exploration we have done throughout the project to justify this choices. We will also try to demonstrate with statistical exploration why the variables were selected.</p> <h4 id="spatial-component">Spatial Component</h4> <p>Variables: <code class="highlighter-rouge">X</code>, <code class="highlighter-rouge">Y</code>, <code class="highlighter-rouge">Region1</code>, <code class="highlighter-rouge">Region20</code>, <code class="highlighter-rouge">Region42</code>, <code class="highlighter-rouge">Region43</code>, <code class="highlighter-rouge">Region52</code>, <code class="highlighter-rouge">Region59</code></p> <p>First, lets revisite the plot developed in the data exploration part.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="c1"># managing the size</span><span class="w">
</span><span class="n">area_plot</span><span class="w">
</span></code></pre></div></div><p><img src="/assets/images//Bushfire_87_0.png" alt="png" /></p> <p>With this chart we can see clearly that some areas are more relevant than others for purposes of fire prediction. We will now create a table to see explore the differences of fires among regions.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_fires</span><span class="o">$</span><span class="n">risky_region</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">Region</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
                                </span><span class="n">ifelse</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">Region</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
                                       </span><span class="n">ifelse</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">Region</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">42</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
                                              </span><span class="n">ifelse</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">Region</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">43</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
                                                     </span><span class="n">ifelse</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">Region</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">52</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
                                                            </span><span class="n">ifelse</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">Region</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">52</span><span class="p">,</span><span class="w"> </span><span class="m">59</span><span class="p">,</span><span class="w">
                                                                   </span><span class="m">0</span><span class="p">))))))</span><span class="w">
</span><span class="n">df_fires</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
</span><span class="n">group_by</span><span class="p">(</span><span class="n">risky_region</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
</span><span class="n">summarize</span><span class="p">(</span><span class="n">Total_Area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">area</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w">
          </span><span class="n">Count_Fires</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">(),</span><span class="w"> 
          </span><span class="n">Mean_area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">area</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),</span><span class="w">
          </span><span class="n">Median_area</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">median</span><span class="p">(</span><span class="n">area</span><span class="p">,</span><span class="w"> </span><span class="n">na.rm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">),)</span><span class="w">                               

</span></code></pre></div></div><table> <thead> <tr> <th style="text-align: right">risky_region</th> <th style="text-align: right">Total_Area</th> <th style="text-align: right">Count_Fires</th> <th style="text-align: right">Mean_area</th> <th style="text-align: right">Median_area</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">0</td> <td style="text-align: right">5558.29</td> <td style="text-align: right">391</td> <td style="text-align: right">14.215575</td> <td style="text-align: right">0.76</td> </tr> <tr> <td style="text-align: right">1</td> <td style="text-align: right">1054.37</td> <td style="text-align: right">116</td> <td style="text-align: right">9.089397</td> <td style="text-align: right">0.00</td> </tr> </tbody> </table> <p>From this table we can observe:</p> <ul> <li>That fires in Risky Areas are proportionally in much higher number. They are 6 regions out of 72 and more than 1/4 of the fires. In addition, almost 1/5 of the burned areas were in risky regions.</li> </ul><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="c1"># managing the size</span><span class="w">

</span><span class="n">df_fires</span><span class="o">$</span><span class="n">region_plot</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_fires</span><span class="o">$</span><span class="n">region</span><span class="w">

</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">nrow</span><span class="p">(</span><span class="n">df_fires</span><span class="p">)){</span><span class="w">
    
    </span><span class="n">df_fires</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s1">'region_plot'</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">df_fires</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s1">'risky_region'</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">df_fires</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s1">'Region'</span><span class="p">],</span><span class="w"> </span><span class="s2">"Non_Risky"</span><span class="p">)</span><span class="w">   
        
</span><span class="p">}</span><span class="w">

</span><span class="n">region59</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_fires</span><span class="p">[</span><span class="n">df_fires</span><span class="o">$</span><span class="n">Region</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">59</span><span class="p">,]</span><span class="w">

</span><span class="c1"># Top Right: Set a different color for each group</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_fires</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">region_plot</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">area</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">region_plot</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
    </span><span class="n">geom_boxplot</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="m">0.3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="o">=</span><span class="s2">"none"</span><span class="p">)</span><span class="w">

</span></code></pre></div></div><p><img src="/assets/images//Bushfire_91_0.png" alt="png" /></p> <h4 id="conclusion">Conclusion:</h4> <p>The plot above is very conclusive, altough the oposite may be aparent. The predictors we salected from regions have:</p> <ul> <li>A small number of outliers compared to other variables.</li> <li>A big number of count of fires. In conclusion, they are well behaved, with a stable distribution and therefore are good predictors.</li> </ul> <h4 id="temporal-predictiors">Temporal Predictiors</h4> <p>We will start by ploting a chart previously developed.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">options</span><span class="p">(</span><span class="n">repr.plot.width</span><span class="o">=</span><span class="m">15</span><span class="p">,</span><span class="w"> </span><span class="n">repr.plot.height</span><span class="o">=</span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="c1"># managing the size</span><span class="w">
</span><span class="n">grid.arrange</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span><span class="w"> </span><span class="n">p4</span><span class="p">,</span><span class="w"> </span><span class="n">p7</span><span class="p">,</span><span class="w"> </span><span class="n">p8</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="c1"># making the plot</span><span class="w">
</span></code></pre></div></div><p><img src="/assets/images//Bushfire_94_0.png" alt="png" /></p> <p>We consider this plots sufficient to demonstrate the importance of summer and autum in predicting the fires. We have alredy made clear that all models have selected <code class="highlighter-rouge">seasonsummer</code> and <code class="highlighter-rouge">seasonautumn</code> and <code class="highlighter-rouge">weekend</code> as predictors with a good P-value.</p> <h4 id="fwi">FWI</h4> <p>We have demostrated the correlation between DMC:DC and used it as a predictor which made it a chosen variable. Also DMC was chosen as a relevant variable.</p> <h4 id="choosing-the-best-predictor">Choosing the Best Predictor</h4> <p>Now, we will make a linear regression with the predictors normalized to finally compare than all in the same scale.</p><div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">df_fires</span><span class="o">$</span><span class="n">DMC_DC</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_fires</span><span class="o">$</span><span class="n">DMC</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">df_fires</span><span class="o">$</span><span class="n">DC</span><span class="w"> </span><span class="c1"># missing variable</span><span class="w">

</span><span class="c1"># normalize function</span><span class="w">
</span><span class="n">normalize</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span><span class="n">return</span><span class="w"> </span><span class="p">((</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">df_fires_normal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_fires</span><span class="w"> 
</span><span class="n">df_fires_normal</span><span class="o">$</span><span class="n">X</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">normalize</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">X</span><span class="p">)</span><span class="w">
</span><span class="n">df_fires_normal</span><span class="o">$</span><span class="n">Y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">normalize</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">Y</span><span class="p">)</span><span class="w">
</span><span class="n">df_fires_normal</span><span class="o">$</span><span class="n">Region1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">normalize</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">Region1</span><span class="p">)</span><span class="w">
</span><span class="n">df_fires_normal</span><span class="o">$</span><span class="n">Region20</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">normalize</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">Region20</span><span class="p">)</span><span class="w">
</span><span class="n">df_fires_normal</span><span class="o">$</span><span class="n">Region42</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">normalize</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">Region42</span><span class="p">)</span><span class="w">
</span><span class="n">df_fires_normal</span><span class="o">$</span><span class="n">Region43</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">normalize</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">Region43</span><span class="p">)</span><span class="w">
</span><span class="n">df_fires_normal</span><span class="o">$</span><span class="n">Region52</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">normalize</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">Region52</span><span class="p">)</span><span class="w">
</span><span class="n">df_fires_normal</span><span class="o">$</span><span class="n">Region59</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">normalize</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">Region59</span><span class="p">)</span><span class="w">
</span><span class="n">df_fires_normal</span><span class="o">$</span><span class="n">DMC</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">normalize</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">DMC</span><span class="p">)</span><span class="w">
</span><span class="n">df_fires_normal</span><span class="o">$</span><span class="n">DMC_DC</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">normalize</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">DMC_DC</span><span class="p">)</span><span class="w">
</span><span class="n">df_fires_normal</span><span class="o">$</span><span class="n">seasonwinter</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">normalize</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">seasonwinter</span><span class="p">)</span><span class="w">
</span><span class="n">df_fires_normal</span><span class="o">$</span><span class="n">seasonsummer</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">normalize</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">seasonsummer</span><span class="p">)</span><span class="w">
</span><span class="n">df_fires_normal</span><span class="o">$</span><span class="n">weekend</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">normalize</span><span class="p">(</span><span class="n">df_fires</span><span class="o">$</span><span class="n">weekend</span><span class="p">)</span><span class="w">


</span><span class="n">Final_predictors</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s1">'X'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Y'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Region1'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Region20'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Region42'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Region43'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Region52'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Region59'</span><span class="p">,</span><span class="w"> </span><span class="s1">'DMC'</span><span class="p">,</span><span class="w">
                      </span><span class="s1">'DMC_DC'</span><span class="p">,</span><span class="w"> </span><span class="s1">'seasonwinter'</span><span class="p">,</span><span class="w"> </span><span class="s1">'seasonsummer'</span><span class="p">,</span><span class="w"> </span><span class="s1">'weekend'</span><span class="p">,</span><span class="w"> </span><span class="s1">'logarea'</span><span class="p">)</span><span class="w">

</span><span class="n">summary</span><span class="p">(</span><span class="n">lm</span><span class="p">(</span><span class="n">simplify</span><span class="p">(</span><span class="s2">"logarea"</span><span class="p">,</span><span class="w"> </span><span class="n">Final_predictors</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">df_fires_normal</span><span class="p">))</span><span class="w">

</span></code></pre></div></div><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Warning message in model.matrix.default(mt, mf, contrasts):
"the response appeared on the right-hand side and was dropped"
Warning message in model.matrix.default(mt, mf, contrasts):
"problem with term 14 in model.matrix: no columns are assigned"




Call:
lm(formula = simplify("logarea", Final_predictors), data = df_fires_normal)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.7669 -1.0384 -0.5150  0.8502  5.5111 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)   0.72073    0.23018   3.131  0.00184 **
X             0.88915    0.34406   2.584  0.01004 * 
Y            -1.17358    0.55282  -2.123  0.03426 * 
Region1      -0.63040    0.36807  -1.713  0.08739 . 
Region20      0.42553    0.35053   1.214  0.22534   
Region42     -0.63138    0.34022  -1.856  0.06408 . 
Region43     -0.50556    0.26307  -1.922  0.05521 . 
Region52     -0.45570    0.45342  -1.005  0.31538   
Region59     -0.52602    0.30475  -1.726  0.08496 . 
DMC           3.62813    1.63565   2.218  0.02700 * 
DMC_DC       -2.53069    1.57345  -1.608  0.10839   
seasonwinter  0.75424    0.29133   2.589  0.00991 **
seasonsummer -0.50650    0.18525  -2.734  0.00648 **
weekend       0.03503    0.12526   0.280  0.77986   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.386 on 493 degrees of freedom
Multiple R-squared:  0.05152,	Adjusted R-squared:  0.02651 
F-statistic:  2.06 on 13 and 493 DF,  p-value: 0.01519
</code></pre></div></div><p>Observations:</p> <ul> <li>X, Y, Region1, DMC, seasonsummer and seasonwinter again showed p-value under 0.05 and therefore have influence.</li> <li>DMC and DMC_DC have the highest magnitude, which in this case might mean the highest influence on the area burned.</li> </ul> <h2 id="6-conclusion-">6. Conclusion <a class="anchor" id="sec_6"></a></h2> <p>In this project our primary task was to model the burned areas of fires in Portugal that occured between the years of 2000 and 2003 according to 12 predictors. We have started performing an intensive exploration of the dataset in each of its dimensions. The dataset variables related time, geographic regions, metheorology and the FWI system. After performing successive tasks and reshaping the dataset with new variables different models were proposed to model the area. After arriving to a subset of 3 final models they’re performance was compared according to RMSE and MAD metrics and finally the most relevant variables were identified. Some of the learning outcomes and relevat observations from the project.</p> <ul> <li>By developing heatmap plots we werre able to understand the relevance of the geographical component. Our next step was then to identify the riskiest areas and create dummy variables for each it.</li> <li>By creating new variables such as seasom and weekend, we could enhance our dataset with relevant and improved features.</li> <li>By identifyig the strong correlation between DC and DMC we were able to use them together in a model and explore the synergy. After performing all tasks this was a selected variable.</li> <li>Subset selection was extensevely used in our model development, which increased significantly the performance of our model with respect to ajusted R-squared and F-statistic.</li> <li>Removing influential points was crucial to our model performance. We used Cooks distance approach.</li> <li>A honest attemp to create a model by joinning to logist and linear models. Results were not extraordinary but model building rests as an outcome.</li> <li>Using RMSE and MAD to compare models gave a dimension of the success in the prediction task.</li> </ul> <h2 id="7-references-">7. References <a class="anchor" id="sec_7"></a></h2> <ul> <li> <p>Cortez, P., &amp; Morais, A. D. J. R. (2007). A data mining approach to predict forest fires using meteorological data. Retrieved from http://www3.dsi.uminho.pt/pcortez/fires.pdf</p> </li> <li> <p>Yanghe Huo. What Influences Forest Fires Area?. Retrieved from http://www.columbia.edu/~yh2693/ForestFire.html</p> </li> <li> <p>datasharkie. (Accessed on 2020, may 09). <em>How to normalize data in R</em>. Retrieved from https://datasharkie.com/how-to-normalize-data-in-r/</p> </li> <li>user3459010 (2019). *Removing outliers based on cook’s distance in R Language</li> <li> <p>Retrieved from https://stats.stackexchange.com/questions/164099/removing-outliers-based-on-cooks-distance-in-r-language</p> </li> <li> <p>r-graph-gallery. (Accessed on 2020, may 09). <em>Heatmap</em>. Retrieved from https://www.r-graph-gallery.com/heatmap</p> </li> <li>zx8754 (2019). <em>Generate a dummy-variable</em> https://stackoverflow.com/questions/11952706/generate-a-dummy-variable</li> </ul> </article></div><hr class="dashed" /><div class="container"><div class="row" data-aos="fade-up"><div class="col-md-12"><div class="share-box"> <i class="fa fa-share-alt" aria-hidden="true"></i> <a class="f nostyle" href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/projects/Bushfire/" onclick="window.open(this.href, 'mywin', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" ><i class="fa fa-facebook-official fa"></i ></a> <a class="t nostyle" href="https://twitter.com/intent/tweet?text=&url=http://localhost:4000/projects/Bushfire/" onclick="window.open(this.href, 'mywin', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" ><i class="fa fa-twitter fa"></i ></a> <a class="g nostyle" href="https://plus.google.com/share?url=http://localhost:4000/projects/Bushfire/" onclick="window.open(this.href, 'mywin', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" ><i class="fa fa-google-plus fa"></i ></a> <a class="r nostyle" href="http://www.reddit.com/submit?url=http://localhost:4000/projects/Bushfire/" onclick="window.open(this.href, 'mywin', 'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;" ><i class="fa fa-reddit fa"></i ></a> <a class="l nostyle" href="https://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/projects/Bushfire/&title=&summary=&source=webjeda" onclick="window.open(this.href, 'mywin', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" ><i class="fa fa-linkedin fa"></i ></a> <a class="e nostyle" href="mailto:?subject=&amp;body=Check&amp;out&amp;this&amp;site&amp;http://localhost:4000/projects/Bushfire/" ><i class="fa fa-envelope fa"></i ></a></div></div></div><div class="row"><div class="col-md-12"> <p class="categories" data-aos="fade-up"> <span><a href="/categories/#data-science">Data science</a></span> <span><a href="/categories/#finance">Finance</a></span> <span><a href="/categories/#machine-learning">Machine learning</a></span> <span><a href="/categories/#deep-learning">Deep learning</a></span> </p></div></div><div id="disqus_thread" data-aos="fade-up"></div><script defer> (function() { var d = document, s = d.createElement("script"); s.src = "//webjeda-demo.disqus.com/embed.js"; s.setAttribute("data-timestamp", +new Date()); (d.head || d.body).appendChild(s); })();</script><noscript>Please enable JavaScript to view the comments</noscript><div class="recent" data-aos="fade-up"><div class=""> <h3>Recent Articles</h3></div><div class="recent-grid"><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/dog/"><div class="cards"><div class="image" style="background-image: url(/assets/images/anthony-tori-102062.jpg)" ></div><p class="title"><small>An Algorithm for a Dog Identification App</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/blackcurrant/"><div class="cards"><div class="image" style="background-image: url(/assets/images/blackcurrant.jpg)" ></div><p class="title"><small>Blackcurrant Jekyll Theme</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/corporateCreditRatingPrediction/"><div class="cards"><div class="image" style="background-image: url(/assets/images/finance.jpg)" ></div><p class="title"><small>Corporate Credit Rating Forecasting</small></p></div></a></div><div class="items" data-aos="fade-up"> <a class="nostyle item" href="/blog/EM-Clustering/"><div class="cards"><div class="image" style="background-image: url(/assets/images/cluster.png)" ></div><p class="title"><small>Expectation Maximization for News Clustering</small></p></div></a></div></div></div></div></main><footer data-aos="fade-up"><div class="text-right"> <p class="copy"> <i class="fa fa-at"></i> 2018 <a class="rev" href="http://localhost:4000">Blackcurrant</a> </p></div></footer></div></div></div></div><!DOCTYPE html><html><head><meta name="viewport" content="width=device-width, initial-scale=1"> <style> .sidenav { width: 230px; position: fixed; z-index: 1; top: 100px; left: 30px; overflow-x: hidden; padding: 8px 0; } .sidenav a { padding: 6px 8px 6px 16px; text-decoration: none; color: #444; font-size: 22px; display: block; } .sidenav a:hover { color: #064579; } .top-bar { background-color: #222222; } </style></head><body><div class="sidenav"> <a href="#home"><i class="fa fa-fw fa-home"></i> Home</a> <a href="#Projects"><i class="fa fa-area-chart"></i> Projects</a></div><script src="/assets/js/jQuery.min.js"></script><script> $(document).ready(function () { $(".loader").hide(); });</script><script> (function () { var css = document.createElement('link'); css.href = '/assets/font-awesome-4.7.0/css/font-awesome.min.css'; css.rel = 'stylesheet'; css.type = 'text/css'; document.getElementsByTagName('head')[0].appendChild(css); })();</script><noscript><link rel="stylesheet" href="/assets/font-awesome-4.7.0/css/font-awesome.min.css"> </noscript><script> $("#search-input").keyup(function () { $("main").hide(); $("search-container").show(); if (!$('#search-input').val()) { $("main").show(); $("search-container").hide(); } });</script><script src="/assets/js/jekyll-search.min.js" type="text/javascript"></script><script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-container'), searchResultTemplate: '<a class="nostyle" href="{url}"><div class="blog borders cards"><div class="image" style="background-image: url({image});"></div><div class="content"><h3 class="title">{title}</h3><p class="description">{description}</p></div></div></a>', noResultsText: 'No results found', json: '/search.json' })</script><script> (function () { var css = document.createElement('link'); css.href = 'https://unpkg.com/aos@2.3.1/dist/aos.css'; css.rel = 'stylesheet'; css.type = 'text/css'; document.getElementsByTagName('head')[0].appendChild(css); })();</script><noscript><link rel="stylesheet" href="/assets/animate-on-scroll/aos.min.css"> </noscript><script src="/assets/animate-on-scroll/aos.min.js"></script><script> AOS.init({ duration: 600, once: true, disable: 'mobile' });</script></body></html>